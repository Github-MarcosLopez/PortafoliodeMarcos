"use strict";var g=require("@next-boost/hybrid-disk-cache"),m=require("fs"),y=require("path");const k={0:{66:{77:"image/bmp"},71:{73:{70:"image/gif"}},73:{73:{42:{0:"image/tiff"}}},77:{77:{0:{42:"image/tiff"}}},137:{80:{78:{71:{13:{10:{26:{10:"image/png"}}}}}}},255:{216:{255:"image/jpeg"}}},4:{102:{116:{121:{112:{97:{118:{105:{102:"image/avif",115:"image/avif"}}}}}}}},8:{87:{69:{66:{80:"image/webp"}}}}},I=[0,4,8];var z;!function(g){g.SVG="image/svg+xml",g.JPEG="image/jpeg",g.PNG="image/png",g.GIF="image/gif",g.WEBP="image/webp",g.BMP="image/bmp",g.TIFF="image/tiff",g.AVIF="image/avif"}(z||(z={}));const g$1=g=>{if(!g||g.byteLength<3)throw new Error("Buffer is not a valid image!");for(const m of I){let y=k[m];for(let k=m;k<=12;k+=1){const m=g[k];if("object"!=typeof y)return y;if(!Object.prototype.hasOwnProperty.call(y,m))break;y=y[m]}}throw new Error("Buffer is not a supported image type!")};var P,N;exports.CacheStatus=void 0,(P=exports.CacheStatus||(exports.CacheStatus={})).HIT="hit",P.STALE="stale",P.MISS="miss";class Cache{}class RemixImageError extends Error{errorCode;constructor(g,m){super(g),Object.setPrototypeOf(this,RemixImageError.prototype),this.errorCode=m||500}toString(){return this.message}}class UnsupportedImageError extends RemixImageError{constructor(g){super(g,415),Object.setPrototypeOf(this,UnsupportedImageError.prototype)}}exports.MimeType=void 0,(N=exports.MimeType||(exports.MimeType={})).SVG="image/svg+xml",N.JPEG="image/jpeg",N.PNG="image/png",N.GIF="image/gif",N.WEBP="image/webp",N.BMP="image/bmp",N.TIFF="image/tiff",N.AVIF="image/avif";const textResponse=(g,m="")=>new Response(m,{status:g});var O={},strictUriEncode=g=>encodeURIComponent(g).replace(/[!'()*]/g,(g=>`%${g.charCodeAt(0).toString(16).toUpperCase()}`)),U="%[a-f0-9]{2}",M=new RegExp("("+U+")|([^%]+?)","gi"),B=new RegExp("("+U+")+","gi");function decodeComponents(g,m){try{return[decodeURIComponent(g.join(""))]}catch(g){}if(1===g.length)return g;m=m||1;var y=g.slice(0,m),k=g.slice(m);return Array.prototype.concat.call([],decodeComponents(y),decodeComponents(k))}function decode(g){try{return decodeURIComponent(g)}catch(k){for(var m=g.match(M)||[],y=1;y<m.length;y++)m=(g=decodeComponents(m,y).join("")).match(M)||[];return g}}var decodeUriComponent=function(g){if("string"!=typeof g)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof g+"`");try{return g=g.replace(/\+/g," "),decodeURIComponent(g)}catch(m){return function customDecodeURIComponent(g){for(var m={"%FE%FF":"��","%FF%FE":"��"},y=B.exec(g);y;){try{m[y[0]]=decodeURIComponent(y[0])}catch(g){var k=decode(y[0]);k!==y[0]&&(m[y[0]]=k)}y=B.exec(g)}m["%C2"]="�";for(var I=Object.keys(m),z=0;z<I.length;z++){var P=I[z];g=g.replace(new RegExp(P,"g"),m[P])}return g}(g)}},splitOnFirst=(g,m)=>{if("string"!=typeof g||"string"!=typeof m)throw new TypeError("Expected the arguments to be of type `string`");if(""===m)return[g];const y=g.indexOf(m);return-1===y?[g]:[g.slice(0,y),g.slice(y+m.length)]},filterObj=function(g,m){for(var y={},k=Object.keys(g),I=Array.isArray(m),z=0;z<k.length;z++){var P=k[z],N=g[P];(I?-1!==m.indexOf(P):m(P,N,g))&&(y[P]=N)}return y};!function(g){const m=strictUriEncode,y=decodeUriComponent,k=splitOnFirst,I=filterObj,z=Symbol("encodeFragmentIdentifier");function validateArrayFormatSeparator(g){if("string"!=typeof g||1!==g.length)throw new TypeError("arrayFormatSeparator must be single character string")}function encode(g,y){return y.encode?y.strict?m(g):encodeURIComponent(g):g}function decode(g,m){return m.decode?y(g):g}function keysSorter(g){return Array.isArray(g)?g.sort():"object"==typeof g?keysSorter(Object.keys(g)).sort(((g,m)=>Number(g)-Number(m))).map((m=>g[m])):g}function removeHash(g){const m=g.indexOf("#");return-1!==m&&(g=g.slice(0,m)),g}function extract(g){const m=(g=removeHash(g)).indexOf("?");return-1===m?"":g.slice(m+1)}function parseValue(g,m){return m.parseNumbers&&!Number.isNaN(Number(g))&&"string"==typeof g&&""!==g.trim()?g=Number(g):!m.parseBooleans||null===g||"true"!==g.toLowerCase()&&"false"!==g.toLowerCase()||(g="true"===g.toLowerCase()),g}function parse(g,m){validateArrayFormatSeparator((m=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},m)).arrayFormatSeparator);const y=function parserForArrayFormat(g){let m;switch(g.arrayFormat){case"index":return(g,y,k)=>{m=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),m?(void 0===k[g]&&(k[g]={}),k[g][m[1]]=y):k[g]=y};case"bracket":return(g,y,k)=>{m=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),m?void 0!==k[g]?k[g]=[].concat(k[g],y):k[g]=[y]:k[g]=y};case"colon-list-separator":return(g,y,k)=>{m=/(:list)$/.exec(g),g=g.replace(/:list$/,""),m?void 0!==k[g]?k[g]=[].concat(k[g],y):k[g]=[y]:k[g]=y};case"comma":case"separator":return(m,y,k)=>{const I="string"==typeof y&&y.includes(g.arrayFormatSeparator),z="string"==typeof y&&!I&&decode(y,g).includes(g.arrayFormatSeparator);y=z?decode(y,g):y;const P=I||z?y.split(g.arrayFormatSeparator).map((m=>decode(m,g))):null===y?y:decode(y,g);k[m]=P};case"bracket-separator":return(m,y,k)=>{const I=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!I)return void(k[m]=y?decode(y,g):y);const z=null===y?[]:y.split(g.arrayFormatSeparator).map((m=>decode(m,g)));void 0!==k[m]?k[m]=[].concat(k[m],z):k[m]=z};default:return(g,m,y)=>{void 0!==y[g]?y[g]=[].concat(y[g],m):y[g]=m}}}(m),I=Object.create(null);if("string"!=typeof g)return I;if(!(g=g.trim().replace(/^[?#&]/,"")))return I;for(const z of g.split("&")){if(""===z)continue;let[g,P]=k(m.decode?z.replace(/\+/g," "):z,"=");P=void 0===P?null:["comma","separator","bracket-separator"].includes(m.arrayFormat)?P:decode(P,m),y(decode(g,m),P,I)}for(const g of Object.keys(I)){const y=I[g];if("object"==typeof y&&null!==y)for(const g of Object.keys(y))y[g]=parseValue(y[g],m);else I[g]=parseValue(y,m)}return!1===m.sort?I:(!0===m.sort?Object.keys(I).sort():Object.keys(I).sort(m.sort)).reduce(((g,m)=>{const y=I[m];return Boolean(y)&&"object"==typeof y&&!Array.isArray(y)?g[m]=keysSorter(y):g[m]=y,g}),Object.create(null))}g.extract=extract,g.parse=parse,g.stringify=(g,m)=>{if(!g)return"";validateArrayFormatSeparator((m=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},m)).arrayFormatSeparator);const shouldFilter=y=>m.skipNull&&null==g[y]||m.skipEmptyString&&""===g[y],y=function encoderForArrayFormat(g){switch(g.arrayFormat){case"index":return m=>(y,k)=>{const I=y.length;return void 0===k||g.skipNull&&null===k||g.skipEmptyString&&""===k?y:null===k?[...y,[encode(m,g),"[",I,"]"].join("")]:[...y,[encode(m,g),"[",encode(I,g),"]=",encode(k,g)].join("")]};case"bracket":return m=>(y,k)=>void 0===k||g.skipNull&&null===k||g.skipEmptyString&&""===k?y:null===k?[...y,[encode(m,g),"[]"].join("")]:[...y,[encode(m,g),"[]=",encode(k,g)].join("")];case"colon-list-separator":return m=>(y,k)=>void 0===k||g.skipNull&&null===k||g.skipEmptyString&&""===k?y:null===k?[...y,[encode(m,g),":list="].join("")]:[...y,[encode(m,g),":list=",encode(k,g)].join("")];case"comma":case"separator":case"bracket-separator":{const m="bracket-separator"===g.arrayFormat?"[]=":"=";return y=>(k,I)=>void 0===I||g.skipNull&&null===I||g.skipEmptyString&&""===I?k:(I=null===I?"":I,0===k.length?[[encode(y,g),m,encode(I,g)].join("")]:[[k,encode(I,g)].join(g.arrayFormatSeparator)])}default:return m=>(y,k)=>void 0===k||g.skipNull&&null===k||g.skipEmptyString&&""===k?y:null===k?[...y,encode(m,g)]:[...y,[encode(m,g),"=",encode(k,g)].join("")]}}(m),k={};for(const m of Object.keys(g))shouldFilter(m)||(k[m]=g[m]);const I=Object.keys(k);return!1!==m.sort&&I.sort(m.sort),I.map((k=>{const I=g[k];return void 0===I?"":null===I?encode(k,m):Array.isArray(I)?0===I.length&&"bracket-separator"===m.arrayFormat?encode(k,m)+"[]":I.reduce(y(k),[]).join("&"):encode(k,m)+"="+encode(I,m)})).filter((g=>g.length>0)).join("&")},g.parseUrl=(g,m)=>{m=Object.assign({decode:!0},m);const[y,I]=k(g,"#");return Object.assign({url:y.split("?")[0]||"",query:parse(extract(g),m)},m&&m.parseFragmentIdentifier&&I?{fragmentIdentifier:decode(I,m)}:{})},g.stringifyUrl=(m,y)=>{y=Object.assign({encode:!0,strict:!0,[z]:!0},y);const k=removeHash(m.url).split("?")[0]||"",I=g.extract(m.url),P=g.parse(I,{sort:!1}),N=Object.assign(P,m.query);let O=g.stringify(N,y);O&&(O=`?${O}`);let U=function getHash(g){let m="";const y=g.indexOf("#");return-1!==y&&(m=g.slice(y)),m}(m.url);return m.fragmentIdentifier&&(U=`#${y[z]?encode(m.fragmentIdentifier,y):m.fragmentIdentifier}`),`${k}${O}${U}`},g.pick=(m,y,k)=>{k=Object.assign({parseFragmentIdentifier:!0,[z]:!1},k);const{url:P,query:N,fragmentIdentifier:O}=g.parseUrl(m,k);return g.stringifyUrl({url:P,query:I(N,y),fragmentIdentifier:O},k)},g.exclude=(m,y,k)=>{const I=Array.isArray(y)?g=>!y.includes(g):(g,m)=>!y(g,m);return g.pick(m,I,k)}}(O);const parseURL=(g,m)=>{let y;try{y=new URL(g,m)}catch(m){throw new RemixImageError(`Invalid URL: ${g}`,400)}return y},fetchResolver=async(g,m)=>{const y=new Request(m,{headers:{accept:"image/*"}}),k=await fetch(y);if(!k.ok)throw new RemixImageError("Failed to fetch image!");const I=await k.arrayBuffer();if(!I||I.byteLength<2)throw new RemixImageError("Invalid image retrieved from resolver!");return{buffer:new Uint8Array(I),contentType:k.headers.get("content-type")}},j={0:{66:{77:"image/bmp"},71:{73:{70:"image/gif"}},73:{73:{42:{0:"image/tiff"}}},77:{77:{0:{42:"image/tiff"}}},137:{80:{78:{71:{13:{10:{26:{10:"image/png"}}}}}}},255:{216:{255:"image/jpeg"}}},4:{102:{116:{121:{112:{97:{118:{105:{102:"image/avif",115:"image/avif"}}}}}}}},8:{87:{69:{66:{80:"image/webp"}}}}},G=[0,4,8];var H;!function(g){g.SVG="image/svg+xml",g.JPEG="image/jpeg",g.PNG="image/png",g.GIF="image/gif",g.WEBP="image/webp",g.BMP="image/bmp",g.TIFF="image/tiff",g.AVIF="image/avif"}(H||(H={}));const i=g=>{if(!g||g.byteLength<3)throw new Error("Buffer is not a valid image!");for(const m of G){let y=j[m];for(let k=m;k<=12;k+=1){const m=g[k];if("object"!=typeof y)return y;if(!Object.prototype.hasOwnProperty.call(y,m))break;y=y[m]}}throw new Error("Buffer is not a supported image type!")};var V,q;!function(g){g.SVG="image/svg+xml",g.JPEG="image/jpeg",g.PNG="image/png",g.GIF="image/gif",g.WEBP="image/webp",g.BMP="image/bmp",g.TIFF="image/tiff",g.AVIF="image/avif"}(V||(V={})),function(g){g[g.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",g[g.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",g[g.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",g[g.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",g[g.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"}(q||(q={}));var Z,$=q;class h{constructor(g,{toRGBA:m}={toRGBA:!1}){if(this.buffer=g,this.bufferView=new DataView(g.buffer,g.byteOffset,g.byteLength),this.toRGBA=!!m,this.bottomUp=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos=2,"BM"!==this.flag)throw new Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.bufferView.getUint16(this.pos,!0),this.pos+=2,this.reserved2=this.bufferView.getUint16(this.pos,!0),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in $))throw new Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.planes=this.bufferView.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.bufferView.getUint16(this.pos,!0),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),32===this.bitPP?(this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255):16===this.bitPP&&(this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31),(this.headerSize>$.BITMAP_INFO_HEADER||3===this.compression||6===this.compression)&&(this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE()),(this.headerSize>$.BITMAP_V2_INFO_HEADER||6===this.compression)&&(this.maskAlpha=this.readUInt32LE()),this.headerSize>$.BITMAP_V3_INFO_HEADER&&(this.pos+=$.BITMAP_V4_HEADER-$.BITMAP_V3_INFO_HEADER),this.headerSize>$.BITMAP_V4_HEADER&&(this.pos+=$.BITMAP_V5_HEADER-$.BITMAP_V4_HEADER),this.bitPP<=8||this.colors>0){const g=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(g);for(let m=0;m<g;m++){const g=this.buffer[this.pos++],y=this.buffer[this.pos++],k=this.buffer[this.pos++],I=this.buffer[this.pos++];this.palette[m]={red:k,green:y,blue:g,quad:I}}}this.height<0&&(this.height*=-1,this.bottomUp=!1);const g=function(g,m,y,k){const I=1+~g&g,z=1+~m&m,P=1+~y&y,N=1+~k&k,O=g/I+1,U=m/z+1,M=y/P+1,B=k/N+1;return{shiftRed:m=>(m&g)/I*256/O,shiftGreen:g=>(g&m)/z*256/U,shiftBlue:g=>(g&y)/P*256/M,shiftAlpha:0!==k?g=>(g&k)/N*256/B:()=>255}}(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=g.shiftRed,this.shiftGreen=g.shiftGreen,this.shiftBlue=g.shiftBlue,this.shiftAlpha=g.shiftAlpha}parseRGBA(){switch(this.data=new Uint8Array(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){const g=Math.ceil(this.width/8),m=g%4,y=0!==m?4-m:0;this.scanImage(y,g,((g,m)=>{const y=this.buffer[this.pos++],k=m*this.width*4+8*g*4;for(let m=0;m<8&&8*g+m<this.width;m++){const g=this.palette[y>>7-m&1];this.data[k+m*this.locAlpha]=0,this.data[k+4*m+this.locBlue]=g.blue,this.data[k+4*m+this.locGreen]=g.green,this.data[k+4*m+this.locRed]=g.red}}))}bit4(){if(2===this.compression){this.data.fill(0);let g=!1,m=this.bottomUp?this.height-1:0,y=0;for(;y<this.data.length;){const k=this.buffer[this.pos++],I=this.buffer[this.pos++];if(0===k){if(0===I){m+=this.bottomUp?-1:1,y=m*this.width*4,g=!1;continue}if(1===I)break;if(2===I){const g=this.buffer[this.pos++],k=this.buffer[this.pos++];m+=this.bottomUp?-k:k,y+=k*this.width*4+4*g}else{let m=this.buffer[this.pos++];for(let k=0;k<I;k++)y=this.setPixelData(y,g?15&m:(240&m)>>4),1&k&&k+1<I&&(m=this.buffer[this.pos++]),g=!g;1==(I+1>>1&1)&&this.pos++}}else for(let m=0;m<k;m++)y=this.setPixelData(y,g?15&I:(240&I)>>4),g=!g}}else{const g=Math.ceil(this.width/2),m=g%4,y=0!==m?4-m:0;this.scanImage(y,g,((g,m)=>{const y=this.buffer[this.pos++],k=m*this.width*4+2*g*4,I=y>>4;let z=this.palette[I];if(this.data[k]=0,this.data[k+1]=z.blue,this.data[k+2]=z.green,this.data[k+3]=z.red,2*g+1>=this.width)return!1;const P=15&y;z=this.palette[P],this.data[k+4]=0,this.data[k+4+1]=z.blue,this.data[k+4+2]=z.green,this.data[k+4+3]=z.red}))}}bit8(){if(1===this.compression){this.data.fill(0);let g=this.bottomUp?this.height-1:0,m=0;for(;m<this.data.length;){const y=this.buffer[this.pos++],k=this.buffer[this.pos++];if(0===y){if(0===k){g+=this.bottomUp?-1:1,m=g*this.width*4;continue}if(1===k)break;if(2===k){const y=this.buffer[this.pos++],k=this.buffer[this.pos++];g+=this.bottomUp?-k:k,m+=k*this.width*4+4*y}else{for(let g=0;g<k;g++){const g=this.buffer[this.pos++];m=this.setPixelData(m,g)}!0&k&&this.pos++}}else for(let g=0;g<y;g++)m=this.setPixelData(m,k)}}else{const g=this.width%4,m=0!==g?4-g:0;this.scanImage(m,this.width,((g,m)=>{const y=this.buffer[this.pos++],k=m*this.width*4+4*g;if(y<this.palette.length){const g=this.palette[y];this.data[k]=0,this.data[k+1]=g.blue,this.data[k+2]=g.green,this.data[k+3]=g.red}else this.data[k]=0,this.data[k+1]=255,this.data[k+2]=255,this.data[k+3]=255}))}}bit16(){const g=this.width%2*2;this.scanImage(g,this.width,((g,m)=>{const y=m*this.width*4+4*g,k=this.bufferView.getUint16(this.pos,!0);this.pos+=2,this.data[y+this.locRed]=this.shiftRed(k),this.data[y+this.locGreen]=this.shiftGreen(k),this.data[y+this.locBlue]=this.shiftBlue(k),this.data[y+this.locAlpha]=this.shiftAlpha(k)}))}bit24(){const g=this.width%4;this.scanImage(g,this.width,((g,m)=>{const y=m*this.width*4+4*g,k=this.buffer[this.pos++],I=this.buffer[this.pos++],z=this.buffer[this.pos++];this.data[y+this.locRed]=z,this.data[y+this.locGreen]=I,this.data[y+this.locBlue]=k,this.data[y+this.locAlpha]=0}))}bit32(){this.scanImage(0,this.width,((g,m)=>{const y=m*this.width*4+4*g,k=this.readUInt32LE();this.data[y+this.locRed]=this.shiftRed(k),this.data[y+this.locGreen]=this.shiftGreen(k),this.data[y+this.locBlue]=this.shiftBlue(k),this.data[y+this.locAlpha]=this.shiftAlpha(k)}))}scanImage(g=0,m=this.width,y){for(let k=this.height-1;k>=0;k--){const I=this.bottomUp?k:this.height-1-k;for(let g=0;g<m;g++)y.call(this,g,I);this.pos+=g}}readUInt32LE(){const g=this.bufferView.getUint32(this.pos,!0);return this.pos+=4,g}setPixelData(g,m){const{blue:y,green:k,red:I}=this.palette[m];return this.data[g+this.locAlpha]=0,this.data[g+1+this.locBlue]=y,this.data[g+2+this.locGreen]=k,this.data[g+3+this.locRed]=I,g+4}}function f(g){return g.reduce(((g,m)=>g<<1|m),0)}function l(g){return g.quad<<24|g.red<<16|g.green<<8|g.blue}class d{constructor(g){switch(this.buffer=g.data,this.width=g.width,this.height=g.height,this.headerSize=$.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=g.bitPP,this.offset=54,this.reserved1=g.reserved1||0,this.reserved2=g.reserved2||0,this.planes=1,this.compress=0,this.hr=g.hr||0,this.vr=g.vr||0,this.importantColors=g.importantColors||0,this.colors=Math.min(Math.pow(2,this.bitPP-1||1),g.colors||1/0),this.palette=g.palette||[],this.colors&&this.bitPP<16?this.offset+=4*this.colors:this.colors=0,this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=.5;break;case 1:this.bytesInColor=1/8;break;default:this.bytesInColor=3,this.bitPP=24}const m=this.width*this.bitPP/32,y=Math.ceil(m);this.extraBytes=4*(y-m),this.rawSize=this.height*y*4+2,this.fileSize=this.rawSize+this.offset,this.data=new Uint8Array(this.fileSize),this.dataView=new DataView(this.data.buffer),this.data.fill(1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data[this.pos++]=this.flag.charCodeAt(0),this.data[this.pos++]=this.flag.charCodeAt(1),this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.dataView.setUint16(this.pos,this.planes,!0),this.pos+=2,this.dataView.setUint16(this.pos,this.bitPP,!0),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){this.palette.length&&2===this.colors?this.initColors(1):(this.writeUInt32LE(16777215),this.writeUInt32LE(0)),this.pos+=1;let g=[];this.writeImage(((m,y,k)=>{let I=y;I++;const z=this.buffer[I++],P=this.buffer[I++],N=.2126*this.buffer[I++]+.7152*P+.0722*z;return g.push(N>127?0:1),(k+1)%8==0?(this.data[m-1]=f(g),g=[]):k===this.width-1&&g.length>0&&(this.data[m-1]=f(g)<<4,g=[]),I}))}bit4(){const g=this.initColors(4);let m=[];this.writeImage(((y,k,I)=>{let z=k;const P=l({quad:this.buffer[z++],blue:this.buffer[z++],green:this.buffer[z++],red:this.buffer[z++]}),N=g.findIndex((g=>g===P));return-1!==N?m.push(N):m.push(0),(I+1)%2==0&&(this.data[y]=m[0]<<4|m[1],m=[]),z}))}bit8(){const g=this.initColors(8);this.writeImage(((m,y)=>{let k=y;const I=l({quad:this.buffer[k++],blue:this.buffer[k++],green:this.buffer[k++],red:this.buffer[k++]}),z=g.findIndex((g=>g===I));return this.data[m]=-1!==z?z:0,k}))}bit16(){this.writeImage(((g,m)=>{let y=m+1;const k=this.buffer[y++]/8,I=this.buffer[y++]/8,z=this.buffer[y++]/8<<10|I<<5|k;return this.data[g]=255&z,this.data[g+1]=(65280&z)>>8,y}))}bit24(){this.writeImage(((g,m)=>{let y=m+1;return this.data[g]=this.buffer[y++],this.data[g+1]=this.buffer[y++],this.data[g+2]=this.buffer[y++],y}))}bit32(){this.writeImage(((g,m)=>{let y=m;return this.data[g+3]=this.buffer[y++],this.data[g]=this.buffer[y++],this.data[g+1]=this.buffer[y++],this.data[g+2]=this.buffer[y++],y}))}writeImage(g){const m=this.extraBytes+this.width*this.bytesInColor;let y=0;for(let k=0;k<this.height;k++)for(let I=0;I<this.width;I++){const z=Math.floor(this.pos+(this.height-1-k)*m+I*this.bytesInColor);y=g.call(this,z,y,I,k)}}initColors(g){const m=[];if(!this.palette.length)throw new Error(`To encode ${g}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);for(let g=0;g<this.colors;g++){const y=l(this.palette[g]);this.writeUInt32LE(y),m.push(y)}return m}writeUInt32LE(g){this.dataView.setUint32(this.pos,g,!0),this.pos+=4}}!function(g){g[g.NONE=0]="NONE",g[g.BI_RLE8=1]="BI_RLE8",g[g.BI_RLE4=2]="BI_RLE4",g[g.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",g[g.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"}(Z||(Z={}));const p=g=>{const m=g.length,y=new Uint8Array(m);for(let k=0;k<m;k+=4)y[k]=g[k+3],y[k+1]=g[k+2],y[k+2]=g[k+1],y[k+3]=g[k];return y},W={decode(g){const m=((g,m)=>new h(g,m))(g,{toRGBA:!0});return{width:m.width,height:m.height,data:m.data}},encode:g=>(g=>new d(g))({bitPP:32,width:g.width,height:g.height,data:p(g.data)}).data};var X,J,Y={};function b(g,m,y,k){for(var I=g[m++],z=1<<I,P=z+1,N=P+1,O=I+1,U=(1<<O)-1,M=0,B=0,j=0,G=g[m++],H=new Int32Array(4096),V=null;;){for(;M<16&&0!==G;)B|=g[m++]<<M,M+=8,1===G?G=g[m++]:--G;if(M<O)break;var q=B&U;if(B>>=O,M-=O,q!==z){if(q===P)break;for(var Z=q<N?q:V,$=0,W=Z;W>z;)W=H[W]>>8,++$;var X=W;if(j+$+(Z!==q?1:0)>k)return void console.log("Warning, gif stream longer than expected.");y[j++]=X;var J=j+=$;for(Z!==q&&(y[j++]=X),W=Z;$--;)W=H[W],y[--J]=255&W,W>>=8;null!==V&&N<4096&&(H[N++]=V<<8|X,N>=U+1&&O<12&&(++O,U=U<<1|1)),V=q}else N=P+1,U=(1<<(O=I+1))-1,V=null}return j!==k&&console.log("Warning, gif stream shorter than expected."),y}try{J=Y.GifWriter=function(g,m,y,k){var I=0,z=void 0===(k=void 0===k?{}:k).loop?null:k.loop,P=void 0===k.palette?null:k.palette;if(m<=0||y<=0||m>65535||y>65535)throw new Error("Width/Height invalid.");function o(g){var m=g.length;if(m<2||m>256||m&m-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return m}g[I++]=71,g[I++]=73,g[I++]=70,g[I++]=56,g[I++]=57,g[I++]=97;var N=0,O=0;if(null!==P){for(var U=o(P);U>>=1;)++N;if(U=1<<N,--N,void 0!==k.background){if((O=k.background)>=U)throw new Error("Background index out of range.");if(0===O)throw new Error("Background index explicitly passed as 0.")}}if(g[I++]=255&m,g[I++]=m>>8&255,g[I++]=255&y,g[I++]=y>>8&255,g[I++]=(null!==P?128:0)|N,g[I++]=O,g[I++]=0,null!==P)for(var M=0,B=P.length;M<B;++M){var j=P[M];g[I++]=j>>16&255,g[I++]=j>>8&255,g[I++]=255&j}if(null!==z){if(z<0||z>65535)throw new Error("Loop count invalid.");g[I++]=33,g[I++]=255,g[I++]=11,g[I++]=78,g[I++]=69,g[I++]=84,g[I++]=83,g[I++]=67,g[I++]=65,g[I++]=80,g[I++]=69,g[I++]=50,g[I++]=46,g[I++]=48,g[I++]=3,g[I++]=1,g[I++]=255&z,g[I++]=z>>8&255,g[I++]=0}var G=!1;this.addFrame=function(m,y,k,z,N,O){if(!0===G&&(--I,G=!1),O=void 0===O?{}:O,m<0||y<0||m>65535||y>65535)throw new Error("x/y invalid.");if(k<=0||z<=0||k>65535||z>65535)throw new Error("Width/Height invalid.");if(N.length<k*z)throw new Error("Not enough pixels for the frame size.");var U=!0,M=O.palette;if(null==M&&(U=!1,M=P),null==M)throw new Error("Must supply either a local or global palette.");for(var B=o(M),j=0;B>>=1;)++j;B=1<<j;var H=void 0===O.delay?0:O.delay,V=void 0===O.disposal?0:O.disposal;if(V<0||V>3)throw new Error("Disposal out of range.");var q=!1,Z=0;if(void 0!==O.transparent&&null!==O.transparent&&(q=!0,(Z=O.transparent)<0||Z>=B))throw new Error("Transparent color index.");if((0!==V||q||0!==H)&&(g[I++]=33,g[I++]=249,g[I++]=4,g[I++]=V<<2|(!0===q?1:0),g[I++]=255&H,g[I++]=H>>8&255,g[I++]=Z,g[I++]=0),g[I++]=44,g[I++]=255&m,g[I++]=m>>8&255,g[I++]=255&y,g[I++]=y>>8&255,g[I++]=255&k,g[I++]=k>>8&255,g[I++]=255&z,g[I++]=z>>8&255,g[I++]=!0===U?128|j-1:0,!0===U)for(var $=0,W=M.length;$<W;++$){var X=M[$];g[I++]=X>>16&255,g[I++]=X>>8&255,g[I++]=255&X}return I=function(g,m,y,k){g[m++]=y;var I=m++,z=1<<y,P=z-1,N=z+1,O=N+1,U=y+1,M=0,B=0;function u(y){for(;M>=y;)g[m++]=255&B,B>>=8,M-=8,m===I+256&&(g[I]=255,I=m++)}function c(g){B|=g<<M,M+=U,u(8)}var j=k[0]&P,G={};c(z);for(var H=1,V=k.length;H<V;++H){var q=k[H]&P,Z=j<<8|q,$=G[Z];if(void 0===$){for(B|=j<<M,M+=U;M>=8;)g[m++]=255&B,B>>=8,M-=8,m===I+256&&(g[I]=255,I=m++);4096===O?(c(z),O=N+1,U=y+1,G={}):(O>=1<<U&&++U,G[Z]=O++),j=q}else j=$}return c(j),c(N),u(1),I+1===m?g[I]=0:(g[I]=m-I-1,g[m++]=0),m}(g,I,j<2?2:j,N),I},this.end=function(){return!1===G&&(g[I++]=59,G=!0),I},this.getOutputBuffer=function(){return g},this.setOutputBuffer=function(m){g=m},this.getOutputBufferPosition=function(){return I},this.setOutputBufferPosition=function(g){I=g}},X=Y.GifReader=function(g){var m=0;if(71!==g[m++]||73!==g[m++]||70!==g[m++]||56!==g[m++]||56!=(g[m++]+1&253)||97!==g[m++])throw new Error("Invalid GIF 87a/89a header.");var y=g[m++]|g[m++]<<8,k=g[m++]|g[m++]<<8,I=g[m++],z=I>>7,P=1<<1+(7&I);g[m++],g[m++];var N=null,O=null;z&&(N=m,O=P,m+=3*P);var U=!0,M=[],B=0,j=null,G=0,H=null;for(this.width=y,this.height=k;U&&m<g.length;)switch(g[m++]){case 33:switch(g[m++]){case 255:if(11!==g[m]||78==g[m+1]&&69==g[m+2]&&84==g[m+3]&&83==g[m+4]&&67==g[m+5]&&65==g[m+6]&&80==g[m+7]&&69==g[m+8]&&50==g[m+9]&&46==g[m+10]&&48==g[m+11]&&3==g[m+12]&&1==g[m+13]&&0==g[m+16])m+=14,H=g[m++]|g[m++]<<8,m++;else for(m+=12;;){if(!((vt=g[m++])>=0))throw Error("Invalid block size");if(0===vt)break;m+=vt}break;case 249:if(4!==g[m++]||0!==g[m+4])throw new Error("Invalid graphics extension block.");var V=g[m++];B=g[m++]|g[m++]<<8,j=g[m++],0==(1&V)&&(j=null),G=V>>2&7,m++;break;case 254:for(;;){if(!((vt=g[m++])>=0))throw Error("Invalid block size");if(0===vt)break;m+=vt}break;default:throw new Error("Unknown graphic control label: 0x"+g[m-1].toString(16))}break;case 44:var q=g[m++]|g[m++]<<8,Z=g[m++]|g[m++]<<8,$=g[m++]|g[m++]<<8,W=g[m++]|g[m++]<<8,X=g[m++],J=X>>6&1,Y=1<<1+(7&X),K=N,Q=O,tt=!1;X>>7&&(tt=!0,K=m,Q=Y,m+=3*Y);var et=m;for(m++;;){var vt;if(!((vt=g[m++])>=0))throw Error("Invalid block size");if(0===vt)break;m+=vt}M.push({x:q,y:Z,width:$,height:W,has_local_palette:tt,palette_offset:K,palette_size:Q,data_offset:et,data_length:m-et,transparent_index:j,interlaced:!!J,delay:B,disposal:G});break;case 59:U=!1;break;default:throw new Error("Unknown gif block: 0x"+g[m-1].toString(16))}this.numFrames=function(){return M.length},this.loopCount=function(){return H},this.frameInfo=function(g){if(g<0||g>=M.length)throw new Error("Frame index out of range.");return M[g]},this.decodeAndBlitFrameBGRA=function(m,k){var I=this.frameInfo(m),z=I.width*I.height,P=new Uint8Array(z);b(g,I.data_offset,P,z);var N=I.palette_offset,O=I.transparent_index;null===O&&(O=256);var U=I.width,M=y-U,B=U,j=4*(I.y*y+I.x),G=4*((I.y+I.height)*y+I.x),H=j,V=4*M;!0===I.interlaced&&(V+=4*y*7);for(var q=8,Z=0,$=P.length;Z<$;++Z){var W=P[Z];if(0===B&&(B=U,(H+=V)>=G&&(V=4*M+4*y*(q-1),H=j+(U+M)*(q<<1),q>>=1)),W===O)H+=4;else{var X=g[N+3*W],J=g[N+3*W+1],Y=g[N+3*W+2];k[H++]=Y,k[H++]=J,k[H++]=X,k[H++]=255}--B}},this.decodeAndBlitFrameRGBA=function(m,k){var I=this.frameInfo(m),z=I.width*I.height,P=new Uint8Array(z);b(g,I.data_offset,P,z);var N=I.palette_offset,O=I.transparent_index;null===O&&(O=256);var U=I.width,M=y-U,B=U,j=4*(I.y*y+I.x),G=4*((I.y+I.height)*y+I.x),H=j,V=4*M;!0===I.interlaced&&(V+=4*y*7);for(var q=8,Z=0,$=P.length;Z<$;++Z){var W=P[Z];if(0===B&&(B=U,(H+=V)>=G&&(V=4*M+4*y*(q-1),H=j+(U+M)*(q<<1),q>>=1)),W===O)H+=4;else{var X=g[N+3*W],J=g[N+3*W+1],Y=g[N+3*W+2];k[H++]=X,k[H++]=J,k[H++]=Y,k[H++]=255}--B}}}}catch(j){}var K={exports:{}};if(!Q)var Q={map:function(g,m){var y={};return m?g.map((function(g,k){return y.index=k,m.call(y,g)})):g.slice()},naturalOrder:function(g,m){return g<m?-1:g>m?1:0},sum:function(g,m){var y={};return g.reduce(m?function(g,k,I){return y.index=I,g+m.call(y,k)}:function(g,m){return g+m},0)},max:function(g,m){return Math.max.apply(null,m?Q.map(g,m):g)}};var tt=function(){function t(g,m,y){return(g<<10)+(m<<5)+y}function e(g){var m=[],y=!1;function i(){m.sort(g),y=!0}return{push:function(g){m.push(g),y=!1},peek:function(g){return y||i(),void 0===g&&(g=m.length-1),m[g]},pop:function(){return y||i(),m.pop()},size:function(){return m.length},map:function(g){return m.map(g)},debug:function(){return y||i(),m}}}function r(g,m,y,k,I,z,P){var N=this;N.r1=g,N.r2=m,N.g1=y,N.g2=k,N.b1=I,N.b2=z,N.histo=P}function i(){this.vboxes=new e((function(g,m){return Q.naturalOrder(g.vbox.count()*g.vbox.volume(),m.vbox.count()*m.vbox.volume())}))}function n(g,m){if(m.count()){var y=m.r2-m.r1+1,k=m.g2-m.g1+1,I=m.b2-m.b1+1,z=Q.max([y,k,I]);if(1==m.count())return[m.copy()];var P,N,O,U,M=0,B=[],j=[];if(z==y)for(P=m.r1;P<=m.r2;P++){for(U=0,N=m.g1;N<=m.g2;N++)for(O=m.b1;O<=m.b2;O++)U+=g[t(P,N,O)]||0;M+=U,B[P]=M}else if(z==k)for(P=m.g1;P<=m.g2;P++){for(U=0,N=m.r1;N<=m.r2;N++)for(O=m.b1;O<=m.b2;O++)U+=g[t(N,P,O)]||0;M+=U,B[P]=M}else for(P=m.b1;P<=m.b2;P++){for(U=0,N=m.r1;N<=m.r2;N++)for(O=m.g1;O<=m.g2;O++)U+=g[t(N,O,P)]||0;M+=U,B[P]=M}return B.forEach((function(g,m){j[m]=M-g})),function p(g){var y,k,I,z,N,O=g+"1",U=g+"2",G=0;for(P=m[O];P<=m[U];P++)if(B[P]>M/2){for(I=m.copy(),z=m.copy(),N=(y=P-m[O])<=(k=m[U]-P)?Math.min(m[U]-1,~~(P+k/2)):Math.max(m[O],~~(P-1-y/2));!B[N];)N++;for(G=j[N];!G&&B[N-1];)G=j[--N];return I[U]=N,z[O]=I[U]+1,[I,z]}}(z==y?"r":z==k?"g":"b")}}return r.prototype={volume:function(g){var m=this;return m._volume&&!g||(m._volume=(m.r2-m.r1+1)*(m.g2-m.g1+1)*(m.b2-m.b1+1)),m._volume},count:function(g){var m=this,y=m.histo;if(!m._count_set||g){var k,I,z,P=0;for(k=m.r1;k<=m.r2;k++)for(I=m.g1;I<=m.g2;I++)for(z=m.b1;z<=m.b2;z++)P+=y[t(k,I,z)]||0;m._count=P,m._count_set=!0}return m._count},copy:function(){var g=this;return new r(g.r1,g.r2,g.g1,g.g2,g.b1,g.b2,g.histo)},avg:function(g){var m=this,y=m.histo;if(!m._avg||g){var k,I,z,P,N=0,O=0,U=0,M=0;for(I=m.r1;I<=m.r2;I++)for(z=m.g1;z<=m.g2;z++)for(P=m.b1;P<=m.b2;P++)N+=k=y[t(I,z,P)]||0,O+=k*(I+.5)*8,U+=k*(z+.5)*8,M+=k*(P+.5)*8;m._avg=N?[~~(O/N),~~(U/N),~~(M/N)]:[~~(8*(m.r1+m.r2+1)/2),~~(8*(m.g1+m.g2+1)/2),~~(8*(m.b1+m.b2+1)/2)]}return m._avg},contains:function(g){var m=this,y=g[0]>>3;return gval=g[1]>>3,bval=g[2]>>3,y>=m.r1&&y<=m.r2&&gval>=m.g1&&gval<=m.g2&&bval>=m.b1&&bval<=m.b2}},i.prototype={push:function(g){this.vboxes.push({vbox:g,color:g.avg()})},palette:function(){return this.vboxes.map((function(g){return g.color}))},size:function(){return this.vboxes.size()},map:function(g){for(var m=this.vboxes,y=0;y<m.size();y++)if(m.peek(y).vbox.contains(g))return m.peek(y).color;return this.nearest(g)},nearest:function(g){for(var m,y,k,I=this.vboxes,z=0;z<I.size();z++)((y=Math.sqrt(Math.pow(g[0]-I.peek(z).color[0],2)+Math.pow(g[1]-I.peek(z).color[1],2)+Math.pow(g[2]-I.peek(z).color[2],2)))<m||void 0===m)&&(m=y,k=I.peek(z).color);return k},forcebw:function(){var g=this.vboxes;g.sort((function(g,m){return Q.naturalOrder(Q.sum(g.color),Q.sum(m.color))}));var m=g[0].color;m[0]<5&&m[1]<5&&m[2]<5&&(g[0].color=[0,0,0]);var y=g.length-1,k=g[y].color;k[0]>251&&k[1]>251&&k[2]>251&&(g[y].color=[255,255,255])}},{quantize:function(g,m){if(!g.length||m<2||m>256)return!1;var y=function(g){var m,y,k,I,z=new Array(32768);return g.forEach((function(g){y=g[0]>>3,k=g[1]>>3,I=g[2]>>3,m=t(y,k,I),z[m]=(z[m]||0)+1})),z}(g);y.forEach((function(){}));var k=function(g,m){var y,k,I,z=1e6,P=0,N=1e6,O=0,U=1e6,M=0;return g.forEach((function(g){y=g[0]>>3,k=g[1]>>3,I=g[2]>>3,y<z?z=y:y>P&&(P=y),k<N?N=k:k>O&&(O=k),I<U?U=I:I>M&&(M=I)})),new r(z,P,N,O,U,M,m)}(g,y),I=new e((function(g,m){return Q.naturalOrder(g.count(),m.count())}));function l(g,m){for(var k,I=1,z=0;z<1e3;)if((k=g.pop()).count()){var P=n(y,k),N=P[0],O=P[1];if(!N)return;if(g.push(N),O&&(g.push(O),I++),I>=m)return;if(z++>1e3)return}else g.push(k),z++}I.push(k),l(I,.75*m);for(var z=new e((function(g,m){return Q.naturalOrder(g.count()*g.volume(),m.count()*m.volume())}));I.size();)z.push(I.pop());l(z,m-z.size());for(var P=new i;z.size();)P.push(z.pop());return P}}}(),et=tt.quantize;function x(g,m){return g[m+3]>=127}function E(g,m,y,k){if(m="number"==typeof m?0|m:5,k="function"==typeof k?k:x,(y="number"==typeof y?0|y:10)<=0)throw new Error("quality must be > 0");for(var I=[],z=4*y,P=0,N=g.length;P<N;P+=z){var O=g[P+0],U=g[P+1],M=g[P+2];k(g,P,g)&&I.push([O,U,M])}var B=et(I,Math.max(2,m)).vboxes;return B?B.map((function(g){return g})).slice(0,m):[]}K.exports=function(g,m,y,k){return E(g,m,y,k).map((function(g){return g.color}))},K.exports.bins=function(g,m,y,k){var I=E(g,m,y,k),z=(I=I.map((function(g){return{color:g.color,size:g.vbox.count()*g.vbox.volume(),amount:0}}))).reduce((function(g,m){return g+m.size}),0);return I.forEach((function(g){g.amount=g.size/z})),I};var vt=K.exports;const yt={decode(g){const m=new X(g),y={width:m.width,height:m.height,data:new Uint8Array(m.width*m.height*4)};return m.decodeAndBlitFrameRGBA(0,y.data),y},encode(g,m){const y=[g.data],k=new Uint8Array(g.width*g.height*y.length+1024),I=new J(k,g.width,g.height,{loop:m.loop});return y.forEach((y=>{const k=((g,m)=>{const y=Math.pow(2,Math.ceil(Math.log(m)/Math.log(2)));let k=vt(g,m).map((g=>[g[0],g[1],g[2],255]));if(0===k.length&&(k=vt(g,m,10,(()=>!0)).map((g=>[g[0],g[1],g[2],255]))),k.length<y){const g=k.length>0?k[k.length-1]:[0,0,0,0],m=k.length;k.length=y,k.fill(g,m,y)}k[k.length-1]=[0,0,0,0];for(let g=0;g<k.length;g+=1)for(let m=0;m<4;m+=1){const y=k[g][m];null==y||Number.isNaN(y)||y<0?k[g][m]=0:y>255&&(k[g][m]=255)}return k})(y,16),z=((g,m)=>{const y=new Array(g.length/4),k=new Map;m.forEach(((g,m)=>k.set(g,m)));for(let I=0;I<g.length;I+=4){const z=[g[I],g[I+1],g[I+2],g[I+3]];if(k.has(z))y[I/4]=k.get(z);else{let g=1e3,P=0;m.map(((m,y)=>{const k=Math.sqrt(Math.pow(z[0]-m[0],2)+Math.pow(z[1]-m[1],2)+Math.pow(z[2]-m[2],2)+Math.pow(z[3]-m[3],2));k<g&&(g=k,P=y)})),k.set(z,P),y[I/4]=P}}return y})(y,k);I.addFrame(0,0,g.width,g.height,z,{palette:k.map((([g,m,y])=>((g,m,y)=>(g<<16)+(m<<8)+y)(g,m,y))),delay:m.delay,transparent:k.length-1,disposal:2})})),k.slice(0,I.end())}};var xt={exports:{}};!function(g){function e(g){var m,y,k,I,z,P=Math.floor,N=new Array(64),O=new Array(64),U=new Array(64),M=new Array(64),B=new Array(65535),j=new Array(65535),G=new Array(64),H=new Array(64),V=[],q=0,Z=7,$=new Array(64),W=new Array(64),X=new Array(64),J=new Array(256),Y=new Array(2048),K=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Q=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],tt=[0,1,2,3,4,5,6,7,8,9,10,11],et=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],vt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],yt=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],xt=[0,1,2,3,4,5,6,7,8,9,10,11],kt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Et=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function R(g,m){for(var y=0,k=0,I=new Array,z=1;z<=16;z++){for(var P=1;P<=g[z];P++)I[m[k]]=[],I[m[k]][0]=y,I[m[k]][1]=z,k++,y++;y*=2}return I}function S(g){for(var m=g[0],y=g[1]-1;y>=0;)m&1<<y&&(q|=1<<Z),y--,--Z<0&&(255==q?(T(255),T(0)):T(q),Z=7,q=0)}function T(g){V.push(g)}function C(g){T(g>>8&255),T(255&g)}function L(g,m,y,k,I){for(var z,P=I[0],N=I[240],O=function(g,m){var y,k,I,z,P,N,O,U,M,B,j=0;for(M=0;M<8;++M){y=g[j],k=g[j+1],I=g[j+2],z=g[j+3],P=g[j+4],N=g[j+5],O=g[j+6];var H=y+(U=g[j+7]),V=y-U,q=k+O,Z=k-O,$=I+N,W=I-N,X=z+P,J=z-P,Y=H+X,K=H-X,Q=q+$,tt=q-$;g[j]=Y+Q,g[j+4]=Y-Q;var et=.707106781*(tt+K);g[j+2]=K+et,g[j+6]=K-et;var vt=.382683433*((Y=J+W)-(tt=Z+V)),yt=.5411961*Y+vt,xt=1.306562965*tt+vt,kt=.707106781*(Q=W+Z),Et=V+kt,It=V-kt;g[j+5]=It+yt,g[j+3]=It-yt,g[j+1]=Et+xt,g[j+7]=Et-xt,j+=8}for(j=0,M=0;M<8;++M){y=g[j],k=g[j+8],I=g[j+16],z=g[j+24],P=g[j+32],N=g[j+40],O=g[j+48];var zt=y+(U=g[j+56]),Ut=y-U,Bt=k+O,jt=k-O,Wt=I+N,Xt=I-N,Jt=z+P,Yt=z-P,Kt=zt+Jt,te=zt-Jt,ee=Bt+Wt,re=Bt-Wt;g[j]=Kt+ee,g[j+32]=Kt-ee;var ie=.707106781*(re+te);g[j+16]=te+ie,g[j+48]=te-ie;var ne=.382683433*((Kt=Yt+Xt)-(re=jt+Ut)),ae=.5411961*Kt+ne,he=1.306562965*re+ne,le=.707106781*(ee=Xt+jt),fe=Ut+le,ce=Ut-le;g[j+40]=ce+ae,g[j+24]=ce-ae,g[j+8]=fe+he,g[j+56]=fe-he,j++}for(M=0;M<64;++M)B=g[M]*m[M],G[M]=B>0?B+.5|0:B-.5|0;return G}(g,m),U=0;U<64;++U)H[K[U]]=O[U];var M=H[0]-y;y=H[0],0==M?S(k[0]):(S(k[j[z=32767+M]]),S(B[z]));for(var V=63;V>0&&0==H[V];V--);if(0==V)return S(P),y;for(var q,Z=1;Z<=V;){for(var $=Z;0==H[Z]&&Z<=V;++Z);var W=Z-$;if(W>=16){q=W>>4;for(var X=1;X<=q;++X)S(N);W&=15}z=32767+H[Z],S(I[(W<<4)+j[z]]),S(B[z]),Z++}return 63!=V&&S(P),y}function D(g){g<=0&&(g=1),g>100&&(g=100),z!=g&&(function(g){for(var m=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],y=0;y<64;y++){var k=P((m[y]*g+50)/100);k<1?k=1:k>255&&(k=255),N[K[y]]=k}for(var I=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],z=0;z<64;z++){var B=P((I[z]*g+50)/100);B<1?B=1:B>255&&(B=255),O[K[z]]=B}for(var j=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],G=0,H=0;H<8;H++)for(var V=0;V<8;V++)U[G]=1/(N[K[G]]*j[H]*j[V]*8),M[G]=1/(O[K[G]]*j[H]*j[V]*8),G++}(g<50?Math.floor(5e3/g):Math.floor(200-2*g)),z=g)}this.encode=function(g,z){var P;(new Date).getTime(),z&&D(z),V=new Array,q=0,Z=7,C(65496),C(65504),C(16),T(74),T(70),T(73),T(70),T(0),T(1),T(1),T(0),C(1),C(1),T(0),T(0),void 0!==(P=g.comments)&&P.constructor===Array&&P.forEach((g=>{if("string"==typeof g){C(65534);var m,y=g.length;for(C(y+2),m=0;m<y;m++)T(g.charCodeAt(m))}})),function(g){if(g){C(65505),69===g[0]&&120===g[1]&&105===g[2]&&102===g[3]?C(g.length+2):(C(g.length+5+2),T(69),T(120),T(105),T(102),T(0));for(var m=0;m<g.length;m++)T(g[m])}}(g.exifBuffer),function(){C(65499),C(132),T(0);for(var g=0;g<64;g++)T(N[g]);T(1);for(var m=0;m<64;m++)T(O[m])}(),function(g,m){C(65472),C(17),T(8),C(m),C(g),T(3),T(1),T(17),T(0),T(2),T(17),T(1),T(3),T(17),T(1)}(g.width,g.height),function(){C(65476),C(418),T(0);for(var g=0;g<16;g++)T(Q[g+1]);for(var m=0;m<=11;m++)T(tt[m]);T(16);for(var y=0;y<16;y++)T(et[y+1]);for(var k=0;k<=161;k++)T(vt[k]);T(1);for(var I=0;I<16;I++)T(yt[I+1]);for(var z=0;z<=11;z++)T(xt[z]);T(17);for(var P=0;P<16;P++)T(kt[P+1]);for(var N=0;N<=161;N++)T(Et[N])}(),C(65498),C(12),T(3),T(1),T(0),T(2),T(17),T(3),T(17),T(0),T(63),T(0);var B=0,j=0,G=0;q=0,Z=7,this.encode.displayName="_encode_";for(var H,J,K,It,zt,Ut,Bt,jt,Wt,Xt=g.data,Jt=g.width,Yt=g.height,Kt=4*Jt,te=0;te<Yt;){for(H=0;H<Kt;){for(Ut=zt=Kt*te+H,Bt=-1,jt=0,Wt=0;Wt<64;Wt++)Ut=zt+(jt=Wt>>3)*Kt+(Bt=4*(7&Wt)),te+jt>=Yt&&(Ut-=Kt*(te+1+jt-Yt)),H+Bt>=Kt&&(Ut-=H+Bt-Kt+4),J=Xt[Ut++],K=Xt[Ut++],It=Xt[Ut++],$[Wt]=(Y[J]+Y[K+256>>0]+Y[It+512>>0]>>16)-128,W[Wt]=(Y[J+768>>0]+Y[K+1024>>0]+Y[It+1280>>0]>>16)-128,X[Wt]=(Y[J+1280>>0]+Y[K+1536>>0]+Y[It+1792>>0]>>16)-128;B=L($,U,B,m,k),j=L(W,M,j,y,I),G=L(X,M,G,y,I),H+=32}te+=8}if(Z>=0){var ee=[];ee[1]=Z+1,ee[0]=(1<<Z+1)-1,S(ee)}return C(65497),new Uint8Array(V)},(new Date).getTime(),g||(g=50),function(){for(var g=String.fromCharCode,m=0;m<256;m++)J[m]=g(m)}(),m=R(Q,tt),y=R(yt,xt),k=R(et,vt),I=R(kt,Et),function(){for(var g=1,m=2,y=1;y<=15;y++){for(var k=g;k<m;k++)j[32767+k]=y,B[32767+k]=[],B[32767+k][1]=y,B[32767+k][0]=k;for(var I=-(m-1);I<=-g;I++)j[32767+I]=y,B[32767+I]=[],B[32767+I][1]=y,B[32767+I][0]=m-1+I;g<<=1,m<<=1}}(),function(){for(var g=0;g<256;g++)Y[g]=19595*g,Y[g+256>>0]=38470*g,Y[g+512>>0]=7471*g+32768,Y[g+768>>0]=-11059*g,Y[g+1024>>0]=-21709*g,Y[g+1280>>0]=32768*g+8421375,Y[g+1536>>0]=-27439*g,Y[g+1792>>0]=-5329*g}(),D(g),(new Date).getTime()}xt.exports=function(g,m){return void 0===m&&(m=50),{data:new e(m).encode(g,m),width:g.width,height:g.height}}}();var kt,Et,It={exports:{}};kt=It,Et=function(){var g=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),m=4017,y=799,k=3406,I=2276,z=1567,P=3784,N=5793,O=2896;function f(){}function l(g,m){for(var y,k,I=0,z=[],P=16;P>0&&!g[P-1];)P--;z.push({children:[],index:0});var N,O=z[0];for(y=0;y<P;y++){for(k=0;k<g[y];k++){for((O=z.pop()).children[O.index]=m[I];O.index>0;){if(0===z.length)throw new Error("Could not recreate Huffman Table");O=z.pop()}for(O.index++,z.push(O);z.length<=y;)z.push(N={children:[],index:0}),O.children[O.index]=N.children,O=N;I++}y+1<P&&(z.push(N={children:[],index:0}),O.children[O.index]=N.children,O=N)}return z[0].children}function d(m,y,k,I,z,P,N,O,U,M){k.precision,k.samplesPerLine,k.scanLines;var B=k.mcusPerLine,j=k.progressive;k.maxH,k.maxV;var G=y,H=0,V=0;function w(){if(V>0)return V--,H>>V&1;if(255==(H=m[y++])){var g=m[y++];if(g)throw new Error("unexpected marker: "+(H<<8|g).toString(16))}return V=7,H>>>7}function _(g){for(var m,y=g;null!==(m=w());){if("number"==typeof(y=y[m]))return y;if("object"!=typeof y)throw new Error("invalid huffman sequence")}return null}function v(g){for(var m=0;g>0;){var y=w();if(null===y)return;m=m<<1|y,g--}return m}function b(g){var m=v(g);return m>=1<<g-1?m:m+(-1<<g)+1}var q,Z=0,$=0;function A(g,m,y,k,I){var z=y%B,P=(y/B|0)*g.v+k,N=z*g.h+I;void 0===g.blocks[P]&&M.tolerantDecoding||m(g,g.blocks[P][N])}function x(g,m,y){var k=y/g.blocksPerLine|0,I=y%g.blocksPerLine;void 0===g.blocks[k]&&M.tolerantDecoding||m(g,g.blocks[k][I])}var W,X,J,Y,K,Q,tt=I.length;Q=j?0===P?0===O?function(g,m){var y=_(g.huffmanTableDC),k=0===y?0:b(y)<<U;m[0]=g.pred+=k}:function(g,m){m[0]|=w()<<U}:0===O?function(m,y){if(Z>0)Z--;else for(var k=P,I=N;k<=I;){var z=_(m.huffmanTableAC),O=15&z,M=z>>4;if(0!==O)y[g[k+=M]]=b(O)*(1<<U),k++;else{if(M<15){Z=v(M)+(1<<M)-1;break}k+=16}}}:function(m,y){for(var k=P,I=N,z=0;k<=I;){var O=g[k],M=y[O]<0?-1:1;switch($){case 0:var B=_(m.huffmanTableAC),j=15&B;if(z=B>>4,0===j)z<15?(Z=v(z)+(1<<z),$=4):(z=16,$=1);else{if(1!==j)throw new Error("invalid ACn encoding");q=b(j),$=z?2:3}continue;case 1:case 2:y[O]?y[O]+=(w()<<U)*M:0==--z&&($=2==$?3:0);break;case 3:y[O]?y[O]+=(w()<<U)*M:(y[O]=q<<U,$=0);break;case 4:y[O]&&(y[O]+=(w()<<U)*M)}k++}4===$&&0==--Z&&($=0)}:function(m,y){var k=_(m.huffmanTableDC),I=0===k?0:b(k);y[0]=m.pred+=I;for(var z=1;z<64;){var P=_(m.huffmanTableAC),N=15&P,O=P>>4;if(0!==N)y[g[z+=O]]=b(N),z++;else{if(O<15)break;z+=16}}};var et,vt,yt,xt,kt=0;for(vt=1==tt?I[0].blocksPerLine*I[0].blocksPerColumn:B*k.mcusPerColumn,z||(z=vt);kt<vt;){for(X=0;X<tt;X++)I[X].pred=0;if(Z=0,1==tt)for(W=I[0],K=0;K<z;K++)x(W,Q,kt),kt++;else for(K=0;K<z;K++){for(X=0;X<tt;X++)for(yt=(W=I[X]).h,xt=W.v,J=0;J<xt;J++)for(Y=0;Y<yt;Y++)A(W,Q,kt,J,Y);if(++kt===vt)break}if(kt===vt)do{if(255===m[y]&&0!==m[y+1])break;y+=1}while(y<m.length-2);if(V=0,(et=m[y]<<8|m[y+1])<65280)throw new Error("marker was not found");if(!(et>=65488&&et<=65495))break;y+=2}return y-G}function u(g,U){var M,B,j=[],G=U.blocksPerLine,H=U.blocksPerColumn,V=G<<3,q=new Int32Array(64),Z=new Uint8Array(64);function b(g,M,B){var j,G,H,V,q,Z,$,W,X,J,Y=U.quantizationTable,K=B;for(J=0;J<64;J++)K[J]=g[J]*Y[J];for(J=0;J<8;++J){var Q=8*J;0!=K[1+Q]||0!=K[2+Q]||0!=K[3+Q]||0!=K[4+Q]||0!=K[5+Q]||0!=K[6+Q]||0!=K[7+Q]?(j=N*K[0+Q]+128>>8,G=N*K[4+Q]+128>>8,H=K[2+Q],V=K[6+Q],q=O*(K[1+Q]-K[7+Q])+128>>8,W=O*(K[1+Q]+K[7+Q])+128>>8,Z=K[3+Q]<<4,$=K[5+Q]<<4,X=j-G+1>>1,j=j+G+1>>1,G=X,X=H*P+V*z+128>>8,H=H*z-V*P+128>>8,V=X,X=q-$+1>>1,q=q+$+1>>1,$=X,X=W+Z+1>>1,Z=W-Z+1>>1,W=X,X=j-V+1>>1,j=j+V+1>>1,V=X,X=G-H+1>>1,G=G+H+1>>1,H=X,X=q*I+W*k+2048>>12,q=q*k-W*I+2048>>12,W=X,X=Z*y+$*m+2048>>12,Z=Z*m-$*y+2048>>12,$=X,K[0+Q]=j+W,K[7+Q]=j-W,K[1+Q]=G+$,K[6+Q]=G-$,K[2+Q]=H+Z,K[5+Q]=H-Z,K[3+Q]=V+q,K[4+Q]=V-q):(X=N*K[0+Q]+512>>10,K[0+Q]=X,K[1+Q]=X,K[2+Q]=X,K[3+Q]=X,K[4+Q]=X,K[5+Q]=X,K[6+Q]=X,K[7+Q]=X)}for(J=0;J<8;++J){var tt=J;0!=K[8+tt]||0!=K[16+tt]||0!=K[24+tt]||0!=K[32+tt]||0!=K[40+tt]||0!=K[48+tt]||0!=K[56+tt]?(j=N*K[0+tt]+2048>>12,G=N*K[32+tt]+2048>>12,H=K[16+tt],V=K[48+tt],q=O*(K[8+tt]-K[56+tt])+2048>>12,W=O*(K[8+tt]+K[56+tt])+2048>>12,Z=K[24+tt],$=K[40+tt],X=j-G+1>>1,j=j+G+1>>1,G=X,X=H*P+V*z+2048>>12,H=H*z-V*P+2048>>12,V=X,X=q-$+1>>1,q=q+$+1>>1,$=X,X=W+Z+1>>1,Z=W-Z+1>>1,W=X,X=j-V+1>>1,j=j+V+1>>1,V=X,X=G-H+1>>1,G=G+H+1>>1,H=X,X=q*I+W*k+2048>>12,q=q*k-W*I+2048>>12,W=X,X=Z*y+$*m+2048>>12,Z=Z*m-$*y+2048>>12,$=X,K[0+tt]=j+W,K[56+tt]=j-W,K[8+tt]=G+$,K[48+tt]=G-$,K[16+tt]=H+Z,K[40+tt]=H-Z,K[24+tt]=V+q,K[32+tt]=V-q):(X=N*B[J+0]+8192>>14,K[0+tt]=X,K[8+tt]=X,K[16+tt]=X,K[24+tt]=X,K[32+tt]=X,K[40+tt]=X,K[48+tt]=X,K[56+tt]=X)}for(J=0;J<64;++J){var et=128+(K[J]+8>>4);M[J]=et<0?0:et>255?255:et}}w(V*H*8);for(var $=0;$<H;$++){var W=$<<3;for(M=0;M<8;M++)j.push(new Uint8Array(V));for(var X=0;X<G;X++){b(U.blocks[$][X],Z,q);var J=0,Y=X<<3;for(B=0;B<8;B++){var K=j[W+B];for(M=0;M<8;M++)K[Y+M]=Z[J++]}}}return j}function c(g){return g<0?0:g>255?255:g}f.prototype={load:function(g){var m=new XMLHttpRequest;m.open("GET",g,!0),m.responseType="arraybuffer",m.onload=function(){var g=new Uint8Array(m.response||m.mozResponseArrayBuffer);this.parse(g),this.onload&&this.onload()}.bind(this),m.send(null)},parse:function(m){var y=1e3*this.opts.maxResolutionInMP*1e3,k=0;function n(){var g=m[k]<<8|m[k+1];return k+=2,g}function a(g){var m,y,k=1,I=1;for(y in g.components)g.components.hasOwnProperty(y)&&(k<(m=g.components[y]).h&&(k=m.h),I<m.v&&(I=m.v));var z=Math.ceil(g.samplesPerLine/8/k),P=Math.ceil(g.scanLines/8/I);for(y in g.components)if(g.components.hasOwnProperty(y)){m=g.components[y];var N=Math.ceil(Math.ceil(g.samplesPerLine/8)*m.h/k),O=Math.ceil(Math.ceil(g.scanLines/8)*m.v/I),U=z*m.h,M=P*m.v,B=[];w(M*U*256);for(var j=0;j<M;j++){for(var G=[],H=0;H<U;H++)G.push(new Int32Array(64));B.push(G)}m.blocksPerLine=N,m.blocksPerColumn=O,m.blocks=B}g.maxH=k,g.maxV=I,g.mcusPerLine=z,g.mcusPerColumn=P}m.length;var I,z,P,N,O=null,U=null,M=[],B=[],j=[],G=[],H=n(),V=-1;if(this.comments=[],65496!=H)throw new Error("SOI not found");for(H=n();65497!=H;){switch(H){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var q=(void 0,void 0,P=n(),N=m.subarray(k,k+P-2),k+=N.length,N);if(65534===H){var Z=String.fromCharCode.apply(null,q);this.comments.push(Z)}65504===H&&74===q[0]&&70===q[1]&&73===q[2]&&70===q[3]&&0===q[4]&&(O={version:{major:q[5],minor:q[6]},densityUnits:q[7],xDensity:q[8]<<8|q[9],yDensity:q[10]<<8|q[11],thumbWidth:q[12],thumbHeight:q[13],thumbData:q.subarray(14,14+3*q[12]*q[13])}),65505===H&&69===q[0]&&120===q[1]&&105===q[2]&&102===q[3]&&0===q[4]&&(this.exifBuffer=q.subarray(5,q.length)),65518===H&&65===q[0]&&100===q[1]&&111===q[2]&&98===q[3]&&101===q[4]&&0===q[5]&&(U={version:q[6],flags0:q[7]<<8|q[8],flags1:q[9]<<8|q[10],transformCode:q[11]});break;case 65499:for(var $=n()+k-2;k<$;){var W=m[k++];w(256);var X=new Int32Array(64);if(W>>4==0)for(te=0;te<64;te++)X[g[te]]=m[k++];else{if(W>>4!=1)throw new Error("DQT: invalid table spec");for(te=0;te<64;te++)X[g[te]]=n()}M[15&W]=X}break;case 65472:case 65473:case 65474:n(),(I={}).extended=65473===H,I.progressive=65474===H,I.precision=m[k++],I.scanLines=n(),I.samplesPerLine=n(),I.components={},I.componentsOrder=[];var J=I.scanLines*I.samplesPerLine;if(J>y){var Y=Math.ceil((J-y)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Y}MP`)}var K,Q=m[k++];for(Yt=0;Yt<Q;Yt++){K=m[k];var tt=m[k+1]>>4,et=15&m[k+1],vt=m[k+2];if(tt<=0||et<=0)throw new Error("Invalid sampling factor, expected values above 0");I.componentsOrder.push(K),I.components[K]={h:tt,v:et,quantizationIdx:vt},k+=3}a(I),B.push(I);break;case 65476:var yt=n();for(Yt=2;Yt<yt;){var xt=m[k++],kt=new Uint8Array(16),Et=0;for(te=0;te<16;te++,k++)Et+=kt[te]=m[k];w(16+Et);var It=new Uint8Array(Et);for(te=0;te<Et;te++,k++)It[te]=m[k];Yt+=17+Et,(xt>>4==0?G:j)[15&xt]=l(kt,It)}break;case 65501:n(),z=n();break;case 65500:n(),n();break;case 65498:n();var zt=m[k++],Ut=[];for(Yt=0;Yt<zt;Yt++){ee=I.components[m[k++]];var Bt=m[k++];ee.huffmanTableDC=G[Bt>>4],ee.huffmanTableAC=j[15&Bt],Ut.push(ee)}var jt=m[k++],Wt=m[k++],Xt=m[k++],Jt=d(m,k,I,Ut,z,jt,Wt,Xt>>4,15&Xt,this.opts);k+=Jt;break;case 65535:255!==m[k]&&k--;break;default:if(255==m[k-3]&&m[k-2]>=192&&m[k-2]<=254){k-=3;break}if(224===H||225==H){if(-1!==V)throw new Error(`first unknown JPEG marker at offset ${V.toString(16)}, second unknown JPEG marker ${H.toString(16)} at offset ${(k-1).toString(16)}`);V=k-1;const g=n();if(255===m[k+g-2]){k+=g-2;break}}throw new Error("unknown JPEG marker "+H.toString(16))}H=n()}if(1!=B.length)throw new Error("only single frame JPEGs supported");for(var Yt=0;Yt<B.length;Yt++){var Kt=B[Yt].components;for(var te in Kt)Kt[te].quantizationTable=M[Kt[te].quantizationIdx],delete Kt[te].quantizationIdx}for(this.width=I.samplesPerLine,this.height=I.scanLines,this.jfif=O,this.adobe=U,this.components=[],Yt=0;Yt<I.componentsOrder.length;Yt++){var ee=I.components[I.componentsOrder[Yt]];this.components.push({lines:u(0,ee),scaleX:ee.h/I.maxH,scaleY:ee.v/I.maxV})}},getData:function(g,m){var y,k,I,z,P,N,O,U,M,B,j,G,H,V,q,Z,$,W,X,J,Y,K=this.width/g,Q=this.height/m,tt=0,et=g*m*this.components.length;w(et);var vt=new Uint8Array(et);switch(this.components.length){case 1:for(y=this.components[0],B=0;B<m;B++)for(P=y.lines[0|B*y.scaleY*Q],M=0;M<g;M++)j=P[0|M*y.scaleX*K],vt[tt++]=j;break;case 2:for(y=this.components[0],k=this.components[1],B=0;B<m;B++)for(P=y.lines[0|B*y.scaleY*Q],N=k.lines[0|B*k.scaleY*Q],M=0;M<g;M++)j=P[0|M*y.scaleX*K],vt[tt++]=j,j=N[0|M*k.scaleX*K],vt[tt++]=j;break;case 3:for(Y=!0,this.adobe&&this.adobe.transformCode?Y=!0:void 0!==this.opts.colorTransform&&(Y=!!this.opts.colorTransform),y=this.components[0],k=this.components[1],I=this.components[2],B=0;B<m;B++)for(P=y.lines[0|B*y.scaleY*Q],N=k.lines[0|B*k.scaleY*Q],O=I.lines[0|B*I.scaleY*Q],M=0;M<g;M++)Y?(j=P[0|M*y.scaleX*K],G=N[0|M*k.scaleX*K],W=c(j+1.402*((H=O[0|M*I.scaleX*K])-128)),X=c(j-.3441363*(G-128)-.71413636*(H-128)),J=c(j+1.772*(G-128))):(W=P[0|M*y.scaleX*K],X=N[0|M*k.scaleX*K],J=O[0|M*I.scaleX*K]),vt[tt++]=W,vt[tt++]=X,vt[tt++]=J;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(Y=!1,this.adobe&&this.adobe.transformCode?Y=!0:void 0!==this.opts.colorTransform&&(Y=!!this.opts.colorTransform),y=this.components[0],k=this.components[1],I=this.components[2],z=this.components[3],B=0;B<m;B++)for(P=y.lines[0|B*y.scaleY*Q],N=k.lines[0|B*k.scaleY*Q],O=I.lines[0|B*I.scaleY*Q],U=z.lines[0|B*z.scaleY*Q],M=0;M<g;M++)Y?(j=P[0|M*y.scaleX*K],G=N[0|M*k.scaleX*K],H=O[0|M*I.scaleX*K],V=U[0|M*z.scaleX*K],q=255-c(j+1.402*(H-128)),Z=255-c(j-.3441363*(G-128)-.71413636*(H-128)),$=255-c(j+1.772*(G-128))):(q=P[0|M*y.scaleX*K],Z=N[0|M*k.scaleX*K],$=O[0|M*I.scaleX*K],V=U[0|M*z.scaleX*K]),vt[tt++]=255-q,vt[tt++]=255-Z,vt[tt++]=255-$,vt[tt++]=255-V;break;default:throw new Error("Unsupported color mode")}return vt},copyToImageData:function(g,m){var y,k,I,z,P,N,O,U,M,B=g.width,j=g.height,G=g.data,H=this.getData(B,j),V=0,q=0;switch(this.components.length){case 1:for(k=0;k<j;k++)for(y=0;y<B;y++)I=H[V++],G[q++]=I,G[q++]=I,G[q++]=I,m&&(G[q++]=255);break;case 3:for(k=0;k<j;k++)for(y=0;y<B;y++)O=H[V++],U=H[V++],M=H[V++],G[q++]=O,G[q++]=U,G[q++]=M,m&&(G[q++]=255);break;case 4:for(k=0;k<j;k++)for(y=0;y<B;y++)P=H[V++],N=H[V++],I=H[V++],O=255-c(P*(1-(z=H[V++])/255)+z),U=255-c(N*(1-z/255)+z),M=255-c(I*(1-z/255)+z),G[q++]=O,G[q++]=U,G[q++]=M,m&&(G[q++]=255);break;default:throw new Error("Unsupported color mode")}}};var U=0,M=0;function w(g=0){var m=U+g;if(m>M){var y=Math.ceil((m-M)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${y}MB`)}U=m}return f.resetMaxMemoryUsage=function(g){U=0,M=g},f.getBytesAllocated=function(){return U},f.requestMemoryAllocation=w,f}(),kt.exports=function(g,m={}){var y={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...m},k=new Uint8Array(g),I=new Et;I.opts=y,Et.resetMaxMemoryUsage(1024*y.maxMemoryUsageInMB*1024),I.parse(k);var z=y.formatAsRGBA?4:3,P=I.width*I.height*z;try{Et.requestMemoryAllocation(P);var N={width:I.width,height:I.height,exifBuffer:I.exifBuffer,data:y.useTArray?new Uint8Array(P):Buffer.alloc(P)};I.comments.length>0&&(N.comments=I.comments)}catch(g){if(g instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+P);if(g instanceof ReferenceError&&"Buffer is not defined"===g.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw g}return I.copyToImageData(N,y.formatAsRGBA),N};var zt={encode:xt.exports,decode:It.exports};const Ut={decode(g){const m=zt.decode(g,{useTArray:!0,colorTransform:!0});return{width:m.width,height:m.height,data:m.data}},encode(g,m){const y=zt.encode(g,m.quality);return new Uint8Array(y.data)}};var Bt={};!function(g){var m="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(g,m){return Object.prototype.hasOwnProperty.call(g,m)}g.assign=function(g){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var y=m.shift();if(y){if("object"!=typeof y)throw new TypeError(y+"must be non-object");for(var k in y)r(y,k)&&(g[k]=y[k])}}return g},g.shrinkBuf=function(g,m){return g.length===m?g:g.subarray?g.subarray(0,m):(g.length=m,g)};var y={arraySet:function(g,m,y,k,I){if(m.subarray&&g.subarray)g.set(m.subarray(y,y+k),I);else for(var z=0;z<k;z++)g[I+z]=m[y+z]},flattenChunks:function(g){var m,y,k,I,z,P;for(k=0,m=0,y=g.length;m<y;m++)k+=g[m].length;for(P=new Uint8Array(k),I=0,m=0,y=g.length;m<y;m++)z=g[m],P.set(z,I),I+=z.length;return P}},k={arraySet:function(g,m,y,k,I){for(var z=0;z<k;z++)g[I+z]=m[y+z]},flattenChunks:function(g){return[].concat.apply([],g)}};g.setTyped=function(m){m?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,y)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,k))},g.setTyped(m)}(Bt);var jt={},Wt={},Xt={},Jt=Bt;function F(g){for(var m=g.length;--m>=0;)g[m]=0}var Yt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Kt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=new Array(576);F(re);var ie=new Array(60);F(ie);var ne=new Array(512);F(ne);var ae=new Array(256);F(ae);var he=new Array(29);F(he);var le,fe,ce,de=new Array(30);function rt(g,m,y,k,I){this.static_tree=g,this.extra_bits=m,this.extra_base=y,this.elems=k,this.max_length=I,this.has_stree=g&&g.length}function it(g,m){this.dyn_tree=g,this.max_code=0,this.stat_desc=m}function nt(g){return g<256?ne[g]:ne[256+(g>>>7)]}function at(g,m){g.pending_buf[g.pending++]=255&m,g.pending_buf[g.pending++]=m>>>8&255}function st(g,m,y){g.bi_valid>16-y?(g.bi_buf|=m<<g.bi_valid&65535,at(g,g.bi_buf),g.bi_buf=m>>16-g.bi_valid,g.bi_valid+=y-16):(g.bi_buf|=m<<g.bi_valid&65535,g.bi_valid+=y)}function ot(g,m,y){st(g,y[2*m],y[2*m+1])}function ht(g,m){var y=0;do{y|=1&g,g>>>=1,y<<=1}while(--m>0);return y>>>1}function ft(g,m,y){var k,I,z=new Array(16),P=0;for(k=1;k<=15;k++)z[k]=P=P+y[k-1]<<1;for(I=0;I<=m;I++){var N=g[2*I+1];0!==N&&(g[2*I]=ht(z[N]++,N))}}function lt(g){var m;for(m=0;m<286;m++)g.dyn_ltree[2*m]=0;for(m=0;m<30;m++)g.dyn_dtree[2*m]=0;for(m=0;m<19;m++)g.bl_tree[2*m]=0;g.dyn_ltree[512]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function dt(g){g.bi_valid>8?at(g,g.bi_buf):g.bi_valid>0&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function ut(g,m,y,k){var I=2*m,z=2*y;return g[I]<g[z]||g[I]===g[z]&&k[m]<=k[y]}function ct(g,m,y){for(var k=g.heap[y],I=y<<1;I<=g.heap_len&&(I<g.heap_len&&ut(m,g.heap[I+1],g.heap[I],g.depth)&&I++,!ut(m,k,g.heap[I],g.depth));)g.heap[y]=g.heap[I],y=I,I<<=1;g.heap[y]=k}function pt(g,m,y){var k,I,z,P,N=0;if(0!==g.last_lit)do{k=g.pending_buf[g.d_buf+2*N]<<8|g.pending_buf[g.d_buf+2*N+1],I=g.pending_buf[g.l_buf+N],N++,0===k?ot(g,I,m):(ot(g,(z=ae[I])+256+1,m),0!==(P=Yt[z])&&st(g,I-=he[z],P),ot(g,z=nt(--k),y),0!==(P=Kt[z])&&st(g,k-=de[z],P))}while(N<g.last_lit);ot(g,256,m)}function gt(g,m){var y,k,I,z=m.dyn_tree,P=m.stat_desc.static_tree,N=m.stat_desc.has_stree,O=m.stat_desc.elems,U=-1;for(g.heap_len=0,g.heap_max=573,y=0;y<O;y++)0!==z[2*y]?(g.heap[++g.heap_len]=U=y,g.depth[y]=0):z[2*y+1]=0;for(;g.heap_len<2;)z[2*(I=g.heap[++g.heap_len]=U<2?++U:0)]=1,g.depth[I]=0,g.opt_len--,N&&(g.static_len-=P[2*I+1]);for(m.max_code=U,y=g.heap_len>>1;y>=1;y--)ct(g,z,y);I=O;do{y=g.heap[1],g.heap[1]=g.heap[g.heap_len--],ct(g,z,1),k=g.heap[1],g.heap[--g.heap_max]=y,g.heap[--g.heap_max]=k,z[2*I]=z[2*y]+z[2*k],g.depth[I]=(g.depth[y]>=g.depth[k]?g.depth[y]:g.depth[k])+1,z[2*y+1]=z[2*k+1]=I,g.heap[1]=I++,ct(g,z,1)}while(g.heap_len>=2);g.heap[--g.heap_max]=g.heap[1],function(g,m){var y,k,I,z,P,N,O=m.dyn_tree,U=m.max_code,M=m.stat_desc.static_tree,B=m.stat_desc.has_stree,j=m.stat_desc.extra_bits,G=m.stat_desc.extra_base,H=m.stat_desc.max_length,V=0;for(z=0;z<=15;z++)g.bl_count[z]=0;for(O[2*g.heap[g.heap_max]+1]=0,y=g.heap_max+1;y<573;y++)(z=O[2*O[2*(k=g.heap[y])+1]+1]+1)>H&&(z=H,V++),O[2*k+1]=z,k>U||(g.bl_count[z]++,P=0,k>=G&&(P=j[k-G]),N=O[2*k],g.opt_len+=N*(z+P),B&&(g.static_len+=N*(M[2*k+1]+P)));if(0!==V){do{for(z=H-1;0===g.bl_count[z];)z--;g.bl_count[z]--,g.bl_count[z+1]+=2,g.bl_count[H]--,V-=2}while(V>0);for(z=H;0!==z;z--)for(k=g.bl_count[z];0!==k;)(I=g.heap[--y])>U||(O[2*I+1]!==z&&(g.opt_len+=(z-O[2*I+1])*O[2*I],O[2*I+1]=z),k--)}}(g,m),ft(z,U,g.bl_count)}function wt(g,m,y){var k,I,z=-1,P=m[1],N=0,O=7,U=4;for(0===P&&(O=138,U=3),m[2*(y+1)+1]=65535,k=0;k<=y;k++)I=P,P=m[2*(k+1)+1],++N<O&&I===P||(N<U?g.bl_tree[2*I]+=N:0!==I?(I!==z&&g.bl_tree[2*I]++,g.bl_tree[32]++):N<=10?g.bl_tree[34]++:g.bl_tree[36]++,N=0,z=I,0===P?(O=138,U=3):I===P?(O=6,U=3):(O=7,U=4))}function _t(g,m,y){var k,I,z=-1,P=m[1],N=0,O=7,U=4;for(0===P&&(O=138,U=3),k=0;k<=y;k++)if(I=P,P=m[2*(k+1)+1],!(++N<O&&I===P)){if(N<U)do{ot(g,I,g.bl_tree)}while(0!=--N);else 0!==I?(I!==z&&(ot(g,I,g.bl_tree),N--),ot(g,16,g.bl_tree),st(g,N-3,2)):N<=10?(ot(g,17,g.bl_tree),st(g,N-3,3)):(ot(g,18,g.bl_tree),st(g,N-11,7));N=0,z=I,0===P?(O=138,U=3):I===P?(O=6,U=3):(O=7,U=4)}}F(de);var ue=!1;function bt(g,m,y,k){st(g,0+(k?1:0),3),function(g,m,y,k){dt(g),at(g,y),at(g,~y),Jt.arraySet(g.pending_buf,g.window,m,y,g.pending),g.pending+=y}(g,m,y)}Xt._tr_init=function(g){ue||(function(){var g,m,y,k,I,z=new Array(16);for(y=0,k=0;k<28;k++)for(he[k]=y,g=0;g<1<<Yt[k];g++)ae[y++]=k;for(ae[y-1]=k,I=0,k=0;k<16;k++)for(de[k]=I,g=0;g<1<<Kt[k];g++)ne[I++]=k;for(I>>=7;k<30;k++)for(de[k]=I<<7,g=0;g<1<<Kt[k]-7;g++)ne[256+I++]=k;for(m=0;m<=15;m++)z[m]=0;for(g=0;g<=143;)re[2*g+1]=8,g++,z[8]++;for(;g<=255;)re[2*g+1]=9,g++,z[9]++;for(;g<=279;)re[2*g+1]=7,g++,z[7]++;for(;g<=287;)re[2*g+1]=8,g++,z[8]++;for(ft(re,287,z),g=0;g<30;g++)ie[2*g+1]=5,ie[2*g]=ht(g,5);le=new rt(re,Yt,257,286,15),fe=new rt(ie,Kt,0,30,15),ce=new rt(new Array(0),te,0,19,7)}(),ue=!0),g.l_desc=new it(g.dyn_ltree,le),g.d_desc=new it(g.dyn_dtree,fe),g.bl_desc=new it(g.bl_tree,ce),g.bi_buf=0,g.bi_valid=0,lt(g)},Xt._tr_stored_block=bt,Xt._tr_flush_block=function(g,m,y,k){var I,z,P=0;g.level>0?(2===g.strm.data_type&&(g.strm.data_type=function(g){var m,y=4093624447;for(m=0;m<=31;m++,y>>>=1)if(1&y&&0!==g.dyn_ltree[2*m])return 0;if(0!==g.dyn_ltree[18]||0!==g.dyn_ltree[20]||0!==g.dyn_ltree[26])return 1;for(m=32;m<256;m++)if(0!==g.dyn_ltree[2*m])return 1;return 0}(g)),gt(g,g.l_desc),gt(g,g.d_desc),P=function(g){var m;for(wt(g,g.dyn_ltree,g.l_desc.max_code),wt(g,g.dyn_dtree,g.d_desc.max_code),gt(g,g.bl_desc),m=18;m>=3&&0===g.bl_tree[2*ee[m]+1];m--);return g.opt_len+=3*(m+1)+5+5+4,m}(g),I=g.opt_len+3+7>>>3,(z=g.static_len+3+7>>>3)<=I&&(I=z)):I=z=y+5,y+4<=I&&-1!==m?bt(g,m,y,k):4===g.strategy||z===I?(st(g,2+(k?1:0),3),pt(g,re,ie)):(st(g,4+(k?1:0),3),function(g,m,y,k){var I;for(st(g,m-257,5),st(g,y-1,5),st(g,k-4,4),I=0;I<k;I++)st(g,g.bl_tree[2*ee[I]+1],3);_t(g,g.dyn_ltree,m-1),_t(g,g.dyn_dtree,y-1)}(g,g.l_desc.max_code+1,g.d_desc.max_code+1,P+1),pt(g,g.dyn_ltree,g.dyn_dtree)),lt(g),k&&dt(g)},Xt._tr_tally=function(g,m,y){return g.pending_buf[g.d_buf+2*g.last_lit]=m>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&m,g.pending_buf[g.l_buf+g.last_lit]=255&y,g.last_lit++,0===m?g.dyn_ltree[2*y]++:(g.matches++,m--,g.dyn_ltree[2*(ae[y]+256+1)]++,g.dyn_dtree[2*nt(m)]++),g.last_lit===g.lit_bufsize-1},Xt._tr_align=function(g){st(g,2,3),ot(g,256,re),function(g){16===g.bi_valid?(at(g,g.bi_buf),g.bi_buf=0,g.bi_valid=0):g.bi_valid>=8&&(g.pending_buf[g.pending++]=255&g.bi_buf,g.bi_buf>>=8,g.bi_valid-=8)}(g)};var pe,mt=function(g,m,y,k){for(var I=65535&g|0,z=g>>>16&65535|0,P=0;0!==y;){y-=P=y>2e3?2e3:y;do{z=z+(I=I+m[k++]|0)|0}while(--P);I%=65521,z%=65521}return I|z<<16|0},ge=function(){for(var g,m=[],y=0;y<256;y++){g=y;for(var k=0;k<8;k++)g=1&g?3988292384^g>>>1:g>>>1;m[y]=g}return m}(),At=function(g,m,y,k){var I=ge,z=k+y;g^=-1;for(var P=k;P<z;P++)g=g>>>8^I[255&(g^m[P])];return-1^g},we={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Te=Bt,Ie=Xt,Ce=mt,Se=At,ze=we;function Pt(g,m){return g.msg=ze[m],m}function Mt(g){return(g<<1)-(g>4?9:0)}function Rt(g){for(var m=g.length;--m>=0;)g[m]=0}function St(g){var m=g.state,y=m.pending;y>g.avail_out&&(y=g.avail_out),0!==y&&(Te.arraySet(g.output,m.pending_buf,m.pending_out,y,g.next_out),g.next_out+=y,m.pending_out+=y,g.total_out+=y,g.avail_out-=y,m.pending-=y,0===m.pending&&(m.pending_out=0))}function Tt(g,m){Ie._tr_flush_block(g,g.block_start>=0?g.block_start:-1,g.strstart-g.block_start,m),g.block_start=g.strstart,St(g.strm)}function Ct(g,m){g.pending_buf[g.pending++]=m}function Lt(g,m){g.pending_buf[g.pending++]=m>>>8&255,g.pending_buf[g.pending++]=255&m}function Dt(g,m){var y,k,I=g.max_chain_length,z=g.strstart,P=g.prev_length,N=g.nice_match,O=g.strstart>g.w_size-262?g.strstart-(g.w_size-262):0,U=g.window,M=g.w_mask,B=g.prev,j=g.strstart+258,G=U[z+P-1],H=U[z+P];g.prev_length>=g.good_match&&(I>>=2),N>g.lookahead&&(N=g.lookahead);do{if(U[(y=m)+P]===H&&U[y+P-1]===G&&U[y]===U[z]&&U[++y]===U[z+1]){z+=2,y++;do{}while(U[++z]===U[++y]&&U[++z]===U[++y]&&U[++z]===U[++y]&&U[++z]===U[++y]&&U[++z]===U[++y]&&U[++z]===U[++y]&&U[++z]===U[++y]&&U[++z]===U[++y]&&z<j);if(k=258-(j-z),z=j-258,k>P){if(g.match_start=m,P=k,k>=N)break;G=U[z+P-1],H=U[z+P]}}}while((m=B[m&M])>O&&0!=--I);return P<=g.lookahead?P:g.lookahead}function Ht(g){var m,y,k,I,z,P,N,O,U,M,B=g.w_size;do{if(I=g.window_size-g.lookahead-g.strstart,g.strstart>=B+(B-262)){Te.arraySet(g.window,g.window,B,B,0),g.match_start-=B,g.strstart-=B,g.block_start-=B,m=y=g.hash_size;do{k=g.head[--m],g.head[m]=k>=B?k-B:0}while(--y);m=y=B;do{k=g.prev[--m],g.prev[m]=k>=B?k-B:0}while(--y);I+=B}if(0===g.strm.avail_in)break;if(P=g.strm,N=g.window,O=g.strstart+g.lookahead,U=I,M=void 0,(M=P.avail_in)>U&&(M=U),y=0===M?0:(P.avail_in-=M,Te.arraySet(N,P.input,P.next_in,M,O),1===P.state.wrap?P.adler=Ce(P.adler,N,M,O):2===P.state.wrap&&(P.adler=Se(P.adler,N,M,O)),P.next_in+=M,P.total_in+=M,M),g.lookahead+=y,g.lookahead+g.insert>=3)for(z=g.strstart-g.insert,g.ins_h=g.window[z],g.ins_h=(g.ins_h<<g.hash_shift^g.window[z+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[z+3-1])&g.hash_mask,g.prev[z&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=z,z++,g.insert--,!(g.lookahead+g.insert<3)););}while(g.lookahead<262&&0!==g.strm.avail_in)}function Nt(g,m){for(var y,k;;){if(g.lookahead<262){if(Ht(g),g.lookahead<262&&0===m)return 1;if(0===g.lookahead)break}if(y=0,g.lookahead>=3&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+3-1])&g.hash_mask,y=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),0!==y&&g.strstart-y<=g.w_size-262&&(g.match_length=Dt(g,y)),g.match_length>=3)if(k=Ie._tr_tally(g,g.strstart-g.match_start,g.match_length-3),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=3){g.match_length--;do{g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+3-1])&g.hash_mask,y=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart}while(0!=--g.match_length);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else k=Ie._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(k&&(Tt(g,!1),0===g.strm.avail_out))return 1}return g.insert=g.strstart<2?g.strstart:2,4===m?(Tt(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(Tt(g,!1),0===g.strm.avail_out)?1:2}function Gt(g,m){for(var y,k,I;;){if(g.lookahead<262){if(Ht(g),g.lookahead<262&&0===m)return 1;if(0===g.lookahead)break}if(y=0,g.lookahead>=3&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+3-1])&g.hash_mask,y=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=2,0!==y&&g.prev_length<g.max_lazy_match&&g.strstart-y<=g.w_size-262&&(g.match_length=Dt(g,y),g.match_length<=5&&(1===g.strategy||3===g.match_length&&g.strstart-g.match_start>4096)&&(g.match_length=2)),g.prev_length>=3&&g.match_length<=g.prev_length){I=g.strstart+g.lookahead-3,k=Ie._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-3),g.lookahead-=g.prev_length-1,g.prev_length-=2;do{++g.strstart<=I&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+3-1])&g.hash_mask,y=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart)}while(0!=--g.prev_length);if(g.match_available=0,g.match_length=2,g.strstart++,k&&(Tt(g,!1),0===g.strm.avail_out))return 1}else if(g.match_available){if((k=Ie._tr_tally(g,0,g.window[g.strstart-1]))&&Tt(g,!1),g.strstart++,g.lookahead--,0===g.strm.avail_out)return 1}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(k=Ie._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<2?g.strstart:2,4===m?(Tt(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(Tt(g,!1),0===g.strm.avail_out)?1:2}function Ot(g,m,y,k,I){this.good_length=g,this.max_lazy=m,this.nice_length=y,this.max_chain=k,this.func=I}function Ft(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Te.Buf16(1146),this.dyn_dtree=new Te.Buf16(122),this.bl_tree=new Te.Buf16(78),Rt(this.dyn_ltree),Rt(this.dyn_dtree),Rt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Te.Buf16(16),this.heap=new Te.Buf16(573),Rt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Te.Buf16(573),Rt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Zt(g){var m;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=2,(m=g.state).pending=0,m.pending_out=0,m.wrap<0&&(m.wrap=-m.wrap),m.status=m.wrap?42:113,g.adler=2===m.wrap?0:1,m.last_flush=0,Ie._tr_init(m),0):Pt(g,-2)}function qt(g){var m,y=Zt(g);return 0===y&&((m=g.state).window_size=2*m.w_size,Rt(m.head),m.max_lazy_match=pe[m.level].max_lazy,m.good_match=pe[m.level].good_length,m.nice_match=pe[m.level].nice_length,m.max_chain_length=pe[m.level].max_chain,m.strstart=0,m.block_start=0,m.lookahead=0,m.insert=0,m.match_length=m.prev_length=2,m.match_available=0,m.ins_h=0),y}function Vt(g,m,y,k,I,z){if(!g)return-2;var P=1;if(-1===m&&(m=6),k<0?(P=0,k=-k):k>15&&(P=2,k-=16),I<1||I>9||8!==y||k<8||k>15||m<0||m>9||z<0||z>4)return Pt(g,-2);8===k&&(k=9);var N=new Ft;return g.state=N,N.strm=g,N.wrap=P,N.gzhead=null,N.w_bits=k,N.w_size=1<<N.w_bits,N.w_mask=N.w_size-1,N.hash_bits=I+7,N.hash_size=1<<N.hash_bits,N.hash_mask=N.hash_size-1,N.hash_shift=~~((N.hash_bits+3-1)/3),N.window=new Te.Buf8(2*N.w_size),N.head=new Te.Buf16(N.hash_size),N.prev=new Te.Buf16(N.w_size),N.lit_bufsize=1<<I+6,N.pending_buf_size=4*N.lit_bufsize,N.pending_buf=new Te.Buf8(N.pending_buf_size),N.d_buf=1*N.lit_bufsize,N.l_buf=3*N.lit_bufsize,N.level=m,N.strategy=z,N.method=y,qt(g)}pe=[new Ot(0,0,0,0,(function(g,m){var y=65535;for(y>g.pending_buf_size-5&&(y=g.pending_buf_size-5);;){if(g.lookahead<=1){if(Ht(g),0===g.lookahead&&0===m)return 1;if(0===g.lookahead)break}g.strstart+=g.lookahead,g.lookahead=0;var k=g.block_start+y;if((0===g.strstart||g.strstart>=k)&&(g.lookahead=g.strstart-k,g.strstart=k,Tt(g,!1),0===g.strm.avail_out))return 1;if(g.strstart-g.block_start>=g.w_size-262&&(Tt(g,!1),0===g.strm.avail_out))return 1}return g.insert=0,4===m?(Tt(g,!0),0===g.strm.avail_out?3:4):(g.strstart>g.block_start&&(Tt(g,!1),g.strm.avail_out),1)})),new Ot(4,4,8,4,Nt),new Ot(4,5,16,8,Nt),new Ot(4,6,32,32,Nt),new Ot(4,4,16,16,Gt),new Ot(8,16,32,32,Gt),new Ot(8,16,128,128,Gt),new Ot(8,32,128,256,Gt),new Ot(32,128,258,1024,Gt),new Ot(32,258,258,4096,Gt)],Wt.deflateInit=function(g,m){return Vt(g,m,8,15,8,0)},Wt.deflateInit2=Vt,Wt.deflateReset=qt,Wt.deflateResetKeep=Zt,Wt.deflateSetHeader=function(g,m){return g&&g.state?2!==g.state.wrap?-2:(g.state.gzhead=m,0):-2},Wt.deflate=function(g,m){var y,k,I,z;if(!g||!g.state||m>5||m<0)return g?Pt(g,-2):-2;if(k=g.state,!g.output||!g.input&&0!==g.avail_in||666===k.status&&4!==m)return Pt(g,0===g.avail_out?-5:-2);if(k.strm=g,y=k.last_flush,k.last_flush=m,42===k.status)if(2===k.wrap)g.adler=0,Ct(k,31),Ct(k,139),Ct(k,8),k.gzhead?(Ct(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),Ct(k,255&k.gzhead.time),Ct(k,k.gzhead.time>>8&255),Ct(k,k.gzhead.time>>16&255),Ct(k,k.gzhead.time>>24&255),Ct(k,9===k.level?2:k.strategy>=2||k.level<2?4:0),Ct(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(Ct(k,255&k.gzhead.extra.length),Ct(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(g.adler=Se(g.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(Ct(k,0),Ct(k,0),Ct(k,0),Ct(k,0),Ct(k,0),Ct(k,9===k.level?2:k.strategy>=2||k.level<2?4:0),Ct(k,3),k.status=113);else{var P=8+(k.w_bits-8<<4)<<8;P|=(k.strategy>=2||k.level<2?0:k.level<6?1:6===k.level?2:3)<<6,0!==k.strstart&&(P|=32),P+=31-P%31,k.status=113,Lt(k,P),0!==k.strstart&&(Lt(k,g.adler>>>16),Lt(k,65535&g.adler)),g.adler=1}if(69===k.status)if(k.gzhead.extra){for(I=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>I&&(g.adler=Se(g.adler,k.pending_buf,k.pending-I,I)),St(g),I=k.pending,k.pending!==k.pending_buf_size));)Ct(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>I&&(g.adler=Se(g.adler,k.pending_buf,k.pending-I,I)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(73===k.status)if(k.gzhead.name){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(g.adler=Se(g.adler,k.pending_buf,k.pending-I,I)),St(g),I=k.pending,k.pending===k.pending_buf_size)){z=1;break}z=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0,Ct(k,z)}while(0!==z);k.gzhead.hcrc&&k.pending>I&&(g.adler=Se(g.adler,k.pending_buf,k.pending-I,I)),0===z&&(k.gzindex=0,k.status=91)}else k.status=91;if(91===k.status)if(k.gzhead.comment){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(g.adler=Se(g.adler,k.pending_buf,k.pending-I,I)),St(g),I=k.pending,k.pending===k.pending_buf_size)){z=1;break}z=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0,Ct(k,z)}while(0!==z);k.gzhead.hcrc&&k.pending>I&&(g.adler=Se(g.adler,k.pending_buf,k.pending-I,I)),0===z&&(k.status=103)}else k.status=103;if(103===k.status&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&St(g),k.pending+2<=k.pending_buf_size&&(Ct(k,255&g.adler),Ct(k,g.adler>>8&255),g.adler=0,k.status=113)):k.status=113),0!==k.pending){if(St(g),0===g.avail_out)return k.last_flush=-1,0}else if(0===g.avail_in&&Mt(m)<=Mt(y)&&4!==m)return Pt(g,-5);if(666===k.status&&0!==g.avail_in)return Pt(g,-5);if(0!==g.avail_in||0!==k.lookahead||0!==m&&666!==k.status){var N=2===k.strategy?function(g,m){for(var y;;){if(0===g.lookahead&&(Ht(g),0===g.lookahead)){if(0===m)return 1;break}if(g.match_length=0,y=Ie._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++,y&&(Tt(g,!1),0===g.strm.avail_out))return 1}return g.insert=0,4===m?(Tt(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(Tt(g,!1),0===g.strm.avail_out)?1:2}(k,m):3===k.strategy?function(g,m){for(var y,k,I,z,P=g.window;;){if(g.lookahead<=258){if(Ht(g),g.lookahead<=258&&0===m)return 1;if(0===g.lookahead)break}if(g.match_length=0,g.lookahead>=3&&g.strstart>0&&(k=P[I=g.strstart-1])===P[++I]&&k===P[++I]&&k===P[++I]){z=g.strstart+258;do{}while(k===P[++I]&&k===P[++I]&&k===P[++I]&&k===P[++I]&&k===P[++I]&&k===P[++I]&&k===P[++I]&&k===P[++I]&&I<z);g.match_length=258-(z-I),g.match_length>g.lookahead&&(g.match_length=g.lookahead)}if(g.match_length>=3?(y=Ie._tr_tally(g,1,g.match_length-3),g.lookahead-=g.match_length,g.strstart+=g.match_length,g.match_length=0):(y=Ie._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++),y&&(Tt(g,!1),0===g.strm.avail_out))return 1}return g.insert=0,4===m?(Tt(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(Tt(g,!1),0===g.strm.avail_out)?1:2}(k,m):pe[k.level].func(k,m);if(3!==N&&4!==N||(k.status=666),1===N||3===N)return 0===g.avail_out&&(k.last_flush=-1),0;if(2===N&&(1===m?Ie._tr_align(k):5!==m&&(Ie._tr_stored_block(k,0,0,!1),3===m&&(Rt(k.head),0===k.lookahead&&(k.strstart=0,k.block_start=0,k.insert=0))),St(g),0===g.avail_out))return k.last_flush=-1,0}return 4!==m?0:k.wrap<=0?1:(2===k.wrap?(Ct(k,255&g.adler),Ct(k,g.adler>>8&255),Ct(k,g.adler>>16&255),Ct(k,g.adler>>24&255),Ct(k,255&g.total_in),Ct(k,g.total_in>>8&255),Ct(k,g.total_in>>16&255),Ct(k,g.total_in>>24&255)):(Lt(k,g.adler>>>16),Lt(k,65535&g.adler)),St(g),k.wrap>0&&(k.wrap=-k.wrap),0!==k.pending?0:1)},Wt.deflateEnd=function(g){var m;return g&&g.state?42!==(m=g.state.status)&&69!==m&&73!==m&&91!==m&&103!==m&&113!==m&&666!==m?Pt(g,-2):(g.state=null,113===m?Pt(g,-3):0):-2},Wt.deflateSetDictionary=function(g,m){var y,k,I,z,P,N,O,U,M=m.length;if(!g||!g.state)return-2;if(2===(z=(y=g.state).wrap)||1===z&&42!==y.status||y.lookahead)return-2;for(1===z&&(g.adler=Ce(g.adler,m,M,0)),y.wrap=0,M>=y.w_size&&(0===z&&(Rt(y.head),y.strstart=0,y.block_start=0,y.insert=0),U=new Te.Buf8(y.w_size),Te.arraySet(U,m,M-y.w_size,y.w_size,0),m=U,M=y.w_size),P=g.avail_in,N=g.next_in,O=g.input,g.avail_in=M,g.next_in=0,g.input=m,Ht(y);y.lookahead>=3;){k=y.strstart,I=y.lookahead-2;do{y.ins_h=(y.ins_h<<y.hash_shift^y.window[k+3-1])&y.hash_mask,y.prev[k&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=k,k++}while(--I);y.strstart=k,y.lookahead=2,Ht(y)}return y.strstart+=y.lookahead,y.block_start=y.strstart,y.insert=y.lookahead,y.lookahead=0,y.match_length=y.prev_length=2,y.match_available=0,g.next_in=N,g.input=O,g.avail_in=P,y.wrap=z,0},Wt.deflateInfo="pako deflate (from Nodeca project)";var Ne={},Ue=Bt,Me=!0,Le=!0;try{String.fromCharCode.apply(null,[0])}catch(j){Me=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(j){Le=!1}for(var Re=new Ue.Buf8(256),Fe=0;Fe<256;Fe++)Re[Fe]=Fe>=252?6:Fe>=248?5:Fe>=240?4:Fe>=224?3:Fe>=192?2:1;function $t(g,m){if(m<65534&&(g.subarray&&Le||!g.subarray&&Me))return String.fromCharCode.apply(null,Ue.shrinkBuf(g,m));for(var y="",k=0;k<m;k++)y+=String.fromCharCode(g[k]);return y}Re[254]=Re[254]=1,Ne.string2buf=function(g){var m,y,k,I,z,P=g.length,N=0;for(I=0;I<P;I++)55296==(64512&(y=g.charCodeAt(I)))&&I+1<P&&56320==(64512&(k=g.charCodeAt(I+1)))&&(y=65536+(y-55296<<10)+(k-56320),I++),N+=y<128?1:y<2048?2:y<65536?3:4;for(m=new Ue.Buf8(N),z=0,I=0;z<N;I++)55296==(64512&(y=g.charCodeAt(I)))&&I+1<P&&56320==(64512&(k=g.charCodeAt(I+1)))&&(y=65536+(y-55296<<10)+(k-56320),I++),y<128?m[z++]=y:y<2048?(m[z++]=192|y>>>6,m[z++]=128|63&y):y<65536?(m[z++]=224|y>>>12,m[z++]=128|y>>>6&63,m[z++]=128|63&y):(m[z++]=240|y>>>18,m[z++]=128|y>>>12&63,m[z++]=128|y>>>6&63,m[z++]=128|63&y);return m},Ne.buf2binstring=function(g){return $t(g,g.length)},Ne.binstring2buf=function(g){for(var m=new Ue.Buf8(g.length),y=0,k=m.length;y<k;y++)m[y]=g.charCodeAt(y);return m},Ne.buf2string=function(g,m){var y,k,I,z,P=m||g.length,N=new Array(2*P);for(k=0,y=0;y<P;)if((I=g[y++])<128)N[k++]=I;else if((z=Re[I])>4)N[k++]=65533,y+=z-1;else{for(I&=2===z?31:3===z?15:7;z>1&&y<P;)I=I<<6|63&g[y++],z--;z>1?N[k++]=65533:I<65536?N[k++]=I:(I-=65536,N[k++]=55296|I>>10&1023,N[k++]=56320|1023&I)}return $t(N,k)},Ne.utf8border=function(g,m){var y;for((m=m||g.length)>g.length&&(m=g.length),y=m-1;y>=0&&128==(192&g[y]);)y--;return y<0||0===y?m:y+Re[g[y]]>m?y:m};var Qt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},De=Wt,je=Bt,Ve=Ne,qe=we,Ze=Qt,$e=Object.prototype.toString;function se(g){if(!(this instanceof se))return new se(g);this.options=je.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},g||{});var m=this.options;m.raw&&m.windowBits>0?m.windowBits=-m.windowBits:m.gzip&&m.windowBits>0&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ze,this.strm.avail_out=0;var y=De.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(0!==y)throw new Error(qe[y]);if(m.header&&De.deflateSetHeader(this.strm,m.header),m.dictionary){var k;if(k="string"==typeof m.dictionary?Ve.string2buf(m.dictionary):"[object ArrayBuffer]"===$e.call(m.dictionary)?new Uint8Array(m.dictionary):m.dictionary,0!==(y=De.deflateSetDictionary(this.strm,k)))throw new Error(qe[y]);this._dict_set=!0}}function oe(g,m){var y=new se(m);if(y.push(g,!0),y.err)throw y.msg||qe[y.err];return y.result}se.prototype.push=function(g,m){var y,k,I=this.strm,z=this.options.chunkSize;if(this.ended)return!1;k=m===~~m?m:!0===m?4:0,"string"==typeof g?I.input=Ve.string2buf(g):"[object ArrayBuffer]"===$e.call(g)?I.input=new Uint8Array(g):I.input=g,I.next_in=0,I.avail_in=I.input.length;do{if(0===I.avail_out&&(I.output=new je.Buf8(z),I.next_out=0,I.avail_out=z),1!==(y=De.deflate(I,k))&&0!==y)return this.onEnd(y),this.ended=!0,!1;0!==I.avail_out&&(0!==I.avail_in||4!==k&&2!==k)||("string"===this.options.to?this.onData(Ve.buf2binstring(je.shrinkBuf(I.output,I.next_out))):this.onData(je.shrinkBuf(I.output,I.next_out)))}while((I.avail_in>0||0===I.avail_out)&&1!==y);return 4===k?(y=De.deflateEnd(this.strm),this.onEnd(y),this.ended=!0,0===y):2!==k||(this.onEnd(0),I.avail_out=0,!0)},se.prototype.onData=function(g){this.chunks.push(g)},se.prototype.onEnd=function(g){0===g&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=je.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},jt.Deflate=se,jt.deflate=oe,jt.deflateRaw=function(g,m){return(m=m||{}).raw=!0,oe(g,m)},jt.gzip=function(g,m){return(m=m||{}).gzip=!0,oe(g,m)};var We={},Xe={},Ye=Bt,Qe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],tr=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],sr=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],hr=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],lr=Bt,fr=mt,gr=At,ve=function(g,m){var y,k,I,z,P,N,O,U,M,B,j,G,H,V,q,Z,$,W,X,J,Y,K,Q,tt,et;y=g.state,k=g.next_in,tt=g.input,I=k+(g.avail_in-5),z=g.next_out,et=g.output,P=z-(m-g.avail_out),N=z+(g.avail_out-257),O=y.dmax,U=y.wsize,M=y.whave,B=y.wnext,j=y.window,G=y.hold,H=y.bits,V=y.lencode,q=y.distcode,Z=(1<<y.lenbits)-1,$=(1<<y.distbits)-1;t:do{H<15&&(G+=tt[k++]<<H,H+=8,G+=tt[k++]<<H,H+=8),W=V[G&Z];e:for(;;){if(G>>>=X=W>>>24,H-=X,0==(X=W>>>16&255))et[z++]=65535&W;else{if(!(16&X)){if(0==(64&X)){W=V[(65535&W)+(G&(1<<X)-1)];continue e}if(32&X){y.mode=12;break t}g.msg="invalid literal/length code",y.mode=30;break t}J=65535&W,(X&=15)&&(H<X&&(G+=tt[k++]<<H,H+=8),J+=G&(1<<X)-1,G>>>=X,H-=X),H<15&&(G+=tt[k++]<<H,H+=8,G+=tt[k++]<<H,H+=8),W=q[G&$];r:for(;;){if(G>>>=X=W>>>24,H-=X,!(16&(X=W>>>16&255))){if(0==(64&X)){W=q[(65535&W)+(G&(1<<X)-1)];continue r}g.msg="invalid distance code",y.mode=30;break t}if(Y=65535&W,H<(X&=15)&&(G+=tt[k++]<<H,(H+=8)<X&&(G+=tt[k++]<<H,H+=8)),(Y+=G&(1<<X)-1)>O){g.msg="invalid distance too far back",y.mode=30;break t}if(G>>>=X,H-=X,Y>(X=z-P)){if((X=Y-X)>M&&y.sane){g.msg="invalid distance too far back",y.mode=30;break t}if(K=0,Q=j,0===B){if(K+=U-X,X<J){J-=X;do{et[z++]=j[K++]}while(--X);K=z-Y,Q=et}}else if(B<X){if(K+=U+B-X,(X-=B)<J){J-=X;do{et[z++]=j[K++]}while(--X);if(K=0,B<J){J-=X=B;do{et[z++]=j[K++]}while(--X);K=z-Y,Q=et}}}else if(K+=B-X,X<J){J-=X;do{et[z++]=j[K++]}while(--X);K=z-Y,Q=et}for(;J>2;)et[z++]=Q[K++],et[z++]=Q[K++],et[z++]=Q[K++],J-=3;J&&(et[z++]=Q[K++],J>1&&(et[z++]=Q[K++]))}else{K=z-Y;do{et[z++]=et[K++],et[z++]=et[K++],et[z++]=et[K++],J-=3}while(J>2);J&&(et[z++]=et[K++],J>1&&(et[z++]=et[K++]))}break}}break}}while(k<I&&z<N);k-=J=H>>3,G&=(1<<(H-=J<<3))-1,g.next_in=k,g.next_out=z,g.avail_in=k<I?I-k+5:5-(k-I),g.avail_out=z<N?N-z+257:257-(z-N),y.hold=G,y.bits=H},be=function(g,m,y,k,I,z,P,N){var O,U,M,B,j,G,H,V,q,Z=N.bits,$=0,W=0,X=0,J=0,Y=0,K=0,Q=0,tt=0,et=0,vt=0,yt=null,xt=0,kt=new Ye.Buf16(16),Et=new Ye.Buf16(16),It=null,zt=0;for($=0;$<=15;$++)kt[$]=0;for(W=0;W<k;W++)kt[m[y+W]]++;for(Y=Z,J=15;J>=1&&0===kt[J];J--);if(Y>J&&(Y=J),0===J)return I[z++]=20971520,I[z++]=20971520,N.bits=1,0;for(X=1;X<J&&0===kt[X];X++);for(Y<X&&(Y=X),tt=1,$=1;$<=15;$++)if(tt<<=1,(tt-=kt[$])<0)return-1;if(tt>0&&(0===g||1!==J))return-1;for(Et[1]=0,$=1;$<15;$++)Et[$+1]=Et[$]+kt[$];for(W=0;W<k;W++)0!==m[y+W]&&(P[Et[m[y+W]]++]=W);if(0===g?(yt=It=P,G=19):1===g?(yt=Qe,xt-=257,It=tr,zt-=257,G=256):(yt=sr,It=hr,G=-1),vt=0,W=0,$=X,j=z,K=Y,Q=0,M=-1,B=(et=1<<Y)-1,1===g&&et>852||2===g&&et>592)return 1;for(;;){H=$-Q,P[W]<G?(V=0,q=P[W]):P[W]>G?(V=It[zt+P[W]],q=yt[xt+P[W]]):(V=96,q=0),O=1<<$-Q,X=U=1<<K;do{I[j+(vt>>Q)+(U-=O)]=H<<24|V<<16|q|0}while(0!==U);for(O=1<<$-1;vt&O;)O>>=1;if(0!==O?(vt&=O-1,vt+=O):vt=0,W++,0==--kt[$]){if($===J)break;$=m[y+P[W]]}if($>Y&&(vt&B)!==M){for(0===Q&&(Q=Y),j+=X,tt=1<<(K=$-Q);K+Q<J&&!((tt-=kt[K+Q])<=0);)K++,tt<<=1;if(et+=1<<K,1===g&&et>852||2===g&&et>592)return 1;I[M=vt&B]=Y<<24|K<<16|j-z|0}}return 0!==vt&&(I[j+vt]=$-Q<<24|64<<16|0),N.bits=Y,0};function me(g){return(g>>>24&255)+(g>>>8&65280)+((65280&g)<<8)+((255&g)<<24)}function ye(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new lr.Buf16(320),this.work=new lr.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ke(g){var m;return g&&g.state?(m=g.state,g.total_in=g.total_out=m.total=0,g.msg="",m.wrap&&(g.adler=1&m.wrap),m.mode=1,m.last=0,m.havedict=0,m.dmax=32768,m.head=null,m.hold=0,m.bits=0,m.lencode=m.lendyn=new lr.Buf32(852),m.distcode=m.distdyn=new lr.Buf32(592),m.sane=1,m.back=-1,0):-2}function Ae(g){var m;return g&&g.state?((m=g.state).wsize=0,m.whave=0,m.wnext=0,ke(g)):-2}function xe(g,m){var y,k;return g&&g.state?(k=g.state,m<0?(y=0,m=-m):(y=1+(m>>4),m<48&&(m&=15)),m&&(m<8||m>15)?-2:(null!==k.window&&k.wbits!==m&&(k.window=null),k.wrap=y,k.wbits=m,Ae(g))):-2}function Ee(g,m){var y,k;return g?(k=new ye,g.state=k,k.window=null,0!==(y=xe(g,m))&&(g.state=null),y):-2}var mr,br,vr=!0;function Be(g){if(vr){var m;for(mr=new lr.Buf32(512),br=new lr.Buf32(32),m=0;m<144;)g.lens[m++]=8;for(;m<256;)g.lens[m++]=9;for(;m<280;)g.lens[m++]=7;for(;m<288;)g.lens[m++]=8;for(be(1,g.lens,0,288,mr,0,g.work,{bits:9}),m=0;m<32;)g.lens[m++]=5;be(2,g.lens,0,32,br,0,g.work,{bits:5}),vr=!1}g.lencode=mr,g.lenbits=9,g.distcode=br,g.distbits=5}function Pe(g,m,y,k){var I,z=g.state;return null===z.window&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new lr.Buf8(z.wsize)),k>=z.wsize?(lr.arraySet(z.window,m,y-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):((I=z.wsize-z.wnext)>k&&(I=k),lr.arraySet(z.window,m,y-k,I,z.wnext),(k-=I)?(lr.arraySet(z.window,m,y-k,k,0),z.wnext=k,z.whave=z.wsize):(z.wnext+=I,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=I))),0}Xe.inflateReset=Ae,Xe.inflateReset2=xe,Xe.inflateResetKeep=ke,Xe.inflateInit=function(g){return Ee(g,15)},Xe.inflateInit2=Ee,Xe.inflate=function(g,m){var y,k,I,z,P,N,O,U,M,B,j,G,H,V,q,Z,$,W,X,J,Y,K,Q,tt,et=0,vt=new lr.Buf8(4),yt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!g||!g.state||!g.output||!g.input&&0!==g.avail_in)return-2;12===(y=g.state).mode&&(y.mode=13),P=g.next_out,I=g.output,O=g.avail_out,z=g.next_in,k=g.input,N=g.avail_in,U=y.hold,M=y.bits,B=N,j=O,K=0;t:for(;;)switch(y.mode){case 1:if(0===y.wrap){y.mode=13;break}for(;M<16;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(2&y.wrap&&35615===U){y.check=0,vt[0]=255&U,vt[1]=U>>>8&255,y.check=gr(y.check,vt,2,0),U=0,M=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&U)<<8)+(U>>8))%31){g.msg="incorrect header check",y.mode=30;break}if(8!=(15&U)){g.msg="unknown compression method",y.mode=30;break}if(M-=4,Y=8+(15&(U>>>=4)),0===y.wbits)y.wbits=Y;else if(Y>y.wbits){g.msg="invalid window size",y.mode=30;break}y.dmax=1<<Y,g.adler=y.check=1,y.mode=512&U?10:12,U=0,M=0;break;case 2:for(;M<16;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(y.flags=U,8!=(255&y.flags)){g.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){g.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=U>>8&1),512&y.flags&&(vt[0]=255&U,vt[1]=U>>>8&255,y.check=gr(y.check,vt,2,0)),U=0,M=0,y.mode=3;case 3:for(;M<32;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}y.head&&(y.head.time=U),512&y.flags&&(vt[0]=255&U,vt[1]=U>>>8&255,vt[2]=U>>>16&255,vt[3]=U>>>24&255,y.check=gr(y.check,vt,4,0)),U=0,M=0,y.mode=4;case 4:for(;M<16;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}y.head&&(y.head.xflags=255&U,y.head.os=U>>8),512&y.flags&&(vt[0]=255&U,vt[1]=U>>>8&255,y.check=gr(y.check,vt,2,0)),U=0,M=0,y.mode=5;case 5:if(1024&y.flags){for(;M<16;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}y.length=U,y.head&&(y.head.extra_len=U),512&y.flags&&(vt[0]=255&U,vt[1]=U>>>8&255,y.check=gr(y.check,vt,2,0)),U=0,M=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&((G=y.length)>N&&(G=N),G&&(y.head&&(Y=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),lr.arraySet(y.head.extra,k,z,G,Y)),512&y.flags&&(y.check=gr(y.check,k,G,z)),N-=G,z+=G,y.length-=G),y.length))break t;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(0===N)break t;G=0;do{Y=k[z+G++],y.head&&Y&&y.length<65536&&(y.head.name+=String.fromCharCode(Y))}while(Y&&G<N);if(512&y.flags&&(y.check=gr(y.check,k,G,z)),N-=G,z+=G,Y)break t}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(0===N)break t;G=0;do{Y=k[z+G++],y.head&&Y&&y.length<65536&&(y.head.comment+=String.fromCharCode(Y))}while(Y&&G<N);if(512&y.flags&&(y.check=gr(y.check,k,G,z)),N-=G,z+=G,Y)break t}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;M<16;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(U!==(65535&y.check)){g.msg="header crc mismatch",y.mode=30;break}U=0,M=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),g.adler=y.check=0,y.mode=12;break;case 10:for(;M<32;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}g.adler=y.check=me(U),U=0,M=0,y.mode=11;case 11:if(0===y.havedict)return g.next_out=P,g.avail_out=O,g.next_in=z,g.avail_in=N,y.hold=U,y.bits=M,2;g.adler=y.check=1,y.mode=12;case 12:if(5===m||6===m)break t;case 13:if(y.last){U>>>=7&M,M-=7&M,y.mode=27;break}for(;M<3;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}switch(y.last=1&U,M-=1,3&(U>>>=1)){case 0:y.mode=14;break;case 1:if(Be(y),y.mode=20,6===m){U>>>=2,M-=2;break t}break;case 2:y.mode=17;break;case 3:g.msg="invalid block type",y.mode=30}U>>>=2,M-=2;break;case 14:for(U>>>=7&M,M-=7&M;M<32;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if((65535&U)!=(U>>>16^65535)){g.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&U,U=0,M=0,y.mode=15,6===m)break t;case 15:y.mode=16;case 16:if(G=y.length){if(G>N&&(G=N),G>O&&(G=O),0===G)break t;lr.arraySet(I,k,z,G,P),N-=G,z+=G,O-=G,P+=G,y.length-=G;break}y.mode=12;break;case 17:for(;M<14;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(y.nlen=257+(31&U),U>>>=5,M-=5,y.ndist=1+(31&U),U>>>=5,M-=5,y.ncode=4+(15&U),U>>>=4,M-=4,y.nlen>286||y.ndist>30){g.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;M<3;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}y.lens[yt[y.have++]]=7&U,U>>>=3,M-=3}for(;y.have<19;)y.lens[yt[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,Q={bits:y.lenbits},K=be(0,y.lens,0,19,y.lencode,0,y.work,Q),y.lenbits=Q.bits,K){g.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;Z=(et=y.lencode[U&(1<<y.lenbits)-1])>>>16&255,$=65535&et,!((q=et>>>24)<=M);){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if($<16)U>>>=q,M-=q,y.lens[y.have++]=$;else{if(16===$){for(tt=q+2;M<tt;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(U>>>=q,M-=q,0===y.have){g.msg="invalid bit length repeat",y.mode=30;break}Y=y.lens[y.have-1],G=3+(3&U),U>>>=2,M-=2}else if(17===$){for(tt=q+3;M<tt;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}M-=q,Y=0,G=3+(7&(U>>>=q)),U>>>=3,M-=3}else{for(tt=q+7;M<tt;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}M-=q,Y=0,G=11+(127&(U>>>=q)),U>>>=7,M-=7}if(y.have+G>y.nlen+y.ndist){g.msg="invalid bit length repeat",y.mode=30;break}for(;G--;)y.lens[y.have++]=Y}}if(30===y.mode)break;if(0===y.lens[256]){g.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,Q={bits:y.lenbits},K=be(1,y.lens,0,y.nlen,y.lencode,0,y.work,Q),y.lenbits=Q.bits,K){g.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,Q={bits:y.distbits},K=be(2,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,Q),y.distbits=Q.bits,K){g.msg="invalid distances set",y.mode=30;break}if(y.mode=20,6===m)break t;case 20:y.mode=21;case 21:if(N>=6&&O>=258){g.next_out=P,g.avail_out=O,g.next_in=z,g.avail_in=N,y.hold=U,y.bits=M,ve(g,j),P=g.next_out,I=g.output,O=g.avail_out,z=g.next_in,k=g.input,N=g.avail_in,U=y.hold,M=y.bits,12===y.mode&&(y.back=-1);break}for(y.back=0;Z=(et=y.lencode[U&(1<<y.lenbits)-1])>>>16&255,$=65535&et,!((q=et>>>24)<=M);){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(Z&&0==(240&Z)){for(W=q,X=Z,J=$;Z=(et=y.lencode[J+((U&(1<<W+X)-1)>>W)])>>>16&255,$=65535&et,!(W+(q=et>>>24)<=M);){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}U>>>=W,M-=W,y.back+=W}if(U>>>=q,M-=q,y.back+=q,y.length=$,0===Z){y.mode=26;break}if(32&Z){y.back=-1,y.mode=12;break}if(64&Z){g.msg="invalid literal/length code",y.mode=30;break}y.extra=15&Z,y.mode=22;case 22:if(y.extra){for(tt=y.extra;M<tt;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}y.length+=U&(1<<y.extra)-1,U>>>=y.extra,M-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;Z=(et=y.distcode[U&(1<<y.distbits)-1])>>>16&255,$=65535&et,!((q=et>>>24)<=M);){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(0==(240&Z)){for(W=q,X=Z,J=$;Z=(et=y.distcode[J+((U&(1<<W+X)-1)>>W)])>>>16&255,$=65535&et,!(W+(q=et>>>24)<=M);){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}U>>>=W,M-=W,y.back+=W}if(U>>>=q,M-=q,y.back+=q,64&Z){g.msg="invalid distance code",y.mode=30;break}y.offset=$,y.extra=15&Z,y.mode=24;case 24:if(y.extra){for(tt=y.extra;M<tt;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}y.offset+=U&(1<<y.extra)-1,U>>>=y.extra,M-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){g.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(0===O)break t;if(G=j-O,y.offset>G){if((G=y.offset-G)>y.whave&&y.sane){g.msg="invalid distance too far back",y.mode=30;break}G>y.wnext?(G-=y.wnext,H=y.wsize-G):H=y.wnext-G,G>y.length&&(G=y.length),V=y.window}else V=I,H=P-y.offset,G=y.length;G>O&&(G=O),O-=G,y.length-=G;do{I[P++]=V[H++]}while(--G);0===y.length&&(y.mode=21);break;case 26:if(0===O)break t;I[P++]=y.length,O--,y.mode=21;break;case 27:if(y.wrap){for(;M<32;){if(0===N)break t;N--,U|=k[z++]<<M,M+=8}if(j-=O,g.total_out+=j,y.total+=j,j&&(g.adler=y.check=y.flags?gr(y.check,I,j,P-j):fr(y.check,I,j,P-j)),j=O,(y.flags?U:me(U))!==y.check){g.msg="incorrect data check",y.mode=30;break}U=0,M=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;M<32;){if(0===N)break t;N--,U+=k[z++]<<M,M+=8}if(U!==(4294967295&y.total)){g.msg="incorrect length check",y.mode=30;break}U=0,M=0}y.mode=29;case 29:K=1;break t;case 30:K=-3;break t;case 31:return-4;default:return-2}return g.next_out=P,g.avail_out=O,g.next_in=z,g.avail_in=N,y.hold=U,y.bits=M,(y.wsize||j!==g.avail_out&&y.mode<30&&(y.mode<27||4!==m))&&Pe(g,g.output,g.next_out,j-g.avail_out),B-=g.avail_in,j-=g.avail_out,g.total_in+=B,g.total_out+=j,y.total+=j,y.wrap&&j&&(g.adler=y.check=y.flags?gr(y.check,I,j,g.next_out-j):fr(y.check,I,j,g.next_out-j)),g.data_type=y.bits+(y.last?64:0)+(12===y.mode?128:0)+(20===y.mode||15===y.mode?256:0),(0===B&&0===j||4===m)&&0===K&&(K=-5),K},Xe.inflateEnd=function(g){if(!g||!g.state)return-2;var m=g.state;return m.window&&(m.window=null),g.state=null,0},Xe.inflateGetHeader=function(g,m){var y;return g&&g.state?0==(2&(y=g.state).wrap)?-2:(y.head=m,m.done=!1,0):-2},Xe.inflateSetDictionary=function(g,m){var y,k=m.length;return g&&g.state?0!==(y=g.state).wrap&&11!==y.mode?-2:11===y.mode&&fr(1,m,k,0)!==y.check?-3:Pe(g,m,k,k)?(y.mode=31,-4):(y.havedict=1,0):-2},Xe.inflateInfo="pako inflate (from Nodeca project)";var wr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},yr=Xe,xr=Bt,kr=Ne,Ar=wr,Er=we,Tr=Qt,He=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Ir=Object.prototype.toString;function Ge(g){if(!(this instanceof Ge))return new Ge(g);this.options=xr.assign({chunkSize:16384,windowBits:0,to:""},g||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,0===m.windowBits&&(m.windowBits=-15)),!(m.windowBits>=0&&m.windowBits<16)||g&&g.windowBits||(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&0==(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Tr,this.strm.avail_out=0;var y=yr.inflateInit2(this.strm,m.windowBits);if(y!==Ar.Z_OK)throw new Error(Er[y]);if(this.header=new He,yr.inflateGetHeader(this.strm,this.header),m.dictionary&&("string"==typeof m.dictionary?m.dictionary=kr.string2buf(m.dictionary):"[object ArrayBuffer]"===Ir.call(m.dictionary)&&(m.dictionary=new Uint8Array(m.dictionary)),m.raw&&(y=yr.inflateSetDictionary(this.strm,m.dictionary))!==Ar.Z_OK))throw new Error(Er[y])}function Oe(g,m){var y=new Ge(m);if(y.push(g,!0),y.err)throw y.msg||Er[y.err];return y.result}Ge.prototype.push=function(g,m){var y,k,I,z,P,N=this.strm,O=this.options.chunkSize,U=this.options.dictionary,M=!1;if(this.ended)return!1;k=m===~~m?m:!0===m?Ar.Z_FINISH:Ar.Z_NO_FLUSH,"string"==typeof g?N.input=kr.binstring2buf(g):"[object ArrayBuffer]"===Ir.call(g)?N.input=new Uint8Array(g):N.input=g,N.next_in=0,N.avail_in=N.input.length;do{if(0===N.avail_out&&(N.output=new xr.Buf8(O),N.next_out=0,N.avail_out=O),(y=yr.inflate(N,Ar.Z_NO_FLUSH))===Ar.Z_NEED_DICT&&U&&(y=yr.inflateSetDictionary(this.strm,U)),y===Ar.Z_BUF_ERROR&&!0===M&&(y=Ar.Z_OK,M=!1),y!==Ar.Z_STREAM_END&&y!==Ar.Z_OK)return this.onEnd(y),this.ended=!0,!1;N.next_out&&(0!==N.avail_out&&y!==Ar.Z_STREAM_END&&(0!==N.avail_in||k!==Ar.Z_FINISH&&k!==Ar.Z_SYNC_FLUSH)||("string"===this.options.to?(I=kr.utf8border(N.output,N.next_out),z=N.next_out-I,P=kr.buf2string(N.output,I),N.next_out=z,N.avail_out=O-z,z&&xr.arraySet(N.output,N.output,I,z,0),this.onData(P)):this.onData(xr.shrinkBuf(N.output,N.next_out)))),0===N.avail_in&&0===N.avail_out&&(M=!0)}while((N.avail_in>0||0===N.avail_out)&&y!==Ar.Z_STREAM_END);return y===Ar.Z_STREAM_END&&(k=Ar.Z_FINISH),k===Ar.Z_FINISH?(y=yr.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===Ar.Z_OK):k!==Ar.Z_SYNC_FLUSH||(this.onEnd(Ar.Z_OK),N.avail_out=0,!0)},Ge.prototype.onData=function(g){this.chunks.push(g)},Ge.prototype.onEnd=function(g){g===Ar.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=xr.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},We.Inflate=Ge,We.inflate=Oe,We.inflateRaw=function(g,m){return(m=m||{}).raw=!0,Oe(g,m)},We.ungzip=Oe;var Cr={};(0,Bt.assign)(Cr,jt,We,wr);var Sr,zr,Pr,Nr=Cr,Or={toRGBA8:function(g){var m=g.width,y=g.height;if(null==g.tabs.acTL)return[Or.toRGBA8.decodeImage(g.data,m,y,g).buffer];var k=[];null==g.frames[0].data&&(g.frames[0].data=g.data);for(var I=m*y*4,z=new Uint8Array(I),P=new Uint8Array(I),N=new Uint8Array(I),O=0;O<g.frames.length;O++){var U=g.frames[O],M=U.rect.x,B=U.rect.y,j=U.rect.width,G=U.rect.height,H=Or.toRGBA8.decodeImage(U.data,j,G,g);if(0!=O)for(var V=0;V<I;V++)N[V]=z[V];if(0==U.blend?Or._copyTile(H,j,G,z,m,y,M,B,0):1==U.blend&&Or._copyTile(H,j,G,z,m,y,M,B,1),k.push(z.buffer.slice(0)),0==U.dispose);else if(1==U.dispose)Or._copyTile(P,j,G,z,m,y,M,B,0);else if(2==U.dispose)for(V=0;V<I;V++)z[V]=N[V]}return k}};Or.toRGBA8.decodeImage=function(g,m,y,k){var I=m*y,z=Or.decode._getBPP(k),P=Math.ceil(m*z/8),N=new Uint8Array(4*I),O=new Uint32Array(N.buffer),U=k.ctype,M=k.depth,B=Or._bin.readUshort;if(6==U){var j=I<<2;if(8==M)for(var G=0;G<j;G+=4)N[G]=g[G],N[G+1]=g[G+1],N[G+2]=g[G+2],N[G+3]=g[G+3];if(16==M)for(G=0;G<j;G++)N[G]=g[G<<1]}else if(2==U){var H=k.tabs.tRNS;if(null==H){if(8==M)for(G=0;G<I;G++){var V=3*G;O[G]=255<<24|g[V+2]<<16|g[V+1]<<8|g[V]}if(16==M)for(G=0;G<I;G++)V=6*G,O[G]=255<<24|g[V+4]<<16|g[V+2]<<8|g[V]}else{var q=H[0],Z=H[1],$=H[2];if(8==M)for(G=0;G<I;G++){var W=G<<2;V=3*G,O[G]=255<<24|g[V+2]<<16|g[V+1]<<8|g[V],g[V]==q&&g[V+1]==Z&&g[V+2]==$&&(N[W+3]=0)}if(16==M)for(G=0;G<I;G++)W=G<<2,V=6*G,O[G]=255<<24|g[V+4]<<16|g[V+2]<<8|g[V],B(g,V)==q&&B(g,V+2)==Z&&B(g,V+4)==$&&(N[W+3]=0)}}else if(3==U){var X=k.tabs.PLTE,J=k.tabs.tRNS,Y=J?J.length:0;if(1==M)for(var K=0;K<y;K++){var Q=K*P,tt=K*m;for(G=0;G<m;G++){W=tt+G<<2;var et=3*(vt=g[Q+(G>>3)]>>7-((7&G)<<0)&1);N[W]=X[et],N[W+1]=X[et+1],N[W+2]=X[et+2],N[W+3]=vt<Y?J[vt]:255}}if(2==M)for(K=0;K<y;K++)for(Q=K*P,tt=K*m,G=0;G<m;G++)W=tt+G<<2,et=3*(vt=g[Q+(G>>2)]>>6-((3&G)<<1)&3),N[W]=X[et],N[W+1]=X[et+1],N[W+2]=X[et+2],N[W+3]=vt<Y?J[vt]:255;if(4==M)for(K=0;K<y;K++)for(Q=K*P,tt=K*m,G=0;G<m;G++)W=tt+G<<2,et=3*(vt=g[Q+(G>>1)]>>4-((1&G)<<2)&15),N[W]=X[et],N[W+1]=X[et+1],N[W+2]=X[et+2],N[W+3]=vt<Y?J[vt]:255;if(8==M)for(G=0;G<I;G++){var vt;W=G<<2,et=3*(vt=g[G]),N[W]=X[et],N[W+1]=X[et+1],N[W+2]=X[et+2],N[W+3]=vt<Y?J[vt]:255}}else if(4==U){if(8==M)for(G=0;G<I;G++){W=G<<2;var yt=g[xt=G<<1];N[W]=yt,N[W+1]=yt,N[W+2]=yt,N[W+3]=g[xt+1]}if(16==M)for(G=0;G<I;G++){var xt;W=G<<2,yt=g[xt=G<<2],N[W]=yt,N[W+1]=yt,N[W+2]=yt,N[W+3]=g[xt+2]}}else if(0==U)for(q=k.tabs.tRNS?k.tabs.tRNS:-1,K=0;K<y;K++){var kt=K*P,Et=K*m;if(1==M)for(var It=0;It<m;It++){var zt=(yt=255*(g[kt+(It>>>3)]>>>7-(7&It)&1))==255*q?0:255;O[Et+It]=zt<<24|yt<<16|yt<<8|yt}else if(2==M)for(It=0;It<m;It++)zt=(yt=85*(g[kt+(It>>>2)]>>>6-((3&It)<<1)&3))==85*q?0:255,O[Et+It]=zt<<24|yt<<16|yt<<8|yt;else if(4==M)for(It=0;It<m;It++)zt=(yt=17*(g[kt+(It>>>1)]>>>4-((1&It)<<2)&15))==17*q?0:255,O[Et+It]=zt<<24|yt<<16|yt<<8|yt;else if(8==M)for(It=0;It<m;It++)zt=(yt=g[kt+It])==q?0:255,O[Et+It]=zt<<24|yt<<16|yt<<8|yt;else if(16==M)for(It=0;It<m;It++)yt=g[kt+(It<<1)],zt=B(g,kt+(It<<G))==q?0:255,O[Et+It]=zt<<24|yt<<16|yt<<8|yt}return N},Or.decode=function(g){for(var m,y=new Uint8Array(g),k=8,I=Or._bin,z=I.readUshort,P=I.readUint,N={tabs:{},frames:[]},O=new Uint8Array(y.length),U=0,M=0,B=[137,80,78,71,13,10,26,10],j=0;j<8;j++)if(y[j]!=B[j])throw"The input is not a PNG file!";for(;k<y.length;){var G=I.readUint(y,k);k+=4;var H=I.readASCII(y,k,4);if(k+=4,"IHDR"==H)Or.decode._IHDR(y,k,N);else if("IDAT"==H){for(j=0;j<G;j++)O[U+j]=y[k+j];U+=G}else if("acTL"==H)N.tabs[H]={num_frames:P(y,k),num_plays:P(y,k+4)},m=new Uint8Array(y.length);else if("fcTL"==H){var V;0!=M&&((V=N.frames[N.frames.length-1]).data=Or.decode._decompress(N,m.slice(0,M),V.rect.width,V.rect.height),M=0);var q={x:P(y,k+12),y:P(y,k+16),width:P(y,k+4),height:P(y,k+8)},Z=z(y,k+22);Z=z(y,k+20)/(0==Z?100:Z);var $={rect:q,delay:Math.round(1e3*Z),dispose:y[k+24],blend:y[k+25]};N.frames.push($)}else if("fdAT"==H){for(j=0;j<G-4;j++)m[M+j]=y[k+j+4];M+=G-4}else if("pHYs"==H)N.tabs[H]=[I.readUint(y,k),I.readUint(y,k+4),y[k+8]];else if("cHRM"==H)for(N.tabs[H]=[],j=0;j<8;j++)N.tabs[H].push(I.readUint(y,k+4*j));else if("tEXt"==H){null==N.tabs[H]&&(N.tabs[H]={});var W=I.nextZero(y,k),X=I.readASCII(y,k,W-k),J=I.readASCII(y,W+1,k+G-W-1);N.tabs[H][X]=J}else if("iTXt"==H){null==N.tabs[H]&&(N.tabs[H]={}),W=0;var Y=k;W=I.nextZero(y,Y),X=I.readASCII(y,Y,W-Y),y[Y=W+1],y[Y+1],Y+=2,W=I.nextZero(y,Y),I.readASCII(y,Y,W-Y),Y=W+1,W=I.nextZero(y,Y),I.readUTF8(y,Y,W-Y),Y=W+1,J=I.readUTF8(y,Y,G-(Y-k)),N.tabs[H][X]=J}else if("PLTE"==H)N.tabs[H]=I.readBytes(y,k,G);else if("hIST"==H){var K=N.tabs.PLTE.length/3;for(N.tabs[H]=[],j=0;j<K;j++)N.tabs[H].push(z(y,k+2*j))}else if("tRNS"==H)3==N.ctype?N.tabs[H]=I.readBytes(y,k,G):0==N.ctype?N.tabs[H]=z(y,k):2==N.ctype&&(N.tabs[H]=[z(y,k),z(y,k+2),z(y,k+4)]);else if("gAMA"==H)N.tabs[H]=I.readUint(y,k)/1e5;else if("sRGB"==H)N.tabs[H]=y[k];else if("bKGD"==H)0==N.ctype||4==N.ctype?N.tabs[H]=[z(y,k)]:2==N.ctype||6==N.ctype?N.tabs[H]=[z(y,k),z(y,k+2),z(y,k+4)]:3==N.ctype&&(N.tabs[H]=y[k]);else if("IEND"==H)break;k+=G,I.readUint(y,k),k+=4}return 0!=M&&((V=N.frames[N.frames.length-1]).data=Or.decode._decompress(N,m.slice(0,M),V.rect.width,V.rect.height),M=0),N.data=Or.decode._decompress(N,O,N.width,N.height),delete N.compress,delete N.interlace,delete N.filter,N},Or.decode._decompress=function(g,m,y,k){var I=Or.decode._getBPP(g),z=Math.ceil(y*I/8),P=new Uint8Array((z+1+g.interlace)*k);return m=Or.decode._inflate(m,P),0==g.interlace?m=Or.decode._filterZero(m,g,0,y,k):1==g.interlace&&(m=Or.decode._readInterlace(m,g)),m},Or.decode._inflate=function(g,m){return Or.inflateRaw(new Uint8Array(g.buffer,2,g.length-6),m)},Or.inflateRaw=((Pr={}).H={},Pr.H.N=function(g,m){var y,k,I=Uint8Array,z=0,P=0,N=0,O=0,U=0,M=0,B=0,j=0,G=0;if(3==g[0]&&0==g[1])return m||new I(0);var H=Pr.H,V=H.b,q=H.e,Z=H.R,$=H.n,W=H.A,X=H.Z,J=H.m,Y=null==m;for(Y&&(m=new I(g.length>>>2<<3));0==z;)if(z=V(g,G,1),P=V(g,G+1,2),G+=3,0!=P){if(Y&&(m=Pr.H.W(m,j+(1<<17))),1==P&&(y=J.J,k=J.h,M=511,B=31),2==P){N=q(g,G,5)+257,O=q(g,G+5,5)+1,U=q(g,G+10,4)+4,G+=14;for(var K=1,Q=0;Q<38;Q+=2)J.Q[Q]=0,J.Q[Q+1]=0;for(Q=0;Q<U;Q++){var tt=q(g,G+3*Q,3);J.Q[1+(J.X[Q]<<1)]=tt,tt>K&&(K=tt)}G+=3*U,$(J.Q,K),W(J.Q,K,J.u),y=J.w,k=J.d,G=Z(J.u,(1<<K)-1,N+O,g,G,J.v);var et=H.V(J.v,0,N,J.C);M=(1<<et)-1;var vt=H.V(J.v,N,O,J.D);B=(1<<vt)-1,$(J.C,et),W(J.C,et,y),$(J.D,vt),W(J.D,vt,k)}for(;;){var yt=y[X(g,G)&M];G+=15&yt;var xt=yt>>>4;if(xt>>>8==0)m[j++]=xt;else{if(256==xt)break;var kt=j+xt-254;if(xt>264){var Et=J.q[xt-257];kt=j+(Et>>>3)+q(g,G,7&Et),G+=7&Et}var It=k[X(g,G)&B];G+=15&It;var zt=It>>>4,Ut=J.c[zt],Bt=(Ut>>>4)+V(g,G,15&Ut);for(G+=15&Ut;j<kt;)m[j]=m[j++-Bt],m[j]=m[j++-Bt],m[j]=m[j++-Bt],m[j]=m[j++-Bt];j=kt}}}else{0!=(7&G)&&(G+=8-(7&G));var jt=4+(G>>>3),Wt=g[jt-4]|g[jt-3]<<8;Y&&(m=Pr.H.W(m,j+Wt)),m.set(new I(g.buffer,g.byteOffset+jt,Wt),j),G=jt+Wt<<3,j+=Wt}return m.length==j?m:m.slice(0,j)},Pr.H.W=function(g,m){var y=g.length;if(m<=y)return g;var k=new Uint8Array(y<<1);return k.set(g,0),k},Pr.H.R=function(g,m,y,k,I,z){for(var P=Pr.H.e,N=Pr.H.Z,O=0;O<y;){var U=g[N(k,I)&m];I+=15&U;var M=U>>>4;if(M<=15)z[O]=M,O++;else{var B=0,j=0;16==M?(j=3+P(k,I,2),I+=2,B=z[O-1]):17==M?(j=3+P(k,I,3),I+=3):18==M&&(j=11+P(k,I,7),I+=7);for(var G=O+j;O<G;)z[O]=B,O++}}return I},Pr.H.V=function(g,m,y,k){for(var I=0,z=0,P=k.length>>>1;z<y;){var N=g[z+m];k[z<<1]=0,k[1+(z<<1)]=N,N>I&&(I=N),z++}for(;z<P;)k[z<<1]=0,k[1+(z<<1)]=0,z++;return I},Pr.H.n=function(g,m){for(var y,k,I,z,P=Pr.H.m,N=g.length,O=P.j,U=0;U<=m;U++)O[U]=0;for(U=1;U<N;U+=2)O[g[U]]++;var M=P.K;for(y=0,O[0]=0,k=1;k<=m;k++)y=y+O[k-1]<<1,M[k]=y;for(I=0;I<N;I+=2)0!=(z=g[I+1])&&(g[I]=M[z],M[z]++)},Pr.H.A=function(g,m,y){for(var k=g.length,I=Pr.H.m.r,z=0;z<k;z+=2)if(0!=g[z+1])for(var P=z>>1,N=g[z+1],O=P<<4|N,U=m-N,M=g[z]<<U,B=M+(1<<U);M!=B;)y[I[M]>>>15-m]=O,M++},Pr.H.l=function(g,m){for(var y=Pr.H.m.r,k=15-m,I=0;I<g.length;I+=2){var z=g[I]<<m-g[I+1];g[I]=y[z]>>>k}},Pr.H.M=function(g,m,y){y<<=7&m;var k=m>>>3;g[k]|=y,g[k+1]|=y>>>8},Pr.H.I=function(g,m,y){y<<=7&m;var k=m>>>3;g[k]|=y,g[k+1]|=y>>>8,g[k+2]|=y>>>16},Pr.H.e=function(g,m,y){return(g[m>>>3]|g[1+(m>>>3)]<<8)>>>(7&m)&(1<<y)-1},Pr.H.b=function(g,m,y){return(g[m>>>3]|g[1+(m>>>3)]<<8|g[2+(m>>>3)]<<16)>>>(7&m)&(1<<y)-1},Pr.H.Z=function(g,m){return(g[m>>>3]|g[1+(m>>>3)]<<8|g[2+(m>>>3)]<<16)>>>(7&m)},Pr.H.i=function(g,m){return(g[m>>>3]|g[1+(m>>>3)]<<8|g[2+(m>>>3)]<<16|g[3+(m>>>3)]<<24)>>>(7&m)},Pr.H.m=(Sr=Uint16Array,zr=Uint32Array,{K:new Sr(16),j:new Sr(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new Sr(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new zr(32),J:new Sr(512),_:[],h:new Sr(32),$:[],w:new Sr(32768),C:[],v:[],d:new Sr(32768),D:[],u:new Sr(512),Q:[],r:new Sr(32768),s:new zr(286),Y:new zr(30),a:new zr(19),t:new zr(15e3),k:new Sr(65536),g:new Sr(32768)}),function(){for(var g=Pr.H.m,m=0;m<32768;m++){var y=m;y=(4278255360&(y=(4042322160&(y=(3435973836&(y=(2863311530&y)>>>1|(1431655765&y)<<1))>>>2|(858993459&y)<<2))>>>4|(252645135&y)<<4))>>>8|(16711935&y)<<8,g.r[m]=(y>>>16|y<<16)>>>17}function i(g,m,y){for(;0!=m--;)g.push(0,y)}for(m=0;m<32;m++)g.q[m]=g.S[m]<<3|g.T[m],g.c[m]=g.p[m]<<4|g.z[m];i(g._,144,8),i(g._,112,9),i(g._,24,7),i(g._,8,8),Pr.H.n(g._,9),Pr.H.A(g._,9,g.J),Pr.H.l(g._,9),i(g.$,32,5),Pr.H.n(g.$,5),Pr.H.A(g.$,5,g.h),Pr.H.l(g.$,5),i(g.Q,19,0),i(g.C,286,0),i(g.D,30,0),i(g.v,320,0)}(),Pr.H.N),Or.decode._readInterlace=function(g,m){for(var y=m.width,k=m.height,I=Or.decode._getBPP(m),z=I>>3,P=Math.ceil(y*I/8),N=new Uint8Array(k*P),O=0,U=[0,0,4,0,2,0,1],M=[0,4,0,2,0,1,0],B=[8,8,8,4,4,2,2],j=[8,8,4,4,2,2,1],G=0;G<7;){for(var H=B[G],V=j[G],q=0,Z=0,$=U[G];$<k;)$+=H,Z++;for(var W=M[G];W<y;)W+=V,q++;var X=Math.ceil(q*I/8);Or.decode._filterZero(g,m,O,q,Z);for(var J=0,Y=U[G];Y<k;){for(var K=M[G],Q=O+J*X<<3;K<y;){var tt;if(1==I&&(tt=(tt=g[Q>>3])>>7-(7&Q)&1,N[Y*P+(K>>3)]|=tt<<7-((7&K)<<0)),2==I&&(tt=(tt=g[Q>>3])>>6-(7&Q)&3,N[Y*P+(K>>2)]|=tt<<6-((3&K)<<1)),4==I&&(tt=(tt=g[Q>>3])>>4-(7&Q)&15,N[Y*P+(K>>1)]|=tt<<4-((1&K)<<2)),I>=8)for(var et=Y*P+K*z,vt=0;vt<z;vt++)N[et+vt]=g[(Q>>3)+vt];Q+=I,K+=V}J++,Y+=H}q*Z!=0&&(O+=Z*(1+X)),G+=1}return N},Or.decode._getBPP=function(g){return[1,null,3,1,2,null,4][g.ctype]*g.depth},Or.decode._filterZero=function(g,m,y,k,I){var z=Or.decode._getBPP(m),P=Math.ceil(k*z/8),N=Or.decode._paeth;z=Math.ceil(z/8);var O=0,U=1,M=g[y],B=0;if(M>1&&(g[y]=[0,0,1][M-2]),3==M)for(B=z;B<P;B++)g[B+1]=g[B+1]+(g[B+1-z]>>>1)&255;for(var j=0;j<I;j++)if(B=0,0==(M=g[(U=(O=y+j*P)+j+1)-1]))for(;B<P;B++)g[O+B]=g[U+B];else if(1==M){for(;B<z;B++)g[O+B]=g[U+B];for(;B<P;B++)g[O+B]=g[U+B]+g[O+B-z]}else if(2==M)for(;B<P;B++)g[O+B]=g[U+B]+g[O+B-P];else if(3==M){for(;B<z;B++)g[O+B]=g[U+B]+(g[O+B-P]>>>1);for(;B<P;B++)g[O+B]=g[U+B]+(g[O+B-P]+g[O+B-z]>>>1)}else{for(;B<z;B++)g[O+B]=g[U+B]+N(0,g[O+B-P],0);for(;B<P;B++)g[O+B]=g[U+B]+N(g[O+B-z],g[O+B-P],g[O+B-z-P])}return g},Or.decode._paeth=function(g,m,y){var k=g+m-y,I=k-g,z=k-m,P=k-y;return I*I<=z*z&&I*I<=P*P?g:z*z<=P*P?m:y},Or.decode._IHDR=function(g,m,y){var k=Or._bin;y.width=k.readUint(g,m),m+=4,y.height=k.readUint(g,m),m+=4,y.depth=g[m],m++,y.ctype=g[m],m++,y.compress=g[m],m++,y.filter=g[m],m++,y.interlace=g[m],m++},Or._bin={nextZero:function(g,m){for(;0!=g[m];)m++;return m},readUshort:function(g,m){return g[m]<<8|g[m+1]},writeUshort:function(g,m,y){g[m]=y>>8&255,g[m+1]=255&y},readUint:function(g,m){return 16777216*g[m]+(g[m+1]<<16|g[m+2]<<8|g[m+3])},writeUint:function(g,m,y){g[m]=y>>24&255,g[m+1]=y>>16&255,g[m+2]=y>>8&255,g[m+3]=255&y},readASCII:function(g,m,y){for(var k="",I=0;I<y;I++)k+=String.fromCharCode(g[m+I]);return k},writeASCII:function(g,m,y){for(var k=0;k<y.length;k++)g[m+k]=y.charCodeAt(k)},readBytes:function(g,m,y){for(var k=[],I=0;I<y;I++)k.push(g[m+I]);return k},pad:function(g){return g.length<2?"0"+g:g},readUTF8:function(g,m,y){for(var k,I="",z=0;z<y;z++)I+="%"+Or._bin.pad(g[m+z].toString(16));try{k=decodeURIComponent(I)}catch(k){return Or._bin.readASCII(g,m,y)}return k}},Or._copyTile=function(g,m,y,k,I,z,P,N,O){for(var U=Math.min(m,I),M=Math.min(y,z),B=0,j=0,G=0;G<M;G++)for(var H=0;H<U;H++)if(P>=0&&N>=0?(B=G*m+H<<2,j=(N+G)*I+P+H<<2):(B=(-N+G)*m-P+H<<2,j=G*I+H<<2),0==O)k[j]=g[B],k[j+1]=g[B+1],k[j+2]=g[B+2],k[j+3]=g[B+3];else if(1==O){var V=g[B+3]*(1/255),q=g[B]*V,Z=g[B+1]*V,$=g[B+2]*V,W=k[j+3]*(1/255),X=k[j]*W,J=k[j+1]*W,Y=k[j+2]*W,K=1-V,Q=V+W*K,tt=0==Q?0:1/Q;k[j+3]=255*Q,k[j+0]=(q+X*K)*tt,k[j+1]=(Z+J*K)*tt,k[j+2]=($+Y*K)*tt}else if(2==O)V=g[B+3],q=g[B],Z=g[B+1],$=g[B+2],W=k[j+3],X=k[j],J=k[j+1],Y=k[j+2],V==W&&q==X&&Z==J&&$==Y?(k[j]=0,k[j+1]=0,k[j+2]=0,k[j+3]=0):(k[j]=q,k[j+1]=Z,k[j+2]=$,k[j+3]=V);else if(3==O){if(V=g[B+3],q=g[B],Z=g[B+1],$=g[B+2],W=k[j+3],X=k[j],J=k[j+1],Y=k[j+2],V==W&&q==X&&Z==J&&$==Y)continue;if(V<220&&W>20)return!1}return!0},Or.encode=function(g,m,y,k,I,z,P){null==k&&(k=0),null==P&&(P=!1);var N=Or.encode.compress(g,m,y,k,[!1,!1,!1,0,P]);return Or.encode.compressPNG(N,-1),Or.encode._main(N,m,y,I,z)},Or.encodeLL=function(g,m,y,k,I,z,P,N){for(var O={ctype:0+(1==k?0:2)+(0==I?0:4),depth:z,frames:[]},U=(k+I)*z,M=U*m,B=0;B<g.length;B++)O.frames.push({rect:{x:0,y:0,width:m,height:y},img:new Uint8Array(g[B]),blend:0,dispose:1,bpp:Math.ceil(U/8),bpl:Math.ceil(M/8)});return Or.encode.compressPNG(O,0,!0),Or.encode._main(O,m,y,P,N)},Or.encode._main=function(g,m,y,k,I){null==I&&(I={});var z=Or.crc.crc,P=Or._bin.writeUint,N=Or._bin.writeUshort,O=Or._bin.writeASCII,U=8,M=g.frames.length>1,B=!1,j=33+(M?20:0);if(null!=I.sRGB&&(j+=13),null!=I.pHYs&&(j+=21),3==g.ctype){for(var G=g.plte.length,H=0;H<G;H++)g.plte[H]>>>24!=255&&(B=!0);j+=8+3*G+4+(B?8+1*G+4:0)}for(var V=0;V<g.frames.length;V++)M&&(j+=38),j+=(Q=g.frames[V]).cimg.length+12,0!=V&&(j+=4);j+=12;var q=new Uint8Array(j),Z=[137,80,78,71,13,10,26,10];for(H=0;H<8;H++)q[H]=Z[H];if(P(q,U,13),O(q,U+=4,"IHDR"),P(q,U+=4,m),P(q,U+=4,y),q[U+=4]=g.depth,q[++U]=g.ctype,q[++U]=0,q[++U]=0,q[++U]=0,P(q,++U,z(q,U-17,17)),U+=4,null!=I.sRGB&&(P(q,U,1),O(q,U+=4,"sRGB"),q[U+=4]=I.sRGB,P(q,++U,z(q,U-5,5)),U+=4),null!=I.pHYs&&(P(q,U,9),O(q,U+=4,"pHYs"),P(q,U+=4,I.pHYs[0]),P(q,U+=4,I.pHYs[1]),q[U+=4]=I.pHYs[2],P(q,++U,z(q,U-13,13)),U+=4),M&&(P(q,U,8),O(q,U+=4,"acTL"),P(q,U+=4,g.frames.length),P(q,U+=4,null!=I.loop?I.loop:0),P(q,U+=4,z(q,U-12,12)),U+=4),3==g.ctype){for(P(q,U,3*(G=g.plte.length)),O(q,U+=4,"PLTE"),U+=4,H=0;H<G;H++){var $=3*H,W=g.plte[H],X=255&W,J=W>>>8&255,Y=W>>>16&255;q[U+$+0]=X,q[U+$+1]=J,q[U+$+2]=Y}if(P(q,U+=3*G,z(q,U-3*G-4,3*G+4)),U+=4,B){for(P(q,U,G),O(q,U+=4,"tRNS"),U+=4,H=0;H<G;H++)q[U+H]=g.plte[H]>>>24&255;P(q,U+=G,z(q,U-G-4,G+4)),U+=4}}var K=0;for(V=0;V<g.frames.length;V++){var Q=g.frames[V];M&&(P(q,U,26),O(q,U+=4,"fcTL"),P(q,U+=4,K++),P(q,U+=4,Q.rect.width),P(q,U+=4,Q.rect.height),P(q,U+=4,Q.rect.x),P(q,U+=4,Q.rect.y),N(q,U+=4,k[V]),N(q,U+=2,1e3),q[U+=2]=Q.dispose,q[++U]=Q.blend,P(q,++U,z(q,U-30,30)),U+=4);var tt=Q.cimg;P(q,U,(G=tt.length)+(0==V?0:4));var et=U+=4;O(q,U,0==V?"IDAT":"fdAT"),U+=4,0!=V&&(P(q,U,K++),U+=4),q.set(tt,U),P(q,U+=G,z(q,et,U-et)),U+=4}return P(q,U,0),O(q,U+=4,"IEND"),P(q,U+=4,z(q,U-4,4)),U+=4,q.buffer},Or.encode.compressPNG=function(g,m,y){for(var k=0;k<g.frames.length;k++){var I=g.frames[k];I.rect.width;var z=I.rect.height,P=new Uint8Array(z*I.bpl+z);I.cimg=Or.encode._filterZero(I.img,z,I.bpp,I.bpl,P,m,y)}},Or.encode.compress=function(g,m,y,k,I){for(var z=I[0],P=I[1],N=I[2],O=I[3],U=I[4],M=6,B=8,j=255,G=0;G<g.length;G++)for(var H=new Uint8Array(g[G]),V=H.length,q=0;q<V;q+=4)j&=H[q+3];var Z=255!=j,$=Or.encode.framize(g,m,y,z,P,N),W={},X=[],J=[];if(0!=k){var Y=[];for(q=0;q<$.length;q++)Y.push($[q].img.buffer);var K=Or.encode.concatRGBA(Y),Q=Or.quantize(K,k),tt=0,et=new Uint8Array(Q.abuf);for(q=0;q<$.length;q++){var vt=(ie=$[q].img).length;for(J.push(new Uint8Array(Q.inds.buffer,tt>>2,vt>>2)),G=0;G<vt;G+=4)ie[G]=et[tt+G],ie[G+1]=et[tt+G+1],ie[G+2]=et[tt+G+2],ie[G+3]=et[tt+G+3];tt+=vt}for(q=0;q<Q.plte.length;q++)X.push(Q.plte[q].est.rgba)}else for(G=0;G<$.length;G++){var yt=$[G],xt=new Uint32Array(yt.img.buffer),kt=yt.rect.width,Et=(V=xt.length,new Uint8Array(V));for(J.push(Et),q=0;q<V;q++){var It=xt[q];if(0!=q&&It==xt[q-1])Et[q]=Et[q-1];else if(q>kt&&It==xt[q-kt])Et[q]=Et[q-kt];else{var zt=W[It];if(null==zt&&(W[It]=zt=X.length,X.push(It),X.length>=300))break;Et[q]=zt}}}var Ut=X.length;for(Ut<=256&&0==U&&(B=Ut<=2?1:Ut<=4?2:Ut<=16?4:8,B=Math.max(B,O)),G=0;G<$.length;G++){(yt=$[G]).rect.x,yt.rect.y,kt=yt.rect.width;var Bt=yt.rect.height,jt=yt.img;new Uint32Array(jt.buffer);var Wt=4*kt,Xt=4;if(Ut<=256&&0==U){Wt=Math.ceil(B*kt/8);for(var Jt=new Uint8Array(Wt*Bt),Yt=J[G],Kt=0;Kt<Bt;Kt++){q=Kt*Wt;var te=Kt*kt;if(8==B)for(var ee=0;ee<kt;ee++)Jt[q+ee]=Yt[te+ee];else if(4==B)for(ee=0;ee<kt;ee++)Jt[q+(ee>>1)]|=Yt[te+ee]<<4-4*(1&ee);else if(2==B)for(ee=0;ee<kt;ee++)Jt[q+(ee>>2)]|=Yt[te+ee]<<6-2*(3&ee);else if(1==B)for(ee=0;ee<kt;ee++)Jt[q+(ee>>3)]|=Yt[te+ee]<<7-1*(7&ee)}jt=Jt,M=3,Xt=1}else if(0==Z&&1==$.length){Jt=new Uint8Array(kt*Bt*3);var re=kt*Bt;for(q=0;q<re;q++){var ie,ne=4*q;Jt[ie=3*q]=jt[ne],Jt[ie+1]=jt[ne+1],Jt[ie+2]=jt[ne+2]}jt=Jt,M=2,Xt=3,Wt=3*kt}yt.img=jt,yt.bpl=Wt,yt.bpp=Xt}return{ctype:M,depth:B,plte:X,frames:$}},Or.encode.framize=function(g,m,y,k,I,z){for(var P=[],N=0;N<g.length;N++){var O,U=new Uint8Array(g[N]),M=new Uint32Array(U.buffer),B=0,j=0,G=m,H=y,V=k?1:0;if(0!=N){for(var q=z||k||1==N||0!=P[N-2].dispose?1:2,Z=0,$=1e9,W=0;W<q;W++){for(var X=new Uint8Array(g[N-1-W]),J=new Uint32Array(g[N-1-W]),Y=m,K=y,Q=-1,tt=-1,et=0;et<y;et++)for(var vt=0;vt<m;vt++)M[Ut=et*m+vt]!=J[Ut]&&(vt<Y&&(Y=vt),vt>Q&&(Q=vt),et<K&&(K=et),et>tt&&(tt=et));-1==Q&&(Y=K=Q=tt=0),I&&(1==(1&Y)&&Y--,1==(1&K)&&K--);var yt=(Q-Y+1)*(tt-K+1);yt<$&&($=yt,Z=W,B=Y,j=K,G=Q-Y+1,H=tt-K+1)}X=new Uint8Array(g[N-1-Z]),1==Z&&(P[N-1].dispose=2),O=new Uint8Array(G*H*4),Or._copyTile(X,m,y,O,G,H,-B,-j,0),1==(V=Or._copyTile(U,m,y,O,G,H,-B,-j,3)?1:0)?Or.encode._prepareDiff(U,m,y,O,{x:B,y:j,width:G,height:H}):Or._copyTile(U,m,y,O,G,H,-B,-j,0)}else O=U.slice(0);P.push({rect:{x:B,y:j,width:G,height:H},img:O,blend:V,dispose:0})}if(k)for(N=0;N<P.length;N++)if(1!=(Bt=P[N]).blend){var xt=Bt.rect,kt=P[N-1].rect,Et=Math.min(xt.x,kt.x),It=Math.min(xt.y,kt.y),zt={x:Et,y:It,width:Math.max(xt.x+xt.width,kt.x+kt.width)-Et,height:Math.max(xt.y+xt.height,kt.y+kt.height)-It};P[N-1].dispose=1,N-1!=0&&Or.encode._updateFrame(g,m,y,P,N-1,zt,I),Or.encode._updateFrame(g,m,y,P,N,zt,I)}if(1!=g.length)for(var Ut=0;Ut<P.length;Ut++){var Bt;(Bt=P[Ut]).rect.width,Bt.rect.height}return P},Or.encode._updateFrame=function(g,m,y,k,I,z,P){for(var N=Uint8Array,O=Uint32Array,U=new N(g[I-1]),M=new O(g[I-1]),B=I+1<g.length?new N(g[I+1]):null,j=new N(g[I]),G=new O(j.buffer),H=m,V=y,q=-1,Z=-1,$=0;$<z.height;$++)for(var W=0;W<z.width;W++){var X=z.x+W,J=z.y+$,Y=J*m+X,K=G[Y];0==K||0==k[I-1].dispose&&M[Y]==K&&(null==B||0!=B[4*Y+3])||(X<H&&(H=X),X>q&&(q=X),J<V&&(V=J),J>Z&&(Z=J))}-1==q&&(H=V=q=Z=0),P&&(1==(1&H)&&H--,1==(1&V)&&V--),z={x:H,y:V,width:q-H+1,height:Z-V+1};var Q=k[I];Q.rect=z,Q.blend=1,Q.img=new Uint8Array(z.width*z.height*4),0==k[I-1].dispose?(Or._copyTile(U,m,y,Q.img,z.width,z.height,-z.x,-z.y,0),Or.encode._prepareDiff(j,m,y,Q.img,z)):Or._copyTile(j,m,y,Q.img,z.width,z.height,-z.x,-z.y,0)},Or.encode._prepareDiff=function(g,m,y,k,I){Or._copyTile(g,m,y,k,I.width,I.height,-I.x,-I.y,2)},Or.encode._filterZero=function(g,m,y,k,I,z,P){var N,O=[],U=[0,1,2,3,4];-1!=z?U=[z]:(m*k>5e5||1==y)&&(U=[0]),P&&(N={level:0});for(var M=P&&null!=UZIP?UZIP:Nr,B=0;B<U.length;B++){for(var j=0;j<m;j++)Or.encode._filterLine(I,g,j,k,y,U[B]);O.push(M.deflate(I,N))}var G,H=1e9;for(B=0;B<O.length;B++)O[B].length<H&&(G=B,H=O[B].length);return O[G]},Or.encode._filterLine=function(g,m,y,k,I,z){var P=y*k,N=P+y,O=Or.decode._paeth;if(g[N]=z,N++,0==z)if(k<500)for(var U=0;U<k;U++)g[N+U]=m[P+U];else g.set(new Uint8Array(m.buffer,P,k),N);else if(1==z){for(U=0;U<I;U++)g[N+U]=m[P+U];for(U=I;U<k;U++)g[N+U]=m[P+U]-m[P+U-I]+256&255}else if(0==y){for(U=0;U<I;U++)g[N+U]=m[P+U];if(2==z)for(U=I;U<k;U++)g[N+U]=m[P+U];if(3==z)for(U=I;U<k;U++)g[N+U]=m[P+U]-(m[P+U-I]>>1)+256&255;if(4==z)for(U=I;U<k;U++)g[N+U]=m[P+U]-O(m[P+U-I],0,0)+256&255}else{if(2==z)for(U=0;U<k;U++)g[N+U]=m[P+U]+256-m[P+U-k]&255;if(3==z){for(U=0;U<I;U++)g[N+U]=m[P+U]+256-(m[P+U-k]>>1)&255;for(U=I;U<k;U++)g[N+U]=m[P+U]+256-(m[P+U-k]+m[P+U-I]>>1)&255}if(4==z){for(U=0;U<I;U++)g[N+U]=m[P+U]+256-O(0,m[P+U-k],0)&255;for(U=I;U<k;U++)g[N+U]=m[P+U]+256-O(m[P+U-I],m[P+U-k],m[P+U-I-k])&255}}},Or.crc={table:function(){for(var g=new Uint32Array(256),m=0;m<256;m++){for(var y=m,k=0;k<8;k++)1&y?y=3988292384^y>>>1:y>>>=1;g[m]=y}return g}(),update:function(g,m,y,k){for(var I=0;I<k;I++)g=Or.crc.table[255&(g^m[y+I])]^g>>>8;return g},crc:function(g,m,y){return 4294967295^Or.crc.update(4294967295,g,m,y)}},Or.quantize=function(g,m){var y=new Uint8Array(g),k=y.slice(0),I=new Uint32Array(k.buffer),z=Or.quantize.getKDtree(k,m),P=z[0],N=z[1];Or.quantize.planeDst;for(var O=y,U=I,M=O.length,B=new Uint8Array(y.length>>2),j=0;j<M;j+=4){var G=O[j]*(1/255),H=O[j+1]*(1/255),V=O[j+2]*(1/255),q=O[j+3]*(1/255),Z=Or.quantize.getNearest(P,G,H,V,q);B[j>>2]=Z.ind,U[j>>2]=Z.est.rgba}return{abuf:k.buffer,inds:B,plte:N}},Or.quantize.getKDtree=function(g,m,y){null==y&&(y=1e-4);var k=new Uint32Array(g.buffer),I={i0:0,i1:g.length,bst:null,est:null,tdst:0,left:null,right:null};I.bst=Or.quantize.stats(g,I.i0,I.i1),I.est=Or.quantize.estats(I.bst);for(var z=[I];z.length<m;){for(var P=0,N=0,O=0;O<z.length;O++)z[O].est.L>P&&(P=z[O].est.L,N=O);if(P<y)break;var U=z[N],M=Or.quantize.splitPixels(g,k,U.i0,U.i1,U.est.e,U.est.eMq255);if(U.i0>=M||U.i1<=M)U.est.L=0;else{var B={i0:U.i0,i1:M,bst:null,est:null,tdst:0,left:null,right:null};B.bst=Or.quantize.stats(g,B.i0,B.i1),B.est=Or.quantize.estats(B.bst);var j={i0:M,i1:U.i1,bst:null,est:null,tdst:0,left:null,right:null};for(j.bst={R:[],m:[],N:U.bst.N-B.bst.N},O=0;O<16;O++)j.bst.R[O]=U.bst.R[O]-B.bst.R[O];for(O=0;O<4;O++)j.bst.m[O]=U.bst.m[O]-B.bst.m[O];j.est=Or.quantize.estats(j.bst),U.left=B,U.right=j,z[N]=B,z.push(j)}}for(z.sort((function(g,m){return m.bst.N-g.bst.N})),O=0;O<z.length;O++)z[O].ind=O;return[I,z]},Or.quantize.getNearest=function(g,m,y,k,I){if(null==g.left)return g.tdst=Or.quantize.dist(g.est.q,m,y,k,I),g;var z=Or.quantize.planeDst(g.est,m,y,k,I),P=g.left,N=g.right;z>0&&(P=g.right,N=g.left);var O=Or.quantize.getNearest(P,m,y,k,I);if(O.tdst<=z*z)return O;var U=Or.quantize.getNearest(N,m,y,k,I);return U.tdst<O.tdst?U:O},Or.quantize.planeDst=function(g,m,y,k,I){var z=g.e;return z[0]*m+z[1]*y+z[2]*k+z[3]*I-g.eMq},Or.quantize.dist=function(g,m,y,k,I){var z=m-g[0],P=y-g[1],N=k-g[2],O=I-g[3];return z*z+P*P+N*N+O*O},Or.quantize.splitPixels=function(g,m,y,k,I,z){var P=Or.quantize.vecDot;for(k-=4;y<k;){for(;P(g,y,I)<=z;)y+=4;for(;P(g,k,I)>z;)k-=4;if(y>=k)break;var N=m[y>>2];m[y>>2]=m[k>>2],m[k>>2]=N,y+=4,k-=4}for(;P(g,y,I)>z;)y-=4;return y+4},Or.quantize.vecDot=function(g,m,y){return g[m]*y[0]+g[m+1]*y[1]+g[m+2]*y[2]+g[m+3]*y[3]},Or.quantize.stats=function(g,m,y){for(var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],I=[0,0,0,0],z=y-m>>2,P=m;P<y;P+=4){var N=g[P]*(1/255),O=g[P+1]*(1/255),U=g[P+2]*(1/255),M=g[P+3]*(1/255);I[0]+=N,I[1]+=O,I[2]+=U,I[3]+=M,k[0]+=N*N,k[1]+=N*O,k[2]+=N*U,k[3]+=N*M,k[5]+=O*O,k[6]+=O*U,k[7]+=O*M,k[10]+=U*U,k[11]+=U*M,k[15]+=M*M}return k[4]=k[1],k[8]=k[2],k[9]=k[6],k[12]=k[3],k[13]=k[7],k[14]=k[11],{R:k,m:I,N:z}},Or.quantize.estats=function(g){var m=g.R,y=g.m,k=g.N,I=y[0],z=y[1],P=y[2],N=y[3],O=0==k?0:1/k,U=[m[0]-I*I*O,m[1]-I*z*O,m[2]-I*P*O,m[3]-I*N*O,m[4]-z*I*O,m[5]-z*z*O,m[6]-z*P*O,m[7]-z*N*O,m[8]-P*I*O,m[9]-P*z*O,m[10]-P*P*O,m[11]-P*N*O,m[12]-N*I*O,m[13]-N*z*O,m[14]-N*P*O,m[15]-N*N*O],M=U,B=Or.M4,j=[.5,.5,.5,.5],G=0,H=0;if(0!=k)for(var V=0;V<10&&(j=B.multVec(M,j),H=Math.sqrt(B.dot(j,j)),j=B.sml(1/H,j),!(Math.abs(H-G)<1e-9));V++)G=H;var q=[I*O,z*O,P*O,N*O];return{Cov:U,q:q,e:j,L:G,eMq255:B.dot(B.sml(255,q),j),eMq:B.dot(j,q),rgba:(Math.round(255*q[3])<<24|Math.round(255*q[2])<<16|Math.round(255*q[1])<<8|Math.round(255*q[0])<<0)>>>0}},Or.M4={multVec:function(g,m){return[g[0]*m[0]+g[1]*m[1]+g[2]*m[2]+g[3]*m[3],g[4]*m[0]+g[5]*m[1]+g[6]*m[2]+g[7]*m[3],g[8]*m[0]+g[9]*m[1]+g[10]*m[2]+g[11]*m[3],g[12]*m[0]+g[13]*m[1]+g[14]*m[2]+g[15]*m[3]]},dot:function(g,m){return g[0]*m[0]+g[1]*m[1]+g[2]*m[2]+g[3]*m[3]},sml:function(g,m){return[g*m[0],g*m[1],g*m[2],g*m[3]]}},Or.encode.concatRGBA=function(g){for(var m=0,y=0;y<g.length;y++)m+=g[y].byteLength;var k=new Uint8Array(m),I=0;for(y=0;y<g.length;y++){for(var z=new Uint8Array(g[y]),P=z.length,N=0;N<P;N+=4){var O=z[N],U=z[N+1],M=z[N+2],B=z[N+3];0==B&&(O=U=M=0),k[I+N]=O,k[I+N+1]=U,k[I+N+2]=M,k[I+N+3]=B}I+=P}return k.buffer};const Ur={decode(g){const m=Or.decode(g);return{width:m.width,height:m.height,data:new Uint8Array(Or.toRGBA8(m)[0])}},encode(g){const m=Or.encode([g.data],g.width,g.height,0);return new Uint8Array(m)}};var Mr={256:"imageWidth",257:"imageLength",258:"bitsPerSample",259:"compression",262:"photometricInterpretation",273:"stripOffsets",278:"rowsPerStrip",279:"stripByteCounts",296:"resolutionUnit",320:"colorMap"};function Ke(g){var m=0,y=void 0,k={},I=void 0;function a(m,k){var I=m,z=m+k;if(y)return g.subarray(I,z);for(var P=g.subarray(I,z),N=new Uint8Array(z-I),O=0;O<P.byteLength;O++)N[P.byteLength-O-1]=P[O];return N}function s(m){var k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,I=arguments[2];if(y){var z=new DataView(g.buffer);if(k>1||I){for(var P=new Uint16Array(k),N=0;N<k;N++)P[N]=z.getUint16(m+(N<<1));return P}return z.getUint16(m)}var O=new DataView(a(m,k<<1).buffer);if(k>1||I){for(var U=new Uint16Array(k),M=0;M<k;M++)U[M]=O.getUint16(M<<1);return U}return O.getUint16(0)}function o(m){var k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,I=arguments[2];if(y){var z=new DataView(g.buffer);if(k>1||I){for(var P=new Uint32Array(k),N=0;N<k;N++)P[N]=z.getUint32(m+(N<<2));return P}return z.getUint32(m)}var O=new DataView(a(m,k<<2).buffer);if(k>1||I){for(var U=new Uint32Array(k),M=0;M<k;M++)U[M]=O.getUint32(M<<2);return U}return O.getUint32(0)}function h(g,m,I,z){var P=Mr[g];P&&(k[P]=function(g,m,k){var I,z=function(g,m){switch(g){case 1:return m;case 3:return m<<1;case 4:default:return m<<2;case 5:return m<<3}}(g,m);z>4&&(k=o(k)),I=z<4?4/z:m;var P=void 0;switch(g){case 1:break;case 3:P=s(k,I,!0);break;case 4:P=o(k,I,!0)}if(P)return z<4?y?P.slice(0,I-m):P.slice(I-m):P}(m,I,z))}function f(m){for(var y=new Uint8Array(m.stripByteCounts.reduce((function(g,m){return g+m}),0)),k=0,I=0;I<m.stripOffsets.length;I++){var z=g.subarray(m.stripOffsets[I],m.stripOffsets[I]+m.stripByteCounts[I]);y.set(z,k),k+=z.byteLength}return y}if(77===g[0]&&77===g[1])y=!0;else{if(73!==g[0]||73!==g[1])throw new Error("Invalid byte order "+g[0]+g[1]);y=!1}if(42!==a(2,2)[1])throw new Error("not tiff");for(var z=[],P=o(4);0!==P;P=o(m)){var N=s(m=P);k={},m+=2;for(var O=0;O<N;O++)h(s(m),s(m+=2),o(m+=2),m+=4),m+=4;I=f(k),z.push({stripData:I,ifdEntries:k})}return z}function Je(g,m){var y=g.colorMap,k=g.bitsPerSample,I=g.photometricInterpretation,z=void 0;if(m=function(g,m){var y=g.compression;if(y&&1!==y[0])throw 2===y[0]?new Error("CCITT group3 decompressionion is not implemented."):5===y[0]?new Error("LZW decompressionion is not implemented."):6===y[0]?new Error("JPEG decompressionion is not implemented."):7===y[0]?new Error("JPEG2 decompressionion is not implemented."):8===y[0]?new Error("Zip (Adove Deflate) decompressionion is not implemented."):32773===y[0]?new Error("Packbits decompression is not implemented."):new Error("Unknown compression type: "+y[0]);return m}(g,m),!k)throw new Error("Bilevel image decode is not implemented.");if(y)throw new Error("Palette-color image decode is not implemented.");if(I[0]=4===k.length)return m;if(I[0]=3===k.length){z=new Uint8Array(m.length/3*4);for(var P=0;P<m.length/3;P++)z[4*P]=m[3*P],z[4*P+1]=m[3*P+1],z[4*P+2]=m[3*P+2],z[4*P+3]=255;return z}if(I[0]<2&&1===k.length&&4===k[0]){z=new Uint8Array(4*m.length);for(var N=0;N<m.length;N++)z[4*N]=m[N]<<4,z[4*N+1]=m[N+1]<<4,z[4*N+2]=m[N+2]<<4,z[4*N+3]=255;return z}if(I[0]<2&&1===k.length&&8===k[0]){z=new Uint8Array(4*m.length);for(var O=0;O<m.length;O++)z[4*O]=m[O],z[4*O+1]=m[O+1],z[4*O+2]=m[O+2],z[4*O+3]=255;return z}throw new Error("Can't detect image type. PhotometricInterpretation: "+I[0]+", BitsPerSample: "+k)}var $e_decode=function(g){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{singlePage:!0},y=Ke(new Uint8Array(g)),k=y.map((function(g){return{width:g.ifdEntries.imageWidth[0],height:g.ifdEntries.imageLength[0],data:Je(g.ifdEntries,g.stripData),ifdEntries:g.ifdEntries}}));if(m.singlePage){if(!k||!k.length)throw new Error("No pages");return k[0]}return k};const Br={decode(g){const m=$e_decode(g,{singlePage:!0});return{width:m.width,height:m.height,data:m.data}},encode(){throw new Error("Encoding is not supported for TIFF images!")}},Lr={[V.JPEG]:Ut,[V.PNG]:Ur,[V.GIF]:yt,[V.BMP]:W,[V.TIFF]:Br},er=(g,m,y)=>{const k=[],I=[],z=[],P=[];for(let N=0;N<m*y;N++)k.push(g[4*N]),I.push(g[4*N+1]),z.push(g[4*N+2]),P.push(g[4*N+3]);return[k,I,z,P]},rr=(g,m,y,k,I,z)=>{ir(g,m,y,k,(z[0]-1)/2),ir(m,g,y,k,(z[1]-1)/2),ir(g,m,y,k,(z[2]-1)/2)},ir=(g,m,y,k,I)=>{for(let y=0;y<g.length;y++)m[y]=g[y];nr(m,g,y,k,I),ar(g,m,y,k,I)},nr=(g,m,y,k,I)=>{const z=1/(I+I+1);for(let P=0;P<k;P++){let k=P*y,N=k,O=k+I;const U=g[k],M=g[k+y-1];let B=(I+1)*U;for(let m=0;m<I;m++)B+=g[k+m];for(let y=0;y<=I;y++)B+=g[O++]-U,m[k++]=B*z;for(let P=I+1;P<y-I;P++)B+=g[O++]-g[N++],m[k++]=B*z;for(let P=y-I;P<y;P++)B+=M-g[N++],m[k++]=B*z}},ar=(g,m,y,k,I)=>{const z=1/(I+I+1);for(let P=0;P<y;P++){let N=P,O=N,U=N+I*y;const M=g[N],B=g[N+y*(k-1)];let j=(I+1)*M;for(let m=0;m<I;m++)j+=g[N+m*y];for(let k=0;k<=I;k++)j+=g[U]-M,m[N]=j*z,U+=y,N+=y;for(let P=I+1;P<k-I;P++)j+=g[U]-g[O],m[N]=j*z,O+=y,U+=y,N+=y;for(let P=k-I;P<k;P++)j+=B-g[O],m[N]=j*z,O+=y,N+=y}},or=(g,m)=>g<1?Math.round(g*m):g,Rr={"center bottom":{horizontalPosition:"center",verticalPosition:"bottom"},"center center":{horizontalPosition:"center",verticalPosition:"center"},"center top":{horizontalPosition:"center",verticalPosition:"top"},"left bottom":{horizontalPosition:"left",verticalPosition:"bottom"},"left center":{horizontalPosition:"left",verticalPosition:"center"},"left top":{horizontalPosition:"left",verticalPosition:"top"},"right bottom":{horizontalPosition:"right",verticalPosition:"bottom"},"right center":{horizontalPosition:"right",verticalPosition:"center"},"right top":{horizontalPosition:"right",verticalPosition:"top"},bottom:{horizontalPosition:"center",verticalPosition:"bottom"},center:{horizontalPosition:"center",verticalPosition:"center"},left:{horizontalPosition:"left",verticalPosition:"center"},right:{horizontalPosition:"right",verticalPosition:"center"},top:{horizontalPosition:"center",verticalPosition:"top"}},dr=(g,m,y,k,I,z)=>{const P=g/m,N=y/k;let O=y,U=k,M=0,B=0;if("contain"===I||"cover"===I){"contain"===I?P>=N?U=y/P:O=k*P:"cover"===I&&(P<N?(O=y,U=y/P):(O=k*P,U=k));const{horizontalPosition:g,verticalPosition:m}=(g=>Rr[g]||Rr.center)(z);"left"===g?M=0:"center"===g?M=y/2-O/2:"right"===g&&(M=y-O),"top"===m?B=0:"center"===m?B=k/2-U/2:"bottom"===m&&(B=k-U)}return{imageWidth:Math.round(O),imageHeight:Math.round(U),xOffset:Math.round(M),yOffset:Math.round(B)}},ur=(g,m,y,k,I)=>m===k?y:Math.round((g-m)*I+(k-g)*y),cr=(g,m,y,k,I,z,P,N,O,U)=>{const M=[0,0,0,0];for(let m=0;m<4;m+=1){let y=4*(N*g.width+I)+m,U=4*(N*g.width+z)+m;const B=ur(k,I,g.data[y],z,g.data[U]);if(O===N)M[m]=B;else{y=4*(O*g.width+I)+m,U=4*(O*g.width+z)+m;const j=ur(k,I,g.data[y],z,g.data[U]);M[m]=ur(P,N,B,O,j)}}M.every((g=>0===g))?m.set(U,y):m.set(M,y)},pr=(g,m)=>(y,k)=>({x:y+g,y:k+m}),Fr=new Set([V.JPEG,V.PNG,V.GIF,V.BMP,V.TIFF]),Dr=new Set([V.JPEG,V.PNG,V.GIF,V.BMP]);class _r{#t;#e;outputOptions;constructor(g,m,y={}){let k={};if(null==m?(this.#e=i(g),k=y||{}):"string"==typeof m?(this.#e=m,k=y||{}):(this.#e=i(g),"object"!=typeof m||Array.isArray(m)||(k=m||{})),!Fr.has(this.#e))throw new Error(`Unsupported input file type: ${this.#e}`);this.#t=Lr[this.#e].decode(g),this.outputOptions={background:k.background??[0,0,0,0],quality:k.quality??80,compressionLevel:k.compressionLevel??9,loop:k.loop??0,delay:k.delay??100}}get width(){return this.#t.width}get height(){return this.#t.height}crop(g,m,y,k){return((g,m,y)=>{const k=or(m.x,g.width),I=or(m.y,g.height),z=or(m.width,g.width),P=or(m.height,g.height),N=new Uint8Array(z*P*4);for(let g=0;g<N.length;g+=4)N.set(y,g);const O=z-k,U=P-I;for(let m=0;m<U;m+=1){const y=(I+m)*g.width+k<<2,P=y+(O<<2),U=g.data.subarray(y,P),M=m*z<<2;N.set(U,M)}g.data=N,g.width=z,g.height=P})(this.#t,{x:g,y:m,width:y,height:k},this.outputOptions.background),this}resize(g,m=null,y={}){let k=null,I={};if(null==m?(k=null,I=y||{}):"number"==typeof m?(k=m,I=y||{}):(k=null,"object"!=typeof m||Array.isArray(m)||(I=m||{})),!g&&!k)throw new Error("At least one dimension must be provided!");return((g,m,y,k,I)=>{if(!m&&!y)throw new Error("At least one dimension must be provided!");const{frameWidth:z,frameHeight:P}=((g,m,y,k,I)=>{if(y&&k){if("fill"===I||"contain"===I)return{frameWidth:y,frameHeight:k};if("inside"===I){const I=Math.min(y/g,k/m);return{frameWidth:Math.round(g*I),frameHeight:Math.round(m*I)}}if("outside"===I){const I=Math.max(y/g,k/m);return{frameWidth:Math.round(g*I),frameHeight:Math.round(m*I)}}}const z=g/m;return{frameWidth:y||Math.round(k*z),frameHeight:k||Math.round(y/z)}})(g.width,g.height,m,y,k.fit),{imageWidth:N,imageHeight:O,xOffset:U,yOffset:M}=dr(g.width,g.height,z,P,k.fit,k.position),B=new Uint8Array(z*P*4);for(let g=0;g<B.length;g+=4)B.set(I,g);for(let m=0;m<O&&m+M<P;m+=1)for(let y=0;y<N&&y+U<z;y+=1){if(y+U<0||y+U>=z||m+M<0||m+M>=P)continue;const k=4*((m+M)*z+(y+U)),j=y*g.width/N,G=Math.floor(j),H=Math.min(Math.ceil(j),g.width-1),V=m*g.height/O,q=Math.floor(V),Z=Math.min(Math.ceil(V),g.height-1);cr(g,B,k,j,G,H,V,q,Z,I)}g.data=B,g.width=z,g.height=P})(this.#t,g,k,{fit:I.fit??"cover",position:I.position??"center"},this.outputOptions.background),this}flip(g){return((g,m)=>{if("horizontal"===m||"both"===m)for(let m=0;m<g.height;m+=1){const y=m*g.width;for(let m=0;m<g.width/2;m+=1){const k=y+m<<2,I=g.data.slice(k,k+4),z=y+(g.width-1-m)<<2,P=g.data.slice(z,z+4);g.data.set(I,z),g.data.set(P,k)}}if("vertical"===m||"both"===m)for(let m=0;m<g.width;m+=1)for(let y=0;y<g.height/2;y+=1){const k=y*g.width+m<<2,I=g.data.slice(k,k+4),z=(g.height-1-y)*g.width+m<<2,P=g.data.slice(z,z+4);g.data.set(I,z),g.data.set(P,k)}})(this.#t,g),this}rotate(g){return((g,m,y)=>{const k=m%360*Math.PI/180,I=Math.cos(k),z=Math.sin(k),P=new Uint8Array(g.data.length);for(let g=0;g<P.length;g+=4)P.set(y,g);const N=pr(-g.width/2,-g.height/2),O=pr(g.width/2+.5,g.height/2+.5);for(let m=1;m<=g.height;m++)for(let y=1;y<=g.width;y++){const k=N(y,m),U=O(I*k.x-z*k.y,I*k.y+z*k.x),M=g.width*(m-1)+y-1<<2;if(U.x>=0&&U.x<g.width&&U.y>=0&&U.y<g.height){const m=(g.width*(0|U.y)+U.x|0)<<2,y=g.data.subarray(m,m+4);P.set(y,M)}}g.data=P})(this.#t,g,this.outputOptions.background),this}blur(g){return((g,m)=>{const y=er(g.data,g.width,g.height),k=er(g.data,g.width,g.height),I=((g,m)=>{const y=Math.sqrt(12*g*g/3+1);let k=Math.floor(y);k%2==0&&k--;const I=k+2,z=(12*g*g-3*k*k-12*k-9)/(-4*k-4),P=Math.round(z),N=[];for(let g=0;g<3;g++)N.push(g<P?k:I);return N})(m);rr(y[0],k[0],g.width,g.height,0,I),rr(y[1],k[1],g.width,g.height,0,I),rr(y[2],k[2],g.width,g.height,0,I),((g,m,y,k,I,z,P)=>{for(let N=0;N<m*y;N++)g[4*N]=k[N],g[4*N+1]=I[N],g[4*N+2]=z[N],g[4*N+3]=P[N]})(g.data,g.width,g.height,k[0],k[1],k[2],k[3])})(this.#t,g),this}toBuffer(g){const m=g||this.#e;if(!Dr.has(m))throw new Error(`Unsupported output file type: ${m}`);return Lr[m].encode(((g,m,y)=>{if(m===V.GIF){const m=g.data.slice(0),k=y.slice(0);k[3]=255;for(let g=0;g<m.length;g+=4)m[g+3]<128?m.set(k,g):m[g+3]=255;return{width:g.width,height:g.height,data:m}}if(m===V.JPEG){const m=g.data.slice(0);for(let g=3;g<m.length;g+=4)m[g]=255;return{width:g.width,height:g.height,data:m}}return g})(this.#t,m,this.outputOptions.background),this.outputOptions)}}const jr={name:"pureTransformer",supportedInputs:Fr,supportedOutputs:Dr,fallbackOutput:exports.MimeType.PNG,transform:async({data:g,contentType:m},{contentType:y,width:k,height:I,fit:z,position:P,background:N,quality:O,loop:U,delay:M,blurRadius:B,rotate:j,flip:G,crop:H,compressionLevel:V})=>{const q=new _r(g,m,{background:N,loop:U,delay:M,quality:O,compressionLevel:V});return H&&q.crop(H.x,H.y,H.width,H.height),null==k&&null==I||q.resize(k,I,{fit:z,position:P}),G&&q.flip(G),j&&0!==j&&q.rotate(j),B&&B>0&&q.blur(B),q.toBuffer(y)}};const Gr="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,Hr="function"==typeof AbortController?AbortController:class AbortController{constructor(){this.signal=new Zr}abort(){this.signal.dispatchEvent("abort")}},Vr="function"==typeof AbortSignal,qr="function"==typeof Hr.AbortSignal,Zr=Vr?AbortSignal:qr?Hr.AbortController:class AbortSignal{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(g){if("abort"===g){this.aborted=!0;const m={type:g,target:this};this.onabort(m),this._listeners.forEach((g=>g(m)),this)}}onabort(){}addEventListener(g,m){"abort"===g&&this._listeners.push(m)}removeEventListener(g,m){"abort"===g&&(this._listeners=this._listeners.filter((g=>g!==m)))}},$r=new Set,deprecatedOption=(g,m)=>{const y=`LRU_CACHE_OPTION_${g}`;shouldWarn(y)&&warn(y,`${g} option`,`options.${m}`,LRUCache)},deprecatedMethod=(g,m)=>{const y=`LRU_CACHE_METHOD_${g}`;if(shouldWarn(y)){const{prototype:k}=LRUCache,{get:I}=Object.getOwnPropertyDescriptor(k,g);warn(y,`${g} method`,`cache.${m}()`,I)}},emitWarning=(...g)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(...g):console.error(...g)},shouldWarn=g=>!$r.has(g),warn=(g,m,y,k)=>{$r.add(g);emitWarning(`The ${m} is deprecated. Please use ${y} instead.`,"DeprecationWarning",g,k)},isPosInt=g=>g&&g===Math.floor(g)&&g>0&&isFinite(g),getUintArray=g=>isPosInt(g)?g<=Math.pow(2,8)?Uint8Array:g<=Math.pow(2,16)?Uint16Array:g<=Math.pow(2,32)?Uint32Array:g<=Number.MAX_SAFE_INTEGER?ZeroArray:null:null;class ZeroArray extends Array{constructor(g){super(g),this.fill(0)}}class Stack{constructor(g){if(0===g)return[];const m=getUintArray(g);this.heap=new m(g),this.length=0}push(g){this.heap[this.length++]=g}pop(){return this.heap[--this.length]}}class LRUCache{constructor(g={}){const{max:m=0,ttl:y,ttlResolution:k=1,ttlAutopurge:I,updateAgeOnGet:z,updateAgeOnHas:P,allowStale:N,dispose:O,disposeAfter:U,noDisposeOnSet:M,noUpdateTTL:B,maxSize:j=0,maxEntrySize:G=0,sizeCalculation:H,fetchMethod:V,fetchContext:q,noDeleteOnFetchRejection:Z,noDeleteOnStaleGet:$}=g,{length:W,maxAge:X,stale:J}=g instanceof LRUCache?{}:g;if(0!==m&&!isPosInt(m))throw new TypeError("max option must be a nonnegative integer");const Y=m?getUintArray(m):Array;if(!Y)throw new Error("invalid max value: "+m);if(this.max=m,this.maxSize=j,this.maxEntrySize=G||this.maxSize,this.sizeCalculation=H||W,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=V||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=q,!this.fetchMethod&&void 0!==q)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(m).fill(null),this.valList=new Array(m).fill(null),this.next=new Y(m),this.prev=new Y(m),this.head=0,this.tail=0,this.free=new Stack(m),this.initialFill=1,this.size=0,"function"==typeof O&&(this.dispose=O),"function"==typeof U?(this.disposeAfter=U,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!M,this.noUpdateTTL=!!B,this.noDeleteOnFetchRejection=!!Z,0!==this.maxEntrySize){if(0!==this.maxSize&&!isPosInt(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!isPosInt(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!N||!!J,this.noDeleteOnStaleGet=!!$,this.updateAgeOnGet=!!z,this.updateAgeOnHas=!!P,this.ttlResolution=isPosInt(k)||0===k?k:1,this.ttlAutopurge=!!I,this.ttl=y||X||0,this.ttl){if(!isPosInt(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const g="LRU_CACHE_UNBOUNDED";if(shouldWarn(g)){$r.add(g);emitWarning("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",g,LRUCache)}}J&&deprecatedOption("stale","allowStale"),X&&deprecatedOption("maxAge","ttl"),W&&deprecatedOption("length","sizeCalculation")}getRemainingTTL(g){return this.has(g,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new ZeroArray(this.max),this.starts=new ZeroArray(this.max),this.setItemTTL=(g,m,y=Gr.now())=>{if(this.starts[g]=0!==m?y:0,this.ttls[g]=m,0!==m&&this.ttlAutopurge){const y=setTimeout((()=>{this.isStale(g)&&this.delete(this.keyList[g])}),m+1);y.unref&&y.unref()}},this.updateItemAge=g=>{this.starts[g]=0!==this.ttls[g]?Gr.now():0};let g=0;const getNow=()=>{const m=Gr.now();if(this.ttlResolution>0){g=m;const y=setTimeout((()=>g=0),this.ttlResolution);y.unref&&y.unref()}return m};this.getRemainingTTL=m=>{const y=this.keyMap.get(m);return void 0===y?0:0===this.ttls[y]||0===this.starts[y]?1/0:this.starts[y]+this.ttls[y]-(g||getNow())},this.isStale=m=>0!==this.ttls[m]&&0!==this.starts[m]&&(g||getNow())-this.starts[m]>this.ttls[m]}updateItemAge(g){}setItemTTL(g,m,y){}isStale(g){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new ZeroArray(this.max),this.removeItemSize=g=>{this.calculatedSize-=this.sizes[g],this.sizes[g]=0},this.requireSize=(g,m,y,k)=>{if(this.isBackgroundFetch(m))return 0;if(!isPosInt(y)){if(!k)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof k)throw new TypeError("sizeCalculation must be a function");if(y=k(m,g),!isPosInt(y))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return y},this.addItemSize=(g,m)=>{if(this.sizes[g]=m,this.maxSize){const m=this.maxSize-this.sizes[g];for(;this.calculatedSize>m;)this.evict(!0)}this.calculatedSize+=this.sizes[g]}}removeItemSize(g){}addItemSize(g,m){}requireSize(g,m,y,k){if(y||k)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:g=this.allowStale}={}){if(this.size)for(let m=this.tail;this.isValidIndex(m)&&(!g&&this.isStale(m)||(yield m),m!==this.head);)m=this.prev[m]}*rindexes({allowStale:g=this.allowStale}={}){if(this.size)for(let m=this.head;this.isValidIndex(m)&&(!g&&this.isStale(m)||(yield m),m!==this.tail);)m=this.next[m]}isValidIndex(g){return this.keyMap.get(this.keyList[g])===g}*entries(){for(const g of this.indexes())yield[this.keyList[g],this.valList[g]]}*rentries(){for(const g of this.rindexes())yield[this.keyList[g],this.valList[g]]}*keys(){for(const g of this.indexes())yield this.keyList[g]}*rkeys(){for(const g of this.rindexes())yield this.keyList[g]}*values(){for(const g of this.indexes())yield this.valList[g]}*rvalues(){for(const g of this.rindexes())yield this.valList[g]}[Symbol.iterator](){return this.entries()}find(g,m={}){for(const y of this.indexes())if(g(this.valList[y],this.keyList[y],this))return this.get(this.keyList[y],m)}forEach(g,m=this){for(const y of this.indexes())g.call(m,this.valList[y],this.keyList[y],this)}rforEach(g,m=this){for(const y of this.rindexes())g.call(m,this.valList[y],this.keyList[y],this)}get prune(){return deprecatedMethod("prune","purgeStale"),this.purgeStale}purgeStale(){let g=!1;for(const m of this.rindexes({allowStale:!0}))this.isStale(m)&&(this.delete(this.keyList[m]),g=!0);return g}dump(){const g=[];for(const m of this.indexes({allowStale:!0})){const y=this.keyList[m],k=this.valList[m],I={value:this.isBackgroundFetch(k)?k.__staleWhileFetching:k};if(this.ttls){I.ttl=this.ttls[m];const g=Gr.now()-this.starts[m];I.start=Math.floor(Date.now()-g)}this.sizes&&(I.size=this.sizes[m]),g.unshift([y,I])}return g}load(g){this.clear();for(const[m,y]of g){if(y.start){const g=Date.now()-y.start;y.start=Gr.now()-g}this.set(m,y.value,y)}}dispose(g,m,y){}set(g,m,{ttl:y=this.ttl,start:k,noDisposeOnSet:I=this.noDisposeOnSet,size:z=0,sizeCalculation:P=this.sizeCalculation,noUpdateTTL:N=this.noUpdateTTL}={}){if(z=this.requireSize(g,m,z,P),this.maxEntrySize&&z>this.maxEntrySize)return this.delete(g),this;let O=0===this.size?void 0:this.keyMap.get(g);if(void 0===O)O=this.newIndex(),this.keyList[O]=g,this.valList[O]=m,this.keyMap.set(g,O),this.next[this.tail]=O,this.prev[O]=this.tail,this.tail=O,this.size++,this.addItemSize(O,z),N=!1;else{const y=this.valList[O];m!==y&&(this.isBackgroundFetch(y)?y.__abortController.abort():I||(this.dispose(y,g,"set"),this.disposeAfter&&this.disposed.push([y,g,"set"])),this.removeItemSize(O),this.valList[O]=m,this.addItemSize(O,z)),this.moveToTail(O)}if(0===y||0!==this.ttl||this.ttls||this.initializeTTLTracking(),N||this.setItemTTL(O,y,k),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const g=this.valList[this.head];return this.evict(!0),g}}evict(g){const m=this.head,y=this.keyList[m],k=this.valList[m];return this.isBackgroundFetch(k)?k.__abortController.abort():(this.dispose(k,y,"evict"),this.disposeAfter&&this.disposed.push([k,y,"evict"])),this.removeItemSize(m),g&&(this.keyList[m]=null,this.valList[m]=null,this.free.push(m)),this.head=this.next[m],this.keyMap.delete(y),this.size--,m}has(g,{updateAgeOnHas:m=this.updateAgeOnHas}={}){const y=this.keyMap.get(g);return void 0!==y&&!this.isStale(y)&&(m&&this.updateItemAge(y),!0)}peek(g,{allowStale:m=this.allowStale}={}){const y=this.keyMap.get(g);if(void 0!==y&&(m||!this.isStale(y))){const g=this.valList[y];return this.isBackgroundFetch(g)?g.__staleWhileFetching:g}}backgroundFetch(g,m,y,k){const I=void 0===m?void 0:this.valList[m];if(this.isBackgroundFetch(I))return I;const z=new Hr,P={signal:z.signal,options:y,context:k},N=new Promise((m=>m(this.fetchMethod(g,I,P)))).then((m=>(z.signal.aborted||this.set(g,m,P.options),m)),(k=>{if(this.valList[m]===N){!y.noDeleteOnFetchRejection||void 0===N.__staleWhileFetching?this.delete(g):this.valList[m]=N.__staleWhileFetching}if(N.__returned===N)throw k}));return N.__abortController=z,N.__staleWhileFetching=I,N.__returned=null,void 0===m?(this.set(g,N,P.options),m=this.keyMap.get(g)):this.valList[m]=N,N}isBackgroundFetch(g){return g&&"object"==typeof g&&"function"==typeof g.then&&Object.prototype.hasOwnProperty.call(g,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(g,"__returned")&&(g.__returned===g||null===g.__returned)}async fetch(g,{allowStale:m=this.allowStale,updateAgeOnGet:y=this.updateAgeOnGet,noDeleteOnStaleGet:k=this.noDeleteOnStaleGet,ttl:I=this.ttl,noDisposeOnSet:z=this.noDisposeOnSet,size:P=0,sizeCalculation:N=this.sizeCalculation,noUpdateTTL:O=this.noUpdateTTL,noDeleteOnFetchRejection:U=this.noDeleteOnFetchRejection,fetchContext:M=this.fetchContext,forceRefresh:B=!1}={}){if(!this.fetchMethod)return this.get(g,{allowStale:m,updateAgeOnGet:y,noDeleteOnStaleGet:k});const j={allowStale:m,updateAgeOnGet:y,noDeleteOnStaleGet:k,ttl:I,noDisposeOnSet:z,size:P,sizeCalculation:N,noUpdateTTL:O,noDeleteOnFetchRejection:U};let G=this.keyMap.get(g);if(void 0===G){const m=this.backgroundFetch(g,G,j,M);return m.__returned=m}{const k=this.valList[G];if(this.isBackgroundFetch(k))return m&&void 0!==k.__staleWhileFetching?k.__staleWhileFetching:k.__returned=k;if(!B&&!this.isStale(G))return this.moveToTail(G),y&&this.updateItemAge(G),k;const I=this.backgroundFetch(g,G,j,M);return m&&void 0!==I.__staleWhileFetching?I.__staleWhileFetching:I.__returned=I}}get(g,{allowStale:m=this.allowStale,updateAgeOnGet:y=this.updateAgeOnGet,noDeleteOnStaleGet:k=this.noDeleteOnStaleGet}={}){const I=this.keyMap.get(g);if(void 0!==I){const z=this.valList[I],P=this.isBackgroundFetch(z);if(this.isStale(I))return P?m?z.__staleWhileFetching:void 0:(k||this.delete(g),m?z:void 0);if(P)return;return this.moveToTail(I),y&&this.updateItemAge(I),z}}connect(g,m){this.prev[m]=g,this.next[g]=m}moveToTail(g){g!==this.tail&&(g===this.head?this.head=this.next[g]:this.connect(this.prev[g],this.next[g]),this.connect(this.tail,g),this.tail=g)}get del(){return deprecatedMethod("del","delete"),this.delete}delete(g){let m=!1;if(0!==this.size){const y=this.keyMap.get(g);if(void 0!==y)if(m=!0,1===this.size)this.clear();else{this.removeItemSize(y);const m=this.valList[y];this.isBackgroundFetch(m)?m.__abortController.abort():(this.dispose(m,g,"delete"),this.disposeAfter&&this.disposed.push([m,g,"delete"])),this.keyMap.delete(g),this.keyList[y]=null,this.valList[y]=null,y===this.tail?this.tail=this.prev[y]:y===this.head?this.head=this.next[y]:(this.next[this.prev[y]]=this.next[y],this.prev[this.next[y]]=this.prev[y]),this.size--,this.free.push(y)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return m}clear(){for(const g of this.rindexes({allowStale:!0})){const m=this.valList[g];if(this.isBackgroundFetch(m))m.__abortController.abort();else{const y=this.keyList[g];this.dispose(m,y,"delete"),this.disposeAfter&&this.disposed.push([m,y,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return deprecatedMethod("reset","clear"),this.clear}get length(){return((g,m)=>{const y=`LRU_CACHE_PROPERTY_${g}`;if(shouldWarn(y)){const{prototype:k}=LRUCache,{get:I}=Object.getOwnPropertyDescriptor(k,g);warn(y,`${g} property`,`cache.${m}`,I)}})("length","size"),this.size}static get AbortController(){return Hr}static get AbortSignal(){return Zr}}var Wr=LRUCache;const mB=g=>1e6*g;var Xr={},Jr={get exports(){return Xr},set exports(g){Xr=g}},Yr={},Kr={},Qr={};!function(g){const m=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",y="["+m+"]["+(m+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*",k=new RegExp("^"+y+"$");g.isExist=function(g){return void 0!==g},g.isEmptyObject=function(g){return 0===Object.keys(g).length},g.merge=function(g,m,y){if(m){const k=Object.keys(m),I=k.length;for(let z=0;z<I;z++)g[k[z]]="strict"===y?[m[k[z]]]:m[k[z]]}},g.getValue=function(m){return g.isExist(m)?m:""},g.buildOptions=function(g,m,y){let k={};if(!g)return m;for(let I=0;I<y.length;I++)void 0!==g[y[I]]?k[y[I]]=g[y[I]]:k[y[I]]=m[y[I]];return k},g.isTagNameInArrayMode=function(g,m,y){return!1!==m&&(m instanceof RegExp?m.test(g):"function"==typeof m?!!m(g,y):"strict"===m)},g.isName=function(g){const m=k.exec(g);return!(null==m)},g.getAllMatches=function(g,m){const y=[];let k=m.exec(g);for(;k;){const I=[];I.startIndex=m.lastIndex-k[0].length;const z=k.length;for(let g=0;g<z;g++)I.push(k[g]);y.push(I),k=m.exec(g)}return y},g.nameRegexp=y}(Qr);const ti=Qr,convertToJson=function(g,m,y){const k={};if(!m.alwaysCreateTextNode&&(!g.child||ti.isEmptyObject(g.child))&&(!g.attrsMap||ti.isEmptyObject(g.attrsMap)))return ti.isExist(g.val)?g.val:"";if(ti.isExist(g.val)&&("string"!=typeof g.val||""!==g.val&&g.val!==m.cdataPositionChar)){const I=ti.isTagNameInArrayMode(g.tagname,m.arrayMode,y);k[m.textNodeName]=I?[g.val]:g.val}ti.merge(k,g.attrsMap,m.arrayMode);const I=Object.keys(g.child);for(let z=0;z<I.length;z++){const P=I[z];if(g.child[P]&&g.child[P].length>1){k[P]=[];for(let y in g.child[P])g.child[P].hasOwnProperty(y)&&k[P].push(convertToJson(g.child[P][y],m,P))}else{const I=convertToJson(g.child[P][0],m,P),z=!0===m.arrayMode&&"object"==typeof I||ti.isTagNameInArrayMode(P,m.arrayMode,y);k[P]=z?[I]:I}}return k};Kr.convertToJson=convertToJson;var ei={};const ri=/^[-+]?0x[a-fA-F0-9]+$/,ii=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const ni={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};const ai=Qr,si=Qr.buildOptions,xmlNode=function(g,m,y){this.tagname=g,this.parent=m,this.child={},this.attrsMap={},this.val=y,this.addChild=function(g){Array.isArray(this.child[g.tagname])?this.child[g.tagname].push(g):this.child[g.tagname]=[g]}},oi=function toNumber$1(g,m={}){if(m=Object.assign({},ni,m),!g||"string"!=typeof g)return g;let y=g.trim();if(void 0!==m.skipLike&&m.skipLike.test(y))return g;if(m.hex&&ri.test(y))return Number.parseInt(y,16);{const k=ii.exec(y);if(k){const I=k[1],z=k[2];let P=function trimZeros(g){if(g&&-1!==g.indexOf("."))return"."===(g=g.replace(/0+$/,""))?g="0":"."===g[0]?g="0"+g:"."===g[g.length-1]&&(g=g.substr(0,g.length-1)),g;return g}(k[3]);const N=k[4]||k[6];if(!m.leadingZeros&&z.length>0&&I&&"."!==y[2])return g;if(!m.leadingZeros&&z.length>0&&!I&&"."!==y[1])return g;{const k=Number(y),O=""+k;return-1!==O.search(/[eE]/)||N?m.eNotation?k:g:-1!==y.indexOf(".")?"0"===O&&""===P||O===P||I&&O==="-"+P?k:g:z?P===O||I+P===O?k:g:y===O||y===I+O?k:g}}return g}};"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,ai.nameRegexp),!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const hi={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",numParseOptions:{hex:!0,leadingZeros:!0},tagValueProcessor:function(g,m){return g},attrValueProcessor:function(g,m){return g},stopNodes:[],alwaysCreateTextNode:!1};ei.defaultOptions=hi;const li=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","numParseOptions","stopNodes","alwaysCreateTextNode"];function processTagValue(g,m,y){return m&&(y.trimValues&&(m=m.trim()),m=parseValue(m=y.tagValueProcessor(m,g),y.parseNodeValue,y.numParseOptions)),m}function resolveNameSpace(g,m){if(m.ignoreNameSpace){const m=g.split(":"),y="/"===g.charAt(0)?"/":"";if("xmlns"===m[0])return"";2===m.length&&(g=y+m[1])}return g}function parseValue(g,m,y){if(m&&"string"==typeof g){const m=g.trim();return"true"===m||"false"!==m&&oi(g,y)}return ai.isExist(g)?g:""}ei.props=li;const fi=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function buildAttributesMap(g,m){if(!m.ignoreAttributes&&"string"==typeof g){g=g.replace(/\r?\n/g," ");const y=ai.getAllMatches(g,fi),k=y.length,I={};for(let g=0;g<k;g++){const k=resolveNameSpace(y[g][1],m);k.length&&(void 0!==y[g][4]?(m.trimValues&&(y[g][4]=y[g][4].trim()),y[g][4]=m.attrValueProcessor(y[g][4],k),I[m.attributeNamePrefix+k]=parseValue(y[g][4],m.parseAttributeValue,m.numParseOptions)):m.allowBooleanAttributes&&(I[m.attributeNamePrefix+k]=!0))}if(!Object.keys(I).length)return;if(m.attrNodeName){const g={};return g[m.attrNodeName]=I,g}return I}}function closingIndexForOpeningTag(g,m){let y,k="";for(let I=m;I<g.length;I++){let m=g[I];if(y)m===y&&(y="");else if('"'===m||"'"===m)y=m;else{if(">"===m)return{data:k,index:I};"\t"===m&&(m=" ")}k+=m}}function findClosingIndex(g,m,y,k){const I=g.indexOf(m,y);if(-1===I)throw new Error(k);return I+m.length-1}ei.getTraversalObj=function(g,m){g=g.replace(/\r\n?/g,"\n"),m=si(m,hi,li);const y=new xmlNode("!xml");let k=y,I="";for(let y=0;y<g.length;y++){if("<"===g[y])if("/"===g[y+1]){const z=findClosingIndex(g,">",y,"Closing Tag is not closed.");let P=g.substring(y+2,z).trim();if(m.ignoreNameSpace){const g=P.indexOf(":");-1!==g&&(P=P.substr(g+1))}k&&(k.val?k.val=ai.getValue(k.val)+""+processTagValue(P,I,m):k.val=processTagValue(P,I,m)),m.stopNodes.length&&m.stopNodes.includes(k.tagname)&&(k.child=[],null==k.attrsMap&&(k.attrsMap={}),k.val=g.substr(k.startIndex+1,y-k.startIndex-1)),k=k.parent,I="",y=z}else if("?"===g[y+1])y=findClosingIndex(g,"?>",y,"Pi Tag is not closed.");else if("!--"===g.substr(y+1,3))y=findClosingIndex(g,"--\x3e",y,"Comment is not closed.");else if("!D"===g.substr(y+1,2)){const m=findClosingIndex(g,">",y,"DOCTYPE is not closed.");y=g.substring(y,m).indexOf("[")>=0?g.indexOf("]>",y)+1:m}else if("!["===g.substr(y+1,2)){const z=findClosingIndex(g,"]]>",y,"CDATA is not closed.")-2,P=g.substring(y+9,z);if(I&&(k.val=ai.getValue(k.val)+""+processTagValue(k.tagname,I,m),I=""),m.cdataTagName){const g=new xmlNode(m.cdataTagName,k,P);k.addChild(g),k.val=ai.getValue(k.val)+m.cdataPositionChar,P&&(g.val=P)}else k.val=(k.val||"")+(P||"");y=z+2}else{const z=closingIndexForOpeningTag(g,y+1);let P=z.data;const N=z.index,O=P.indexOf(" ");let U=P,M=!0;if(-1!==O&&(U=P.substr(0,O).replace(/\s\s*$/,""),P=P.substr(O+1)),m.ignoreNameSpace){const g=U.indexOf(":");-1!==g&&(U=U.substr(g+1),M=U!==z.data.substr(g+1))}if(k&&I&&"!xml"!==k.tagname&&(k.val=ai.getValue(k.val)+""+processTagValue(k.tagname,I,m)),P.length>0&&P.lastIndexOf("/")===P.length-1){"/"===U[U.length-1]?(U=U.substr(0,U.length-1),P=U):P=P.substr(0,P.length-1);const g=new xmlNode(U,k,"");U!==P&&(g.attrsMap=buildAttributesMap(P,m)),k.addChild(g)}else{const g=new xmlNode(U,k);m.stopNodes.length&&m.stopNodes.includes(g.tagname)&&(g.startIndex=N),U!==P&&M&&(g.attrsMap=buildAttributesMap(P,m)),k.addChild(g),k=g}I="",y=N}else I+=g[y]}return y};var ci={};const di=Qr,ui={allowBooleanAttributes:!1},pi=["allowBooleanAttributes"];function readPI(g,m){const y=m;for(;m<g.length;m++)if("?"!=g[m]&&" "!=g[m]);else{const k=g.substr(y,m-y);if(m>5&&"xml"===k)return getErrorObject("InvalidXml","XML declaration allowed only at the start of the document.",getLineNumberForPosition(g,m));if("?"==g[m]&&">"==g[m+1]){m++;break}}return m}function readCommentAndCDATA(g,m){if(g.length>m+5&&"-"===g[m+1]&&"-"===g[m+2]){for(m+=3;m<g.length;m++)if("-"===g[m]&&"-"===g[m+1]&&">"===g[m+2]){m+=2;break}}else if(g.length>m+8&&"D"===g[m+1]&&"O"===g[m+2]&&"C"===g[m+3]&&"T"===g[m+4]&&"Y"===g[m+5]&&"P"===g[m+6]&&"E"===g[m+7]){let y=1;for(m+=8;m<g.length;m++)if("<"===g[m])y++;else if(">"===g[m]&&(y--,0===y))break}else if(g.length>m+9&&"["===g[m+1]&&"C"===g[m+2]&&"D"===g[m+3]&&"A"===g[m+4]&&"T"===g[m+5]&&"A"===g[m+6]&&"["===g[m+7])for(m+=8;m<g.length;m++)if("]"===g[m]&&"]"===g[m+1]&&">"===g[m+2]){m+=2;break}return m}ci.validate=function(g,m){m=di.buildOptions(m,ui,pi);const y=[];let k=!1,I=!1;"\ufeff"===g[0]&&(g=g.substr(1));for(let P=0;P<g.length;P++)if("<"===g[P]&&"?"===g[P+1]){if(P+=2,P=readPI(g,P),P.err)return P}else{if("<"!==g[P]){if(" "===g[P]||"\t"===g[P]||"\n"===g[P]||"\r"===g[P])continue;return getErrorObject("InvalidChar","char '"+g[P]+"' is not expected.",getLineNumberForPosition(g,P))}{let N=P;if(P++,"!"===g[P]){P=readCommentAndCDATA(g,P);continue}{let O=!1;"/"===g[P]&&(O=!0,P++);let U="";for(;P<g.length&&">"!==g[P]&&" "!==g[P]&&"\t"!==g[P]&&"\n"!==g[P]&&"\r"!==g[P];P++)U+=g[P];if(U=U.trim(),"/"===U[U.length-1]&&(U=U.substring(0,U.length-1),P--),z=U,!di.isName(z)){let m;return m=0===U.trim().length?"Invalid space after '<'.":"Tag '"+U+"' is an invalid name.",getErrorObject("InvalidTag",m,getLineNumberForPosition(g,P))}const M=readAttributeStr(g,P);if(!1===M)return getErrorObject("InvalidAttr","Attributes for '"+U+"' have open quote.",getLineNumberForPosition(g,P));let B=M.value;if(P=M.index,"/"===B[B.length-1]){const y=P-B.length;B=B.substring(0,B.length-1);const I=validateAttributeString(B,m);if(!0!==I)return getErrorObject(I.err.code,I.err.msg,getLineNumberForPosition(g,y+I.err.line));k=!0}else if(O){if(!M.tagClosed)return getErrorObject("InvalidTag","Closing tag '"+U+"' doesn't have proper closing.",getLineNumberForPosition(g,P));if(B.trim().length>0)return getErrorObject("InvalidTag","Closing tag '"+U+"' can't have attributes or invalid starting.",getLineNumberForPosition(g,N));{const m=y.pop();if(U!==m.tagName){let y=getLineNumberForPosition(g,m.tagStartPos);return getErrorObject("InvalidTag","Expected closing tag '"+m.tagName+"' (opened in line "+y.line+", col "+y.col+") instead of closing tag '"+U+"'.",getLineNumberForPosition(g,N))}0==y.length&&(I=!0)}}else{const z=validateAttributeString(B,m);if(!0!==z)return getErrorObject(z.err.code,z.err.msg,getLineNumberForPosition(g,P-B.length+z.err.line));if(!0===I)return getErrorObject("InvalidXml","Multiple possible root nodes found.",getLineNumberForPosition(g,P));y.push({tagName:U,tagStartPos:N}),k=!0}for(P++;P<g.length;P++)if("<"===g[P]){if("!"===g[P+1]){P++,P=readCommentAndCDATA(g,P);continue}if("?"!==g[P+1])break;if(P=readPI(g,++P),P.err)return P}else if("&"===g[P]){const m=validateAmpersand(g,P);if(-1==m)return getErrorObject("InvalidChar","char '&' is not expected.",getLineNumberForPosition(g,P));P=m}"<"===g[P]&&P--}}}var z;return k?1==y.length?getErrorObject("InvalidTag","Unclosed tag '"+y[0].tagName+"'.",getLineNumberForPosition(g,y[0].tagStartPos)):!(y.length>0)||getErrorObject("InvalidXml","Invalid '"+JSON.stringify(y.map((g=>g.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):getErrorObject("InvalidXml","Start tag expected.",1)};function readAttributeStr(g,m){let y="",k="",I=!1;for(;m<g.length;m++){if('"'===g[m]||"'"===g[m])""===k?k=g[m]:k!==g[m]||(k="");else if(">"===g[m]&&""===k){I=!0;break}y+=g[m]}return""===k&&{value:y,index:m,tagClosed:I}}const gi=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function validateAttributeString(g,m){const y=di.getAllMatches(g,gi),k={};for(let g=0;g<y.length;g++){if(0===y[g][1].length)return getErrorObject("InvalidAttr","Attribute '"+y[g][2]+"' has no space in starting.",getPositionFromMatch(y[g]));if(void 0===y[g][3]&&!m.allowBooleanAttributes)return getErrorObject("InvalidAttr","boolean attribute '"+y[g][2]+"' is not allowed.",getPositionFromMatch(y[g]));const I=y[g][2];if(!validateAttrName(I))return getErrorObject("InvalidAttr","Attribute '"+I+"' is an invalid name.",getPositionFromMatch(y[g]));if(k.hasOwnProperty(I))return getErrorObject("InvalidAttr","Attribute '"+I+"' is repeated.",getPositionFromMatch(y[g]));k[I]=1}return!0}function validateAmpersand(g,m){if(";"===g[++m])return-1;if("#"===g[m])return function validateNumberAmpersand(g,m){let y=/\d/;for("x"===g[m]&&(m++,y=/[\da-fA-F]/);m<g.length;m++){if(";"===g[m])return m;if(!g[m].match(y))break}return-1}(g,++m);let y=0;for(;m<g.length;m++,y++)if(!(g[m].match(/\w/)&&y<20)){if(";"===g[m])break;return-1}return m}function getErrorObject(g,m,y){return{err:{code:g,msg:m,line:y.line||y,col:y.col}}}function validateAttrName(g){return di.isName(g)}function getLineNumberForPosition(g,m){const y=g.substring(0,m).split(/\r?\n/);return{line:y.length,col:y[y.length-1].length+1}}function getPositionFromMatch(g){return g.startIndex+g[1].length}var mi,bi={};function requireNimndata(){if(mi)return bi;mi=1;const char=function(g){return String.fromCharCode(g)},g={nilChar:char(176),missingChar:char(201),nilPremitive:char(175),missingPremitive:char(200),emptyChar:char(178),emptyValue:char(177),boundryChar:char(179),objStart:char(198),arrStart:char(204),arrayEnd:char(185)},m=[g.nilChar,g.nilPremitive,g.missingChar,g.missingPremitive,g.boundryChar,g.emptyChar,g.emptyValue,g.arrayEnd,g.objStart,g.arrStart],_e=function(m,y,k){if("string"==typeof y)return m&&m[0]&&void 0!==m[0].val?getValue(m[0].val):getValue(m);{const I=function hasData(m){return void 0===m?g.missingChar:null===m?g.nilChar:!(m.child&&0===Object.keys(m.child).length&&(!m.attrsMap||0===Object.keys(m.attrsMap).length))||g.emptyChar}(m);if(!0===I){let I="";if(Array.isArray(y)){I+=g.arrStart;const z=y[0],P=m.length;if("string"==typeof z)for(let g=0;g<P;g++){const y=getValue(m[g].val);I=processValue(I,y)}else for(let g=0;g<P;g++){const y=_e(m[g],z,k);I=processValue(I,y)}I+=g.arrayEnd}else{I+=g.objStart;const z=Object.keys(y);Array.isArray(m)&&(m=m[0]);for(let g in z){const P=z[g];let N;N=!k.ignoreAttributes&&m.attrsMap&&m.attrsMap[P]?_e(m.attrsMap[P],y[P],k):P===k.textNodeName?_e(m.val,y[P],k):_e(m.child[P],y[P],k),I=processValue(I,N)}}return I}return I}},getValue=function(m){switch(m){case void 0:return g.missingPremitive;case null:return g.nilPremitive;case"":return g.emptyValue;default:return m}},processValue=function(m,y){return isAppChar(y[0])||isAppChar(m[m.length-1])||(m+=g.boundryChar),m+y},isAppChar=function(g){return-1!==m.indexOf(g)};const y=ei,k=Qr.buildOptions;return bi.convert2nimn=function(g,m,I){return I=k(I,y.defaultOptions,y.props),_e(g,m,I)},bi}var vi,wi,_i,yi={};function requireNode2json_str(){if(vi)return yi;vi=1;const g=Qr,m=Qr.buildOptions,y=ei,_cToJsonStr=function(m,y,k){let I="{";const z=Object.keys(m.child);for(let g=0;g<z.length;g++){const k=z[g];if(m.child[k]&&m.child[k].length>1){I+='"'+k+'" : [ ';for(let g in m.child[k])I+=_cToJsonStr(m.child[k][g],y)+" , ";I=I.substr(0,I.length-1)+" ] "}else I+='"'+k+'" : '+_cToJsonStr(m.child[k][0],y)+" ,"}return g.merge(I,m.attrsMap),g.isEmptyObject(I)?g.isExist(m.val)?m.val:"":(g.isExist(m.val)&&("string"!=typeof m.val||""!==m.val&&m.val!==y.cdataPositionChar)&&(I+='"'+y.textNodeName+'" : '+function stringval(g){return!0!==g&&!1!==g&&isNaN(g)?'"'+g+'"':g}(m.val)),","===I[I.length-1]&&(I=I.substr(0,I.length-2)),I+"}")};return yi.convertToJsonString=function(g,k){return(k=m(k,y.defaultOptions,y.props)).indentBy=k.indentBy||"",_cToJsonStr(g,k)},yi}!function(g){const m=Kr,y=ei,k=ei,I=Qr.buildOptions,z=ci;g.parse=function(g,P={},N){if(N){!0===N&&(N={});const m=z.validate(g,N);if(!0!==m)throw Error(m.err.msg)}P.parseTrueNumberOnly&&!1!==P.parseNodeValue&&!P.numParseOptions&&(P.numParseOptions={leadingZeros:!1});let O=I(P,k.defaultOptions,k.props);const U=y.getTraversalObj(g,O);return m.convertToJson(U,O)},g.convertTonimn=requireNimndata().convert2nimn,g.getTraversalObj=y.getTraversalObj,g.convertToJson=m.convertToJson,g.convertToJsonString=requireNode2json_str().convertToJsonString,g.validate=z.validate,g.j2xParser=function requireJson2xml(){if(_i)return wi;_i=1;const g=Qr.buildOptions,m={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(g){return g},attrValueProcessor:function(g){return g}},y=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor","rootNodeName"];function Parser(k){this.options=g(k,m,y),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=isAttribute),this.options.cdataTagName?this.isCDATA=isCDATA:this.isCDATA=function(){return!1},this.replaceCDATAstr=replaceCDATAstr,this.replaceCDATAarr=replaceCDATAarr,this.processTextOrObjNode=processTextOrObjNode,this.options.format?(this.indentate=indentate,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=buildEmptyTextNode,this.buildObjNode=buildEmptyObjNode):(this.buildTextNode=buildTextValNode,this.buildObjNode=buildObjectNode),this.buildTextValNode=buildTextValNode,this.buildObjectNode=buildObjectNode}function processTextOrObjNode(g,m,y){const k=this.j2x(g,y+1);return void 0!==g[this.options.textNodeName]&&1===Object.keys(g).length?this.buildTextNode(k.val,m,k.attrStr,y):this.buildObjNode(k.val,m,k.attrStr,y)}function replaceCDATAstr(g,m){return g=this.options.tagValueProcessor(""+g),""===this.options.cdataPositionChar||""===g?g+"<![CDATA["+m+"]]"+this.tagEndChar:g.replace(this.options.cdataPositionChar,"<![CDATA["+m+"]]"+this.tagEndChar)}function replaceCDATAarr(g,m){if(g=this.options.tagValueProcessor(""+g),""===this.options.cdataPositionChar||""===g)return g+"<![CDATA["+m.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let y in m)g=g.replace(this.options.cdataPositionChar,"<![CDATA["+m[y]+"]]>");return g+this.newLine}function buildObjectNode(g,m,y,k){return y&&-1===g.indexOf("<")?this.indentate(k)+"<"+m+y+">"+g+"</"+m+this.tagEndChar:this.indentate(k)+"<"+m+y+this.tagEndChar+g+this.indentate(k)+"</"+m+this.tagEndChar}function buildEmptyObjNode(g,m,y,k){return""!==g?this.buildObjectNode(g,m,y,k):this.indentate(k)+"<"+m+y+"/"+this.tagEndChar}function buildTextValNode(g,m,y,k){return this.indentate(k)+"<"+m+y+">"+this.options.tagValueProcessor(g)+"</"+m+this.tagEndChar}function buildEmptyTextNode(g,m,y,k){return""!==g?this.buildTextValNode(g,m,y,k):this.indentate(k)+"<"+m+y+"/"+this.tagEndChar}function indentate(g){return this.options.indentBy.repeat(g)}function isAttribute(g){return!!g.startsWith(this.options.attributeNamePrefix)&&g.substr(this.attrPrefixLen)}function isCDATA(g){return g===this.options.cdataTagName}return Parser.prototype.parse=function(g){return Array.isArray(g)&&this.options.rootNodeName&&this.options.rootNodeName.length>1&&(g={[this.options.rootNodeName]:g}),this.j2x(g,0).val},Parser.prototype.j2x=function(g,m){let y="",k="";for(let I in g)if(void 0===g[I]);else if(null===g[I])k+=this.indentate(m)+"<"+I+"/"+this.tagEndChar;else if(g[I]instanceof Date)k+=this.buildTextNode(g[I],I,"",m);else if("object"!=typeof g[I]){const z=this.isAttribute(I);z?y+=" "+z+'="'+this.options.attrValueProcessor(""+g[I])+'"':this.isCDATA(I)?g[this.options.textNodeName]?k+=this.replaceCDATAstr(g[this.options.textNodeName],g[I]):k+=this.replaceCDATAstr("",g[I]):I===this.options.textNodeName?g[this.options.cdataTagName]||(k+=this.options.tagValueProcessor(""+g[I])):k+=this.buildTextNode(g[I],I,"",m)}else if(Array.isArray(g[I]))if(this.isCDATA(I))k+=this.indentate(m),g[this.options.textNodeName]?k+=this.replaceCDATAarr(g[this.options.textNodeName],g[I]):k+=this.replaceCDATAarr("",g[I]);else{const y=g[I].length;for(let z=0;z<y;z++){const y=g[I][z];void 0===y||(k+=null===y?this.indentate(m)+"<"+I+"/"+this.tagEndChar:"object"==typeof y?this.processTextOrObjNode(y,I,m):this.buildTextNode(y,I,"",m))}}else if(this.options.attrNodeName&&I===this.options.attrNodeName){const m=Object.keys(g[I]),k=m.length;for(let z=0;z<k;z++)y+=" "+m[z]+'="'+this.options.attrValueProcessor(""+g[I][m[z]])+'"'}else k+=this.processTextOrObjNode(g[I],I,m);return{attrStr:y,val:k}},wi=Parser}(),g.parseToNimn=function(m,y,k){return g.convertTonimn(g.getTraversalObj(m,k),y,k)}}(Yr);const xi=Yr,isSvg=g=>{if(null==g)return!1;if(0===(g=g.toString().trim().replace(/\n/g," ")).length)return!1;if(!0!==xi.validate(g))return!1;let m;try{m=xi.parse(g)}catch(g){return!1}return!!m&&"svg"in m};Jr.exports=isSvg,Xr.default=isSvg;exports.Cache=Cache,exports.DiskCache=class DiskCache extends Cache{config;cache;constructor(m={}){super(),this.config={path:m?.path??"tmp/img",ttl:m?.ttl??86400,tbd:m?.tbd??31536e3},this.cache=new g(this.config)}async status(g){return await this.cache.has(g)}async has(g){return await this.status(g)!==exports.CacheStatus.MISS}async get(g){if(!await this.has(g))return null;const m=await this.cache.get(g);return await this.cache.set(g,m),m}async set(g,m){await this.cache.set(g,m)}async clear(){await this.cache.purge()}},exports.GB=g=>1e9*g,exports.MemoryCache=class MemoryCache extends Cache{config;cache;constructor(g={}){super(),this.config={maxSize:g?.maxSize??mB(50),ttl:g?.ttl??86400,tbd:g?.tbd??31536e3},this.cache=new Wr({ttl:this.config.ttl,allowStale:!0,updateAgeOnGet:!0,maxSize:this.config.maxSize,sizeCalculation:g=>g.byteLength})}async status(g){return this.cache.has(g)?exports.CacheStatus.HIT:exports.CacheStatus.MISS}async has(g){return this.cache.has(g)}async get(g){return this.cache.get(g)??null}async set(g,m){this.cache.set(g,m,{size:m.byteLength})}async clear(){this.cache.clear()}},exports.RemixImageError=RemixImageError,exports.UnsupportedImageError=UnsupportedImageError,exports.fetchResolver=fetchResolver,exports.fsResolver=async(g,k,I,z)=>{const P=y.resolve(z,g.slice(1)),N=m.readFileSync(P);if(!N||N.byteLength<2)throw new RemixImageError("Invalid image retrieved from resolver!");let O=null;try{O=g$1(N)}catch(g){if(!Xr((new TextDecoder).decode(N)))throw new UnsupportedImageError("Buffer is not a supported image type!");O=exports.MimeType.SVG}return{buffer:new Uint8Array(N),contentType:O}},exports.generateKey=(...g)=>g.filter((g=>null!=g)).join("_"),exports.imageLoader=async({selfUrl:g,cache:m=null,resolver:y=fetchResolver,transformer:k=jr,useFallbackFormat:I=!0,fallbackFormat:z,useFallbackTransformer:P=!0,fallbackTransformer:N=jr,defaultOptions:U={},redirectOnFail:M=!1,skipFormats:B=new Set([exports.MimeType.SVG]),basePath:j="public",whitelistedDomains:G=null,blacklistedDomains:H=null,verbose:V=!1},q)=>{const Z=parseURL(q.url);let $=null;try{if(!g)throw new RemixImageError("selfUrl is required in RemixImage loader config!",500);let M;try{M=new URL(g)}catch(g){throw new RemixImageError("selfUrl is not a valid URL!")}const q=G?new Set([...G,M.host]):null,tt=H?new Set(H):null;if(K=Z.searchParams,Q="src",$=K.has(Q)?decodeURIComponent(K.get(Q)):null,!$)throw new RemixImageError("An image URL must be provided!",400);try{$=decodeURI($)}catch(g){throw new RemixImageError("An invalid image URL was provided!",400)}const et=(g=>{const m=O.parse(g,{arrayFormat:"bracket",parseNumbers:!0,parseBooleans:!0,sort:!1});return Object.prototype.hasOwnProperty.call(m,"crop")&&null!=m.crop&&(m.crop=JSON.parse(m.crop)),m})(Z.search),vt={fit:"cover",position:"center",background:[0,0,0,0],quality:80,compressionLevel:9,loop:0,delay:100,blurRadius:null,rotate:null,flip:null,crop:null,...U,...et},yt=parseURL($,g);if(!vt.width)throw new RemixImageError("A width is required!",400);if(vt.width&&vt.width>8e3)throw new RemixImageError("Requested Image too large!",406);if(vt.height&&vt.height>8e3)throw new RemixImageError("Requested Image too large!",406);const xt=Z.search;let kt,Et,It,zt=!0,Ut=!0,Bt=vt.contentType;if(m&&await m.has(xt)){const g=await m.get(xt);g&&(V&&console.log(`Retrieved image [${xt}] from cache.`),zt=!1,Ut=!1,kt=g,It=g$1(kt))}if(!kt){if(q&&!q.has(yt.host))throw new RemixImageError("The requested image host is not included on the whitelist!");if(tt&&tt.has(yt.host))throw new RemixImageError("The requested image host is not allowed!");const g=await y($,yt.toString(),vt,j);V&&console.log(`Fetched image [${xt}] directly using resolver: ${y.name}.`),zt=!0,Ut=!0,kt=g.buffer,It=g.contentType}if(!kt||!It)throw new RemixImageError("Failed to transform requested image!",500);if(Bt||(Bt=It),!Ut||B?.has(It))Et=kt;else if(null!=k){let g=k;if(!k.supportedInputs.has(It)){if(!P||k===N||!N.supportedInputs.has(It))throw new UnsupportedImageError(`Transformer does not allow this input content type: ${It}!`);console.error(`Transformer does not allow this input content type: ${It}! Falling back to transformer: ${N.name}`),g=N}g.supportedOutputs.has(Bt)||(I&&null!=z&&g.supportedOutputs.has(z)?(console.error(`Transformer does not allow this output content type: ${Bt}! Falling back to mime type: ${z}`),Bt=z):(console.error(`Transformer does not allow this output content type: ${Bt}! Falling back to mime type: ${g.fallbackOutput}`),Bt=g.fallbackOutput)),Et=await g.transform({url:yt.toString(),data:kt,contentType:It},{...vt,contentType:Bt}),V&&console.log(`Successfully transformed image using transformer: ${g.name}`)}if(!Et)throw new RemixImageError("Failed to transform requested image!",500);return zt&&m&&await m.set(xt,Et),W=Et,X=200,J=Bt,Y=m?`private, max-age=${m.config.ttl}, max-stale=${m.config.tbd}`:"public, max-age=31536000",new Response(W,{status:X,headers:{"Content-Type":J,"Cache-Control":Y}})}catch(g){if("undefined"!=typeof process&&"test"===process?.env?.NODE_ENV)throw g;return console.error("RemixImage loader error:",g?.message),console.error(g),M&&$?new Response(null,{status:302,headers:{Location:$}}):g instanceof RemixImageError?textResponse(g.errorCode||500,g.message):textResponse(500,"RemixImage encountered an unknown error!")}var W,X,J,Y,K,Q},exports.kB=g=>1e3*g,exports.mB=mB,exports.pureTransformer=jr,exports.version="1.4.0";
//# sourceMappingURL=index.js.map
